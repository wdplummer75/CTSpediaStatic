<!DOCTYPE html><html lang="en">
<head>
<title>JQueryAjaxHelper &lt; System &lt; Foswiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.5, user-scalable=yes" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<link rel="icon" href="../MISSING RESOURCE System/JQueryAjaxHelper/favicon.ico" type="image/x-icon"> <link type="image/x-icon" rel="shortcut icon" href="../MISSING RESOURCE System/JQueryAjaxHelper/favicon.ico">
<link rel="alternate" href="JQueryAjaxHelper.html" title="edit JQueryAjaxHelper" type="application/x-wiki">
<meta name="description" content="JQueryAjaxHelper" />
<link type="text/css" media="all" rel="stylesheet" class="head JQUERYPLUGIN::THEME" href="JQueryPlugin.attachments/plugins/ui/themes/foswiki/jquery-ui.css"><!--JQUERYPLUGIN::THEME-->
<link type="text/css" media="all" class="head SMILIESPLUGIN" rel="stylesheet" href="SmiliesPlugin.attachments/smilies.css"><!--SMILIESPLUGIN-->
<script src="JQueryPlugin.attachments/jquery-2.2.4.js" class="script JQUERYPLUGIN"></script><!--JQUERYPLUGIN-->
<script src="JQueryPlugin.attachments/plugins/observer/observer.js?version=0.1" class="script JQUERYPLUGIN::OBSERVER"></script><!--JQUERYPLUGIN::OBSERVER-->
<script class="script JQUERYPLUGIN::MIGRATE" src="JQueryPlugin.attachments/plugins/migrate/jquery.migrate.js?version=3.3.1"></script><!--JQUERYPLUGIN::MIGRATE-->
<script src="JQueryPlugin.attachments/plugins/foswiki/jquery.foswiki.js?version=3.01" class="script JQUERYPLUGIN::FOSWIKI"></script><!--JQUERYPLUGIN::FOSWIKI-->
<script class="script JQUERYPLUGIN::BROWSER" src="JQueryPlugin.attachments/plugins/browser/jquery.browser.js?version=0.1.0"></script><!--JQUERYPLUGIN::BROWSER-->
<script class="script JQUERYPLUGIN::METADATA" src="JQueryPlugin.attachments/plugins/metadata/jquery.metadata.js?version=2.1ef2bb44c86f5d0e98d55"></script><!--JQUERYPLUGIN::METADATA-->
<script src="JQueryPlugin.attachments/plugins/chili/jquery.chili.js?version=2.2_1" class="script JQUERYPLUGIN::CHILI"></script>
<script src="JQueryPlugin.attachments/plugins/chili/jquery.chili.init.js?version=2.2_1" class="script JQUERYPLUGIN::CHILI"></script><!--JQUERYPLUGIN::CHILI-->
<script class="script JQUERYPLUGIN::EASING" src="JQueryPlugin.attachments/plugins/easing/jquery.easing.js?version=1.3"></script><!--JQUERYPLUGIN::EASING-->
<script class='script JQUERYPLUGIN::FOSWIKI::PREFERENCES foswikiPreferences' type='text/json'>{
   "USERSWEB" : "Main",
   "WIKIUSERNAME" : "Main.WikiAdmin",
   "TOPIC" : "JQueryAjaxHelper",
   "SERVERTIME" : "08 Feb 2023 - 15:51",
   "WEB" : "System",
   "SCRIPTURLPATHS" : {},
   "NAMEFILTER" : "[\\\\\\s*?~^$@%`\"'&|<:;>\\[\\]#\\x00-\\x1f]",
   "USERNAME" : "WikiAdmin",
   "PUBURLPATH" : "/foswiki/pub",
   "SYSTEMWEB" : "System",
   "SCRIPTURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/bin",
   "URLHOST" : "http://biostat1478.dhcp.mc.vanderbilt.edu",
   "PUBURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/pub",
   "COOKIEREALM" : "",
   "WIKINAME" : "WikiAdmin",
   "SCRIPTURLPATH" : "/foswiki/bin",
   "SCRIPTSUFFIX" : "",
   "SKIN" : "natedit,pattern"
}
</script><!--JQUERYPLUGIN::FOSWIKI::PREFERENCES-->
<script src="JQueryPlugin.attachments/plugins/ui/jquery-ui.js?version=1.13.1" class="script JQUERYPLUGIN::UI"></script><!--JQUERYPLUGIN::UI-->
<script src="JQueryPlugin.attachments/plugins/ui/jquery.ui.autocomplete.init.js?version=1.13.1" class="script JQUERYPLUGIN::UI::AUTOCOMPLETE"></script><!--JQUERYPLUGIN::UI::AUTOCOMPLETE-->

<script>
jQuery(function($){
  $(".jqJumpBox").each(function() {
    var $this = $(this), 
        opts = $.extend({}, $this.metadata());
    $this.autocomplete({
      source: foswiki.getScriptUrl('view', foswiki.getPreference('SYSTEMWEB'), 'JQueryAjaxHelper', {
        section: 'topic',
        skin: 'text',
        contenttype: 'application/json',
        baseweb: opts.baseweb,
      }),
      select: function(event, ui) {
        window.location.href = foswiki.getScriptUrl('view', undefined, ui.item.value);
      }
    });
  });
});
</script>
<!--jumpbox::js-->

<script>
jQuery(function($){
  $("#jqQueryExample").click(function() {
     $.get(foswiki.getScriptUrl('view', foswiki.getPreference('SYSTEMWEB'), 'JQueryAjaxHelper', {
          section: 'query',
          source: 'System.JQueryAjaxHelper',
          query: 'parent.name',
          skin: 'text'
         }),
         function(data) {
             // This is the function that will be executed when the
             // data is fetched
             alert('parent.name is ' + data);
         });
  });
});
</script><!--query::js-->

<script>
jQuery(function($){
  $(".jqUserSelector").data("ui-autocomplete")._renderItem = function(ul, item) {
    if (typeof(item.label) !== 'undefined') {
      return $("<li></li>")
        .data("item.autocomplete", item)
        .append("<a><table width='100%'><tr><td width='60px'><img src="+item.img+" width="50"></td><td>"+item.label+"<br />"+item.email+"</td></tr></table></a>")
        .appendTo(ul);
    }
  };
});
</script>
<!--userselector::js-->
</head>
<body>
<h1 id="JQueryAjaxHelper">  <a class="foswikiCurrentTopicLink" href="JQueryAjaxHelper.html">JQueryAjaxHelper</a> </h1>
<p></p>
<p></p>
This page contains a set of example <a href="JQueryPlugin.html">JQueryPlugin</a> helpers that can be used in
wiki applications. The examples demonstrate how you can
dynamically populate autocomplete enabled input boxes using <a href="JQueryUIAutocomplete.html">JQueryUIAutocomplete</a>.
<p></p>
Examples are in two parts; a <strong>Client</strong> section and a <strong>Server</strong> section.
The <strong>Client</strong> section is designed to be included into your topics using
<code><a href="VarINCLUDE.html">%INCLUDE</a></code>. The <strong>Server</strong> section is expanded in
response to an AJAX request from a jQuery plugin.
<p></p>
This page also acts as a library of some commonly-used form inputs. For
example, the <a class="foswikiCurrentTopicLink" href="#Topic_selector">Topic selector</a> example can be used
in your own topics to define an HTML form input with the name <code>newtopic</code>
by putting this in your topic:
<pre class="tml">
&#37;JQREQUIRE{&#34;ui::autocomplete&#34;}&#37;
&#37;INCLUDE{
 &#34;&#37;SYSTEMWEB&#37;.JQueryAjaxHelper&#34;
 section&#61;&#34;topicselector&#34;
 INPUT&#95;NAME&#61;&#34;newtopic&#34;
 EXCLUDE&#61;&#34;Web&#42;&#34;
}&#37;
</pre>
<p></p>
<div class="foswikiToc" id="foswikiTOC"><span class="foswikiTocTitle">On this page:</span> <ul>
<li> <a href="#Topic_selector"> Topic selector </a> <ul>
<li> <a href="#Client_section"> Client section </a>
</li> <li> <a href="#Server_section"> Server section </a>
</li> <li> <a href="#Example"> Example </a>
</li></ul> 
</li> <li> <a href="#Web_selector"> Web selector </a> <ul>
<li> <a href="#Client_section_AN1"> Client section </a>
</li> <li> <a href="#Server_section_AN1"> Server section </a>
</li> <li> <a href="#Example_AN1"> Example </a>
</li></ul> 
</li> <li> <a href="#Jump_box"> Jump box </a> <ul>
<li> <a href="#Client_section_AN2"> Client section </a>
</li> <li> <a href="#Server_section_AN2"> Server section </a>
</li> <li> <a href="#Examples"> Examples </a> <ul>
<li> <a href="#Jump_to_a_topic_in_the_current_web"> Jump to a topic in the current web </a>
</li> <li> <a href="#Jump_to_a_topic_in_any_web"> Jump to a topic in any web </a>
</li></ul> 
</li></ul> 
</li> <li> <a href="#User_selector"> User selector </a> <ul>
<li> <a href="#Client_section_AN3"> Client section </a>
</li> <li> <a href="#Server_section_AN3"> Server section </a>
</li> <li> <a href="#Example_AN2"> Example </a>
</li></ul> 
</li> <li> <a href="#Query_fetcher"> Query fetcher </a> <ul>
<li> <a href="#Client_section_AN4"> Client section </a>
</li> <li> <a href="#Server_section_AN4"> Server section </a>
</li> <li> <a href="#Example_AN3"> Example </a>
</li></ul> 
</li> <li> <a href="#Other_selectors"> Other selectors </a> <ul>
<li> <a href="#Formfield"> Formfield </a> <ul>
<li> <a href="#Server_section_AN5"> Server section </a>
</li></ul> 
</li> <li> <a href="#User_photo"> User photo </a> <ul>
<li> <a href="#Server_section_AN6"> Server section </a>
</li></ul> 
</li> <li> <a href="#Expand_TML"> Expand TML </a> <ul>
<li> <a href="#Server_section_AN7"> Server section </a>
</li></ul> 
</li></ul> 
</li></ul> 
</div>
<p></p>
Note that the examples below are implemented
using base Foswiki functionality. There are a range of plugins, such as
<a title="'Extensions.RenderPlugin' on foswiki.org" href="https://foswiki.org/Extensions.RenderPlugin" class="interwikiLink"><noautolink>Foswiki:Extensions.RenderPlugin</noautolink></a>, <a href="https://foswiki.org/Extensions.FlexWebListPlugin" class="interwikiLink" title="'Extensions.FlexWebListPlugin' on foswiki.org"><noautolink>Foswiki:Extensions.FlexWebListPlugin</noautolink></a> and
<a href="https://foswiki.org/Extensions.DBCachePlugin" class="interwikiLink" title="'Extensions.DBCachePlugin' on foswiki.org"><noautolink>Foswiki:Extensions.DBCachePlugin</noautolink></a> that can be used to simplify or improve
these sections when building up your own library of input types. Some
examples of the use of these plugins are given at the end of this topic.
<p></p>
<h2 id="Topic_selector">  Topic selector </h2>
Select a topic in the current web. <a href="JQueryUIAutocomplete.html">JQueryUIAutocomplete</a> is given a url that
loads the <code>topic</code> section of this topic, which expands to the topic list.
<p></p>
<h3 id="Client_section">  Client section </h3>
<strong>INCLUDE Parameters</strong> <ul>
<li> <code>INPUT_NAME</code>: name (and id) of HTML input field
</li> <li> <code>INPUT_VALUE</code>: preselected value
</li> <li> <code>PLACEHOLDER</code>: example value
</li> <li> <code>EXCLUDE</code>: exclude expression to filter out unwanted topics, see the     <code>excludetopic</code> parameter in <a href="VarSEARCH.html">VarSEARCH</a>
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;topicselector&#34;}&#37;&#60;!-- topicselector  --&#62;
&#60;input type&#61;&#34;text&#34; class&#61;&#34;foswikiInputField&#34; name&#61;&#34;&#37;INPUT&#95;NAME&#37;&#34; id&#61;&#34;&#37;INPUT&#95;NAME&#37;&#34; &#37;IF{&#34;defined PLACEHOLDER&#34; then&#61;&#34;placeholder&#61;\&#34;&#37;PLACEHOLDER&#37;\&#34;&#34;}&#37; autocomplete&#61;&#34;&#37;SCRIPTURL{&#34;view&#34;}&#37;/&#37;SYSTEMWEB&#37;/JQueryAjaxHelper?section&#61;topic;skin&#61;text;contenttype&#61;application/json;baseweb&#61;&#37;BASEWEB&#37;;&#37;IF{&#34;defined EXCLUDE&#34; then&#61;&#34;exclude&#61;&#37;EXCLUDE&#37;&#34;}&#37;&#34; size&#61;&#34;60&#34; value&#61;&#34;&#37;IF{&#34;defined INPUT&#95;VALUE&#34; then&#61;&#34;&#37;INPUT&#95;VALUE&#37;&#34;}&#37;&#34; /&#62;
&#60;!-- //topicselector --&#62;&#37;ENDSECTION{&#34;topicselector&#34;}&#37;
</pre>
<p></p>
<h3 id="Server_section">  Server section </h3>
<strong>URL parameters</strong> <ul>
<li> <code>term</code>: search term substring typed so far
</li> <li> <code>limit</code>: number of search results to return, defaults to 10
</li> <li> <code>baseweb</code>: the web where to search for topics
</li> <li> <code>exclude</code>: exclude expression to filter out unwanted topics
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;topic&#34;}&#37;&#91;&#37;SEARCH{
  &#34;^&#37;URLPARAM{&#34;term&#34; default&#61;&#34;does not exist&#34;}&#37;.&#42;&#34;
  type&#61;&#34;regex&#34;
  scope&#61;&#34;topic&#34;
  format&#61;&#34;&#60;nop&#62;&#37;URLPARAM{&#34;format&#34; encode&#61;&#34;safe,quote&#34; default&#61;&#34;{\\&#34;label\\&#34;:\\&#34;&#36;topic\\&#34;, \\&#34;value\\&#34;:\\&#34;&#36;topic\\&#34;}&#34;}&#37;&#34;
  separator&#61;&#34;,&#34;
  limit&#61;&#34;&#37;URLPARAM{&#34;limit&#34; default&#61;&#34;10&#34;}&#37;&#34;
  nonoise&#61;&#34;on&#34;
  excludetopic&#61;&#34;&#37;URLPARAM{&#34;exclude&#34;}&#37;&#34;
  web&#61;&#34;&#37;URLPARAM{&#34;baseweb&#34; default&#61;&#34;&#37;BASEWEB&#37;&#34;}&#37;&#34;
}&#37;&#93;&#37;ENDSECTION{&#34;topic&#34;}&#37;
</pre>
<p></p>
<h3 id="Example">  Example </h3>
<form>
<div class="foswikiFormSteps">
<div class="foswikiFormStep">
<h3 >Select a topic:</h3>
<!-- topicselector  -->
<input type="text" class="foswikiInputField" name="newtopic" id="newtopic" placeholder="(Begin typing topic name)" autocomplete="http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/bin/view/System/JQueryAjaxHelper?section=topic;skin=text;contenttype=application/json;baseweb=System;exclude=FamFamFamMint*" size="60" value="" />
<!-- //topicselector -->
</div>
</div>
</form>
<p></p>
<h2 id="Web_selector">  Web selector </h2>
Select from a list of webs, using autocomplete
<p></p>
<div class="foswikiHelp"><img title="ALERT!" width="16" src="DocumentGraphics.attachments/warning.png" height="16" alt="ALERT!"> <strong><em>Note:</em></strong> there is currently no way to filter a list of webs in the
default Foswiki core. FlexWeblist Plugin is <strong>not</strong> installed.  To use this example you will have to install
<a class="interwikiLink" href="https://foswiki.org/Extensions.FlexWebListPlugin" title="'Extensions.FlexWebListPlugin' on foswiki.org"><noautolink>Foswiki:Extensions.FlexWebListPlugin</noautolink></a>.  </div>
<p></p>
<h3 id="Client_section_AN1">  Client section </h3>
<strong>INCLUDE Parameters</strong> <ul>
<li> <code>INPUT_NAME</code>: name of text input field
</li> <li> <code>INPUT_VALUE</code>: preselected value
</li> <li> <code>PLACEHOLDER</code>: example value
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;webselector&#34;}&#37;&#60;!-- webselector  --&#62;
&#60;input type&#61;&#34;text&#34; class&#61;&#34;foswikiInputField&#34; name&#61;&#34;&#37;INPUT&#95;NAME&#37;&#34; id&#61;&#34;&#37;INPUT&#95;NAME&#37;&#34; &#37;IF{&#34;defined PLACEHOLDER&#34; then&#61;&#34;placeholder&#61;\&#34;&#37;PLACEHOLDER&#37;\&#34;&#34;}&#37; autocomplete&#61;&#34;&#37;SCRIPTURL{&#34;view&#34;}&#37;/&#37;SYSTEMWEB&#37;/JQueryAjaxHelper?section&#61;web;skin&#61;text;contenttype&#61;application/json;&#37;IF{&#34;defined EXCLUDE&#34; then&#61;&#34;exclude&#61;&#37;EXCLUDE&#37;&#34;}&#37;&#34; size&#61;&#34;60&#34; value&#61;&#34;&#37;IF{&#34;defined INPUT&#95;VALUE&#34; then&#61;&#34;&#37;INPUT&#95;VALUE&#37;&#34;}&#37;&#34; /&#62;
&#60;!-- //webselector --&#62;&#37;ENDSECTION{&#34;webselector&#34;}&#37;
</pre>
<p></p>
<h3 id="Server_section_AN1">  Server section </h3>
<strong>URL parameters</strong> <ul>
<li> <code>term</code>: search term substring typed so far
</li> <li> <code>limit</code>: number of search results to return, defaults to 10
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;web&#34;}&#37;&#91;&#37;FLEXWEBLIST{
  include&#61;&#34;^&#37;URLPARAM{&#34;term&#34; default&#61;&#34;does not exist&#34;}&#37;.&#42;&#34;
  ignorecase&#61;&#34;on&#34;
  limit&#61;&#34;&#37;URLPARAM{&#34;limit&#34; default&#61;&#34;10&#34;}&#37;&#34;
  format&#61;&#34;\&#34;&#60;nop&#62;&#36;web\&#34;&#34;
  separator&#61;&#34;, &#34;
  subheader&#61;&#34;, &#34;
  subfooter&#61;&#34; &#34;
}&#37;&#93;&#37;ENDSECTION{&#34;web&#34;}&#37;
</pre>
<p></p>
<h3 id="Example_AN1">  Example </h3>
<form>
<div class="foswikiFormSteps">
<div class="foswikiFormStep">
<h3 >Select a web:</h3>
Install <a title="'Extensions.FlexWebListPlugin' on foswiki.org" href="https://foswiki.org/Extensions.FlexWebListPlugin" class="interwikiLink"><noautolink>Foswiki:Extensions.FlexWebListPlugin</noautolink></a> to use this example
</div>
</div>
</form>
<p></p>
<h2 id="Jump_box">  Jump box </h2>
Jump to specific topics.
<p></p>
<h3 id="Client_section_AN2">  Client section </h3>
<strong>INCLUDE Parameters</strong> <ul>
<li> <code>GLOBAL</code>: toggle search for topics in all webs on/off, defaults to off
</li> <li> <code>PLACEHOLDER</code>: Example text
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;jumpbox&#34;}&#37;&#60;!-- jumpbox --&#62;
&#60;input type&#61;&#34;text&#34; class&#61;&#34;foswikiInputField jqJumpBox {&#37;IF{
  &#34;&#36;GLOBAL &#61; &#39;on&#39;&#34;
  then&#61;&#34;global: true, baseweb:&#39;all, -&#37;TRASHWEB&#37;&#39;&#34;
  else&#61;&#34;global: false, baseweb:&#39;&#37;BASEWEB&#37;&#39;&#34;
}&#37;}&#34; name&#61;&#34;topic&#34; &#37;IF{&#34;defined PLACEHOLDER&#34; then&#61;&#34;placeholder&#61;\&#34;&#37;PLACEHOLDER&#37;\&#34;&#34;}&#37; autocomplete&#61;&#34;off&#34; size&#61;&#34;60&#34; /&#62;
&#37;ADDTOZONE{&#34;script&#34;
  tag&#61;&#34;jumpbox::js&#34;
  section&#61;&#34;jumpbox::js&#34;
  requires&#61;&#34;JQUERYPLUGIN::UI::AUTOCOMPLETE&#34;
}&#37;
&#60;!-- //jumpbox --&#62;&#37;ENDSECTION{&#34;jumpbox&#34;}&#37;
</pre>
The following section is used by the section above; it adds a special Javascript function to the page.
<pre class="tml">
&#37;STARTSECTION{&#34;jumpbox::js&#34;}&#37;&#60;literal&#62;
&#60;script&#62;
jQuery(function(&#36;){
  &#36;(&#34;.jqJumpBox&#34;).each(function() {
    var &#36;this &#61; &#36;(this), 
        opts &#61; &#36;.extend({}, &#36;this.metadata());
    &#36;this.autocomplete({
      source: foswiki.getScriptUrl(&#39;view&#39;, foswiki.getPreference(&#39;SYSTEMWEB&#39;), &#39;JQueryAjaxHelper&#39;, {
        section: &#39;topic&#39;,
        skin: &#39;text&#39;,
        contenttype: &#39;application/json&#39;,
        baseweb: opts.baseweb,
      }),
      select: function(event, ui) {
        window.location.href &#61; foswiki.getScriptUrl(&#39;view&#39;, undefined, ui.item.value);
      }
    });
  });
});
&#60;/script&#62;
&#60;/literal&#62;&#37;ENDSECTION{&#34;jumpbox::js&#34;}&#37;
</pre>
<h3 id="Server_section_AN2">  Server section </h3>
Uses the <code><a class="foswikiCurrentTopicLink" href="#Topic_selector">topic</a></code> server section, defined above.
<p></p>
<h3 id="Examples">  Examples </h3>
<h4 id="Jump_to_a_topic_in_the_current_web">  Jump to a topic in the current web </h4>
<form>
<div class="foswikiFormSteps">
<div class="foswikiFormStep">
<h3 >Local Jump:</h3>
<!-- jumpbox -->
<input type="text" class="foswikiInputField jqJumpBox {global: false, baseweb:'System'}" name="topic" placeholder="(Begin typing topic name)" autocomplete="off" size="60" />
<p></p>
<!-- //jumpbox -->
</div>
</div>
</form>
<h4 id="Jump_to_a_topic_in_any_web">  Jump to a topic in any web </h4>
<form>
<div class="foswikiFormSteps">
<div class="foswikiFormStep">
<h3 >Global Jump:</h3>
<!-- jumpbox -->
<input type="text" class="foswikiInputField jqJumpBox {global: true, baseweb:'all, -Trash'}" name="topic" placeholder="(Begin typing topic name)" autocomplete="off" size="60" />
<p></p>
<!-- //jumpbox -->
</div>
</div>
</form>
<p></p>
<h2 id="User_selector">  User selector  </h2>
<div class="foswikiHelp"><img src="DocumentGraphics.attachments/warning.png" alt="ALERT!" height="16" title="ALERT!" width="16"> <strong>Note:</strong> This example obtains user information with the %USERINFO% macro.   If the wiki is configured to hide user details (<code>$Foswiki::cfg{AntiSpam}{HideUserDetails}</code>), then this example will not work unless you are an administrator.</div>
<p></p>
<h3 id="Client_section_AN3">  Client section </h3>
<strong>INCLUDE Parameters</strong> <ul>
<li> <code>INPUT_NAME</code>: name of text input field
</li> <li> <code>INPUT_VALUE</code>: preselected user
</li> <li> <code>PLACEHOLDER</code>: example value 
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;userselector&#34;}&#37;&#60;!-- userselector --&#62;
&#60;input type&#61;&#34;text&#34; class&#61;&#34;foswikiInputField jqUserSelector&#34; name&#61;&#34;&#37;INPUT&#95;NAME&#37;&#34; id&#61;&#34;&#37;INPUT&#95;NAME&#37;&#34; &#37;IF{&#34;defined PLACEHOLDER&#34; then&#61;&#34;placeholder&#61;\&#34;&#37;PLACEHOLDER&#37;\&#34;&#34;}&#37; autocomplete&#61;&#34;&#37;SCRIPTURL{&#34;view&#34;}&#37;/&#37;SYSTEMWEB&#37;/JQueryAjaxHelper?section&#61;user;skin&#61;text;contenttype&#61;application/json&#34; size&#61;&#34;60&#34; value&#61;&#34;&#37;IF{&#34;defined INPUT&#95;VALUE&#34; then&#61;&#34;&#37;INPUT&#95;VALUE&#37;&#34;}&#37;&#34; /&#62;
&#37;ADDTOZONE{&#34;script&#34;
  tag&#61;&#34;userselector::js&#34;
  section&#61;&#34;userselector::js&#34;
  requires&#61;&#34;JQUERYPLUGIN::UI::AUTOCOMPLETE&#34;
}&#37;
&#60;!-- //userselector --&#62;&#37;ENDSECTION{&#34;userselector&#34;}&#37;
</pre>
The following section is used by the section above; it adds a special Javascript function to the page.
<pre class="tml">
&#37;STARTSECTION{&#34;userselector::js&#34;}&#37;&#60;literal&#62;
&#60;script&#62;
jQuery(function(&#36;){
  &#36;(&#34;.jqUserSelector&#34;).data(&#34;ui-autocomplete&#34;).&#95;renderItem &#61; function(ul, item) {
    if (typeof(item.label) !&#61;&#61; &#39;undefined&#39;) {
      return &#36;(&#34;&#60;li&#62;&#60;/li&#62;&#34;)
        .data(&#34;item.autocomplete&#34;, item)
        .append(&#34;&#60;a&#62;&#60;table width&#61;&#39;100&#37;&#39;&#62;&#60;tr&#62;&#60;td width&#61;&#39;60px&#39;&#62;&#60;img width&#61;&#39;50&#39; src&#61;&#39;&#34;+item.img+&#34;&#39; /&#62;&#60;/td&#62;&#60;td&#62;&#34;+item.label+&#34;&#60;br /&#62;&#34;+item.email+&#34;&#60;/td&#62;&#60;/tr&#62;&#60;/table&#62;&#60;/a&#62;&#34;)
        .appendTo(ul);
    }
  };
});
&#60;/script&#62;
&#60;/literal&#62;&#37;ENDSECTION{&#34;userselector::js&#34;}&#37;
</pre>
<h3 id="Server_section_AN3">  Server section </h3>
<strong>URL parameters</strong> <ul>
<li> <code>term</code>: search term substring typed so far
</li> <li> <code>limit</code>: number of search results to return, defaults to 10
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;user&#34;}&#37;&#60;literal&#62;&#91;&#37;FORMAT{
  &#34;&#37;SEARCH{
     &#34;.&#42;&#37;URLPARAM{&#34;term&#34; default&#61;&#34;does not exist&#34;}&#37;.&#42;&#34;
     type&#61;&#34;regex&#34;
     scope&#61;&#34;topic&#34;
     format&#61;&#34;&#36;percntIF{\&#34;&#39;&#36;percntGROUPINFO{\&#34;&#36;topic\&#34; format&#61;\&#34;&#36;dollarname, \&#34; limit&#61;\&#34;1\&#34;}&#36;percnt&#39;&#61;&#39;&#39;\&#34;
          then&#61;\&#34;&#36;percntUSERINFO{\&#34;&#36;topic\&#34; format&#61;\&#34;&#36;dollarwikiname, \&#34;}&#36;percnt\&#34;
          else&#61;\&#34;&#36;percntGROUPINFO{\&#34;&#36;topic\&#34; format&#61;\&#34;&#36;dollarname, \&#34; limit&#61;\&#34;1\&#34;}&#36;percnt\&#34;
        }&#36;percnt&#34;
     separator&#61;&#34;&#34;
     limit&#61;&#34;&#37;URLPARAM{&#34;limit&#34; default&#61;&#34;10&#34;}&#37;&#34;
     nonoise&#61;&#34;on&#34;
     web&#61;&#34;&#37;USERSWEB&#37;&#34;
  }&#37;&#34;
  type&#61;&#34;string&#34;
  format&#61;&#34;  {\&#34;label\&#34;:\&#34;&#60;nop&#62;&#36;item\&#34;, 
    \&#34;email\&#34;:\&#34;&#36;percntUSERINFO{\&#34;&#36;item\&#34; format&#61;\&#34;&#36;emails\&#34;}&#36;percnt\&#34;, 
    \&#34;img\&#34;:\&#34;&#36;percntFORMFIELD{\&#34;Photo\&#34; 
      topic&#61;\&#34;&#37;USERSWEB&#37;.&#36;item\&#34; 
      default&#61;\&#34;&#37;PUBURLPATH&#37;/&#37;SYSTEMWEB&#37;/JQueryPlugin/images/nobody.gif\&#34; 
      alttext&#61;\&#34;&#37;PUBURLPATH&#37;/&#37;SYSTEMWEB&#37;/JQueryPlugin/images/nobody.gif\&#34; 
    }&#36;percnt\&#34;
  }&#34;
  separator&#61;&#34;,&#36;n&#34;
}&#37;&#93;&#60;/literal&#62;&#37;ENDSECTION{&#34;user&#34;}&#37;
</pre>
<p></p>
<h3 id="Example_AN2">  Example </h3>
<form>
<div class="foswikiFormSteps">
<div class="foswikiFormStep">
<h3 >Find user:</h3>
<!-- userselector -->
<input type="text" class="foswikiInputField jqUserSelector" name="user" id="user"  autocomplete="http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/bin/view/System/JQueryAjaxHelper?section=user;skin=text;contenttype=application/json" size="60" value="" />
<p></p>
<!-- //userselector -->
</div>
</div>
</form>
<p></p>
<h2 id="Query_fetcher">  Query fetcher </h2>
Perform a <code><a href="VarQUERY.html">%QUERY</a></code> asynchronously (requires Foswiki 1.1
or later).
<p></p>
<h3 id="Client_section_AN4">  Client section </h3>
<strong>INCLUDE Parameters</strong> <ul>
<li> <code>ID</code>: id of an element to bind an onclick event to
</li> <li> <code>SOURCE</code>: topic to get the field from
</li> <li> <code>QUERY</code>: query to perform
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;queryfetcher&#34;}&#37;&#37;ADDTOZONE{&#34;script&#34;
  tag&#61;&#34;query::js&#34;
  requires&#61;&#34;JQUERYPLUGIN&#34;
  text &#61;&#34;&#60;literal&#62;
&#60;script&#62;
jQuery(function(&#36;){
  &#36;(\&#34;#&#37;ID&#37;\&#34;).click(function() {
     &#36;.get(foswiki.getScriptUrl(&#39;view&#39;, foswiki.getPreference(&#39;SYSTEMWEB&#39;), &#39;JQueryAjaxHelper&#39;, {
          section: &#39;query&#39;,
          source: &#39;&#37;SOURCE&#37;&#39;,
          query: &#39;&#37;QUERY&#37;&#39;,
          skin: &#39;text&#39;
         }),
         function(data) {
             // This is the function that will be executed when the
             // data is fetched
             alert(&#39;&#37;QUERY&#37; is &#39; + data);
         });
  });
});
&#60;/script&#62;&#60;/literal&#62;
&#34;}&#37;&#37;ENDSECTION{&#34;queryfetcher&#34;}&#37;
</pre>
<p></p>
<h3 id="Server_section_AN4">  Server section </h3>
<strong>URL parameters</strong> <ul>
<li> <code>source</code>: source topic 
</li> <li> <code>query</code>: query to perform
</li></ul> 
<pre class="tml">
&#37;STARTSECTION{&#34;query&#34;}&#37;&#60;noautolink&#62;&#37;QUERY{
  &#34;&#39;&#37;URLPARAM{&#34;source&#34; default&#61;&#34;&#37;BASEWEB&#37;.&#37;BASETOPIC&#37;&#34;}&#37;&#39;/&#37;URLPARAM{&#34;query&#34; default&#61;&#34;query missing&#34;}&#37;&#34;
  style&#61;&#34;json&#34;
}&#37;&#60;/noautolink&#62;&#37;ENDSECTION{&#34;query&#34;}&#37;
</pre>
<p></p>
<h3 id="Example_AN3">  Example </h3>
<p></p>
<input type="button" class="foswikiButton" id="jqQueryExample" value="Click here" /> to get the parent of this topic asynchronously (should be 'JQueryPlugin')
<p></p>
<h2 id="Other_selectors">  Other selectors </h2>
Server sections for some other selectors that are common in wiki applications.
<p></p>
<h3 id="Formfield">  Formfield </h3>
Fetch a formfield from a topic asynchronously.
Uses <a href="VarFORMFIELD.html">FORMFIELD</a>, which is deprecated in Foswiki 1.1. Foswiki 1.1 and later should use <a href="VarQUERY.html">QUERY</a>
<p></p>
<strong>URL Parameters</strong> <ul>
<li> <code>source</code>: source topic 
</li> <li> <code>formfield</code>: name of formfiled to retrieve
</li></ul> 
<p></p>
<h4 id="Server_section_AN5">  Server section </h4>
<pre class="tml">
&#37;STARTSECTION{&#34;formfield&#34;}&#37;&#37;FORMFIELD{
  &#34;&#37;URLPARAM{&#34;formfield&#34; default&#61;&#34;does not exist&#34;}&#37;&#34;
  topic&#61;&#34;&#37;URLPARAM{&#34;source&#34; default&#61;&#34;does not exist&#34;}&#37;&#34;
}&#37;&#37;ENDSECTION{&#34;formfield&#34;}&#37;
</pre>
<p></p>
<h3 id="User_photo">  User photo </h3>
This one returns an <code>&lt;img...&gt;</code> to a user's photo. See the User selector example above.
<p></p>
<strong>URL Parameters</strong> <ul>
<li> <code>name</code>: name of user
</li> <li> <code>height</code>: image height, defaults to 50
</li></ul> 
<p></p>
<h4 id="Server_section_AN6">  Server section </h4>
<pre class="tml">
&#37;STARTSECTION{&#34;userphoto&#34;}&#37;&#60;img src&#61;&#39;&#37;FORMFIELD{&#34;Photo&#34; topic&#61;&#34;&#37;USERINFO{&#34;&#37;URLPARAM{&#34;name&#34; default&#61;&#34;does not exist&#34;}&#37;&#34; format&#61;&#34;&#36;wikiusername&#34;}&#37;&#34; default&#61;&#34;&#37;PUBURLPATH&#37;/&#37;SYSTEMWEB&#37;/JQueryPlugin/images/nobody.gif&#34; alttext&#61;&#34;&#37;PUBURLPATH&#37;/&#37;SYSTEMWEB&#37;/JQueryPlugin/images/nobody.gif&#34;}&#37;&#39; alt&#61;&#39;&#37;URLPARAM{&#34;name&#34;}&#37;&#39; height&#61;&#39;&#37;URLPARAM{&#34;height&#34; default&#61;&#34;50&#34;}&#37;&#39; /&#62;&#37;ENDSECTION{&#34;userphoto&#34;}&#37;
</pre>
<p></p>
<h3 id="Expand_TML">  Expand TML </h3>
expand a TML expression in the given scope
<p></p>
<h4 id="Server_section_AN7">  Server section </h4>
<strong>URL parameters</strong> <ul>
<li> <code>expression</code>: TML to be evaluated; will be wrapped into %...% before executing it
</li> <li> <code>scope</code>: optionally defines the topic within which the expression is expanded
</li></ul> 
<p></p>
<pre class="tml">
&#37;STARTSECTION{&#34;expand&#34;}&#37;&#37;EXPAND{&#34;&#36;percnt&#37;URLPARAM{&#34;expression&#34;}&#37;&#36;percnt&#34; scope&#61;&#34;&#37;URLPARAM{&#34;scope&#34; default&#61;&#34;&#37;BASEWEB&#37;.&#37;BASETOPIC&#37;&#34;}&#37;&#34;}&#37;&#37;ENDSECTION{&#34;expand&#34;}&#37;
</pre>
<hr />
<p></p>
<hr />
<p></p>
</body>