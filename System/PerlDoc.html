<!DOCTYPE html><html lang="en">
<head>
<title>PerlDoc &lt; System &lt; Foswiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.5, user-scalable=yes" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<link href="../MISSING RESOURCE System/PerlDoc/favicon.ico" rel="icon" type="image/x-icon"> <link rel="shortcut icon" href="../MISSING RESOURCE System/PerlDoc/favicon.ico" type="image/x-icon">
<link type="application/x-wiki" rel="alternate" href="PerlDoc.html" title="edit PerlDoc">
<meta name="description" content="PerlDoc" />
<link type="text/css" media="all" rel="stylesheet" class="head JQUERYPLUGIN::TWISTY" href="TwistyPlugin.attachments/twisty.css?version=1.6.0"><!--JQUERYPLUGIN::TWISTY: requires= missing ids: JavascriptFiles/foswikiPref-->
<link type="text/css" media="all" class="head SMILIESPLUGIN" rel="stylesheet" href="SmiliesPlugin.attachments/smilies.css"><!--SMILIESPLUGIN-->
<script src="JQueryPlugin.attachments/jquery-2.2.4.js" class="script JQUERYPLUGIN"></script><!--JQUERYPLUGIN-->
<script class="script JQUERYPLUGIN::OBSERVER" src="JQueryPlugin.attachments/plugins/observer/observer.js?version=0.1"></script><!--JQUERYPLUGIN::OBSERVER-->
<script class="script JQUERYPLUGIN::MIGRATE" src="JQueryPlugin.attachments/plugins/migrate/jquery.migrate.js?version=3.3.1"></script><!--JQUERYPLUGIN::MIGRATE-->
<script src="JQueryPlugin.attachments/plugins/foswiki/jquery.foswiki.js?version=3.01" class="script JQUERYPLUGIN::FOSWIKI"></script><!--JQUERYPLUGIN::FOSWIKI-->
<script class="script JQUERYPLUGIN::BROWSER" src="JQueryPlugin.attachments/plugins/browser/jquery.browser.js?version=0.1.0"></script><!--JQUERYPLUGIN::BROWSER-->
<script class='script JQUERYPLUGIN::FOSWIKI::PREFERENCES foswikiPreferences' type='text/json'>{
   "WEB" : "System",
   "SCRIPTURLPATHS" : {},
   "NAMEFILTER" : "[\\\\\\s*?~^$@%`\"'&|<:;>\\[\\]#\\x00-\\x1f]",
   "PUBURLPATH" : "/foswiki/pub",
   "USERNAME" : "WikiAdmin",
   "USERSWEB" : "Main",
   "WIKIUSERNAME" : "Main.WikiAdmin",
   "TOPIC" : "PerlDoc",
   "SERVERTIME" : "08 Feb 2023 - 15:51",
   "WIKINAME" : "WikiAdmin",
   "SCRIPTURLPATH" : "/foswiki/bin",
   "SCRIPTSUFFIX" : "",
   "SKIN" : "natedit,pattern",
   "SCRIPTURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/bin",
   "SYSTEMWEB" : "System",
   "URLHOST" : "http://biostat1478.dhcp.mc.vanderbilt.edu",
   "PUBURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/pub",
   "COOKIEREALM" : ""
}
</script><!--JQUERYPLUGIN::FOSWIKI::PREFERENCES-->
<script class="script JQUERYPLUGIN::TWISTY" src="TwistyPlugin.attachments/jquery.twisty.js?version=1.6.0"></script><!--JQUERYPLUGIN::TWISTY: requires= missing ids: JavascriptFiles/foswikiPref-->
</head>
<body>
<h2 id="A_61internal_package_61_Foswiki">   <code>internal package</code> Foswiki </h2>
<form class='foswikiForm' action='/foswiki/bin/view/System/PerlDoc'>
<div class='foswikiFormSteps'>
  <div class='foswikiFormStep'>
      See <a href="PublishedAPI.html">PublishedAPI</a> for packages intended to be used by Plugin and Contrib authors, or <a href="PerlDoc.html" class="foswikiCurrentTopicLink">browse all packages</a>.<br>
      See also <a href="DevelopingPlugins.html">Developing plugins</a>, <a class="interwikiLink" href="https://foswiki.org/Development.DevelopersBible" title="'Development.DevelopersBible' on foswiki.org"><noautolink>Developer's Bible</noautolink></a>, <a title="'Development.TechnicalOverview' on foswiki.org" class="interwikiLink" href="https://foswiki.org/Development.TechnicalOverview"><noautolink>Technical Overview</noautolink></a> 
  </div>
  <div class='foswikiFormStep'>
    <label for='module'><b>Perl Module:</b></label>
    <input type='text' name='module' id='module' size='60' value='' class='foswikiInputField' />
<!--
Commented this out right before 1.1.5 - we should distinguish between 'public' and 'published' classes.
    <label for='publicOnly'><b>Public Only:</b></label>
    <input type='checkbox' name='publicOnly' id='publicOnly' value='on'  class='foswikiInputField' />
-->
    <input type='submit' value='Submit' class='foswikiSubmit' />
  </div>
  <div class='foswikiFormStep'>
    <div class="twistyPlugin foswikiMakeVisible"><span id="twistyIdSystemPerlDoc1show" style="display:none" class="twistyRememberSetting twistyTrigger foswikiUnvisited twistyInited"><a href=".." class="foswikiButton"><span class="foswikiLinkLabel foswikiUnvisited">Child packages</span></a></span><span id="twistyIdSystemPerlDoc1hide" style="display:none" class="twistyRememberSetting twistyTrigger foswikiUnvisited twistyInited"><a class="foswikiButton" href=".."><span class="foswikiLinkLabel foswikiUnvisited">Child packages</span></a></span></div><div class="twistyPlugin"><div id="twistyIdSystemPerlDoc1toggle" style="" class="twistyRememberSetting twistyContent twistyInited">
<p></p>
<ul><li><a href="PerlDoc.html">Foswiki::Access</a> - A singleton object of this class manages the access control database.</li>
<li><a href="PerlDoc.html">Foswiki::AccessControlException</a> - Exception used raise an access control violation. This exception has the following fields:    * <code>web</code> - the web which was being accessed    * <code>topic</code> - the topic being accessed (if any)    * <code>user</code> - canonical username of the person doing the accessing. Use    the methods of the Foswiki::Users class to get more information about the    user.    * <code>mode</code> - the access mode e.g. CHANGE, VIEW etc    * <code>reason</code> a text string giving the reason for the refusal.</li>
<li><a href="PerlDoc.html">Foswiki::Address</a> - This class is used to handle pointers to Foswiki 'resources', which might be webs, topics or parts of topics (such as attachments or metadata), optionally of a specific revision.</li>
<li><a href="PerlDoc.html">Foswiki::AggregateIterator</a> - <strong>implements</strong> Foswiki::Iterator</li>
<li><a href="PerlDoc.html">Foswiki::Attach</a> - A singleton object of this class is used to deal with attachments to topics.</li>
<li><a href="PerlDoc.html">Foswiki::Attrs</a> - Class of attribute sets, designed for parsing and storing attribute values from a macro e.g. =%MACRO{"joe" fred="bad" joe="mad"}%=</li>
<li><a href="PerlDoc.html">Foswiki::Compatibility</a> - Support for compatibility with old versions. Packaged separately because 99.999999% of the time this won't be needed.</li>
<li><a href="PerlDoc.html">Foswiki::Configure</a></li>
<li><a href="PerlDoc.html">Foswiki::Contrib</a></li>
<li><a href="PerlDoc.html">Foswiki::Engine</a> - The engine class is a singleton that implements details about Foswiki's execution mode. This is the base class and implements basic behavior.</li>
<li><a href="PerlDoc.html">Foswiki::EngineException</a> - Exception used to raise an engine related error. This exception has the following fields:    * <code>status</code> - status code to send to client    * <code>reason</code> a text string giving the reason for the refusal.</li>
<li><a href="PerlDoc.html">Foswiki::Form</a> - Object representing a single form definition.</li>
<li><a href="PerlDoc.html">Foswiki::Func</a> - _Interface for Foswiki extensions developers_</li>
<li><a href="PerlDoc.html">Foswiki::I18N</a> - Support for strings translation and language detection.</li>
<li><a href="PerlDoc.html">Foswiki::IP</a></li>
<li><a href="PerlDoc.html">Foswiki::If</a></li>
<li><a href="PerlDoc.html">Foswiki::IncludeHandlers</a></li>
<li><a href="PerlDoc.html">Foswiki::Infix</a></li>
<li><a href="PerlDoc.html">Foswiki::Iterator</a> - This class cannot be instantiated on its own - it is an interface specification for iterators. See <a href="http://en.wikipedia.org/wiki/Iterator_Pattern">http://en.wikipedia.org/wiki/Iterator_Pattern</a> for more information on the iterator pattern.</li>
<li><a href="PerlDoc.html">Foswiki::LineIterator</a> - <strong>implements</strong> Foswiki::Iterator</li>
<li><a href="PerlDoc.html">Foswiki::ListIterator</a> - <strong>implements</strong> Foswiki::Iterator</li>
<li><a href="PerlDoc.html">Foswiki::Logger</a> - Object that interfaces to whatever records Foswiki log files.</li>
<li><a href="PerlDoc.html">Foswiki::LoginManager</a> - The package is also a Factory for login managers and also the base class for all login managers.</li>
<li><a href="PerlDoc.html">Foswiki::Macros</a></li>
<li><a href="PerlDoc.html">Foswiki::Merge</a> - Support for merging strings</li>
<li><a href="PerlDoc.html">Foswiki::Meta</a> - Objects of this class act as handles onto real store objects. An object of this class can represent the Foswiki root, a web, or a topic.</li>
<li><a href="PerlDoc.html">Foswiki::MetaCache</a> - A cache of Meta objects - initially used to speed up searching and sorting, but by foswiki 2.0 hopefully this  will be used for all readonly accesses to the store.</li>
<li><a href="PerlDoc.html">Foswiki::Net</a> - Object that brokers access to network resources.</li>
<li><a href="PerlDoc.html">Foswiki::OopsException</a> - Exception used to raise a request to output a preformatted page.</li>
<li><a href="PerlDoc.html">Foswiki::PageCache</a> - This class is a purely virtual base class that implements the basic infrastructure required to cache pages as produced by the rendering engine. Once a page was computed, it will be  cached for subsequent calls for the same output. In addition a Foswiki::PageCache has to ensure cache correctness, that is all content stored in the cache is up-to-date. It must not return any content being rendered on the base of  data that has already changed in the meantine by actions performed by the Foswiki::Store. </li>
<li><a href="PerlDoc.html">Foswiki::Plugin</a></li>
<li><a href="PerlDoc.html">Foswiki::Plugins</a> - This module defines the singleton object that handles Plugins loading, initialization and execution.</li>
<li><a href="PerlDoc.html">Foswiki::Plurals</a> - Handle conversion of plural topic names to singular form.</li>
<li><a href="PerlDoc.html">Foswiki::Prefs</a> - Preferences are set in topics, using either 'Set' lines embedded in the topic text, or via PREFERENCE meta-data attached to the topic. A preference value has four <em>scopes</em>:    * <em>Global</em> scope    * <em>Local</em> scope    * <em>Web</em> scope    * <em>Topic</em> scope</li>
<li><a href="PerlDoc.html">Foswiki::Query</a></li>
<li><a href="PerlDoc.html">Foswiki::Render</a> - This module provides most of the actual HTML rendering code in Foswiki.</li>
<li><a href="PerlDoc.html">Foswiki::Request</a> - Class to encapsulate request data.</li>
<li><a href="PerlDoc.html">Foswiki::Response</a> - Class to encapsulate response data.</li>
<li><a href="PerlDoc.html">Foswiki::Sandbox</a> - This package provides an interface to the outside world. All calls to system functions, or handling of file names, should be brokered by the <code>sysCommand</code> function in this package.</li>
<li><a href="PerlDoc.html">Foswiki::Search</a> - This module implements all the search functionality.</li>
<li><a href="PerlDoc.html">Foswiki::Serialise</a> - API to allow structures to be serialised and de-serialized. This API will only return basic types like hashes and arrarys</li>
<li><a href="PerlDoc.html">Foswiki::Store</a> - This class is a pure virtual base class that specifies the interface between the actual store implementation and the rest of the Foswiki system.</li>
<li><a href="PerlDoc.html">Foswiki::Tables</a></li>
<li><a href="PerlDoc.html">Foswiki::Templates</a> - Support for Skin Template directives</li>
<li><a href="PerlDoc.html">Foswiki::Time</a> - Time handling functions.</li>
<li><a href="PerlDoc.html">Foswiki::UI</a> - Coordinator of execution flow and service functions used by the UI packages</li>
<li><a href="PerlDoc.html">Foswiki::UserMapping</a> - This is a virtual base class (a.k.a an interface) for all user mappers. It is <strong>not</strong> useable as a mapping in Foswiki - use the <a href="BaseUserMapping.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">BaseUserMapping</a> for default behaviour.</li>
<li><a href="PerlDoc.html">Foswiki::Users</a> - This package provides services for the lookup and manipulation of login and wiki names of users, and their authentication.</li>
<li><a href="PerlDoc.html">Foswiki::Util</a></li>
<li><a href="PerlDoc.html">Foswiki::Validation</a> - "Validation" is the process of ensuring that an incoming request came from a page we generated. Validation keys are injected into all HTML pages generated by Foswiki, in Foswiki::writeCompletePage. When a request is received from the browser that requires validation, that request must be accompanied by the validation key. The functions in this package support the generation and checking of these validation keys.</li>
<li><a href="PerlDoc.html">Foswiki::ValidationException</a> - Exception used raise a validation error. See also Foswiki::Validation.</li>
<li><a href="PerlDoc.html">Foswiki::WebFilter</a></li>
</ul>
    </div></div>
  </div>
</div>
</form>
<p></p>
<blockquote class="foswikiAlert"> <strong>SMELL / FIX / TODO count: 22</strong>
</blockquote>
<p></p>
<div class="foswikiToc" id="foswikiTOC"><span class="foswikiTocTitle">On this page:</span> <ul>
<li> <a href="#A_61internal_package_61_Foswiki"> internal package Foswiki </a> <ul>
<li> <a href="#Public_Data_members"> Public Data members </a>
</li> <li> <a href="#A_61StaticMethod_61_decode_utf8_40_36octets_41_36unicode"> StaticMethod decode_utf8($octets) &rarr; $unicode </a>
</li> <li> <a href="#A_61StaticMethod_61_encode_utf8_40_36unicode_41_36octets"> StaticMethod encode_utf8($unicode) &rarr; $octets </a>
</li> <li> <a href="#A_61ObjectMethod_61_writeCompletePage_40_36text_44_36pageType_44_36contentType_41"> ObjectMethod writeCompletePage( $text, $pageType, $contentType ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_satisfiedByCache_40_36action_44_36web_44_36topic_41_36boolean"> ObjectMethod satisfiedByCache( $action, $web, $topic ) &rarr; $boolean </a>
</li> <li> <a href="#A_61ObjectMethod_61_setCacheControl_40_36pageType_44_92_37hopts_41"> ObjectMethod setCacheControl( $pageType, \%hopts ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_setETags_40_36cachedPage_44_92_37hopts_41_36boolean"> ObjectMethod setETags( $cachedPage, \%hopts ) &rarr; $boolean </a>
</li> <li> <a href="#A_61ObjectMethod_61_generateHTTPHeaders_40_92_37hopts_41"> ObjectMethod generateHTTPHeaders( \%hopts ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_redirectto_40_36url_41_36url"> ObjectMethod redirectto($url) &rarr; $url </a>
</li> <li> <a href="#A_61StaticMethod_61_splitAnchorFromUrl_40_36url_41_40_36url_44_36anchor_41"> StaticMethod splitAnchorFromUrl( $url ) &rarr; ( $url, $anchor ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_redirect_40_36url_44_36passthrough_44_36status_41"> ObjectMethod redirect( $url, $passthrough, $status ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_cacheQuery_40_41_36queryString"> ObjectMethod cacheQuery() &rarr; $queryString </a>
</li> <li> <a href="#A_61ObjectMethod_61_getCGISession_40_41_36cgisession"> ObjectMethod getCGISession() &rarr; $cgisession </a>
</li> <li> <a href="#A_61ObjectMethod_61_getLoginManager_40_41_36loginManager"> ObjectMethod getLoginManager() &rarr; $loginManager </a>
</li> <li> <a href="#A_61StaticMethod_61_isValidWikiWord_40_36name_41_36boolean"> StaticMethod isValidWikiWord( $name ) &rarr; $boolean </a>
</li> <li> <a href="#A_61StaticMethod_61_isValidTopicName_40_36name_91_44_36nonww_93_41_36boolean"> StaticMethod isValidTopicName( $name [, $nonww] ) &rarr; $boolean </a>
</li> <li> <a href="#A_61StaticMethod_61_isValidWebName_40_36name_44_36system_41_36boolean"> StaticMethod isValidWebName( $name, $system ) &rarr; $boolean </a>
</li> <li> <a href="#A_61StaticMethod_61_isValidEmailAddress_40_36name_41_36boolean"> StaticMethod isValidEmailAddress( $name ) &rarr; $boolean </a>
</li> <li> <a href="#A_61ObjectMethod_61_getSkin_40_41_36string"> ObjectMethod getSkin () &rarr; $string </a>
</li> <li> <a href="#A_61ObjectMethod_61_getScriptUrl_40_36absolute_44_36script_44_36web_44_36topic_44_..._41_36scriptURL"> ObjectMethod getScriptUrl( $absolute, $script, $web, $topic, ... ) &rarr; $scriptURL </a>
</li> <li> <a href="#A_61StaticMethod_61_make_params_40..._41"> StaticMethod make_params(...) </a>
</li> <li> <a href="#A_61ObjectMethod_61_getPubURL_40_36web_44_36topic_44_36attachment_44_37options_41_36url"> ObjectMethod getPubURL($web, $topic, $attachment, %options) &rarr; $url </a>
</li> <li> <a href="#A_61ObjectMethod_61_deepWebList_40_36filter_44_36web_41_64list"> ObjectMethod deepWebList($filter, $web) &rarr; @list </a>
</li> <li> <a href="#A_61ObjectMethod_61_normalizeWebTopicName_40_36web_44_36topic_41_40_36web_44_36topic_41"> ObjectMethod normalizeWebTopicName( $web, $topic ) &rarr; ( $web, $topic ) </a>
</li> <li> <a href="#A_61StaticMethod_61_load_package_40_36full_package_name_41"> StaticMethod load_package( $full_package_name ) </a>
</li> <li> <a href="#Private_parsePath_40_36this_44_36webtopic_44_36defaultweb_44_36topicOverride_41"> Private _parsePath( $this, $webtopic, $defaultweb, $topicOverride ) </a>
</li> <li> <a href="#A_61ClassMethod_61_new_40_36defaultUser_44_36query_44_92_37initialContext_41"> ClassMethod new( $defaultUser, $query, \%initialContext ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_renderer_40_41"> ObjectMethod renderer() </a>
</li> <li> <a href="#A_61ObjectMethod_61_renderer_AN1"> ObjectMethod renderer() </a>
</li> <li> <a href="#A_61ObjectMethod_61_attach_40_41"> ObjectMethod attach() </a>
</li> <li> <a href="#A_61ObjectMethod_61_templates_40_41"> ObjectMethod templates() </a>
</li> <li> <a href="#A_61ObjectMethod_61_i18n_40_41"> ObjectMethod i18n() </a>
</li> <li> <a href="#A_61ObjectMethod_61_reset_i18n_40_41"> ObjectMethod reset_i18n() </a>
</li> <li> <a href="#A_61ObjectMethod_61_logger_40_41"> ObjectMethod logger() </a>
</li> <li> <a href="#A_61ObjectMethod_61_search_40_41"> ObjectMethod search() </a>
</li> <li> <a href="#A_61ObjectMethod_61_net_40_41"> ObjectMethod net() </a>
</li> <li> <a href="#A_61ObjectMethod_61_access_40_41"> ObjectMethod access() </a>
</li> <li> <a href="#A_61ObjectMethod_61_DESTROY_40_41"> ObjectMethod DESTROY() </a>
</li> <li> <a href="#A_61ObjectMethod_61_finish_40_41"> ObjectMethod finish() </a>
</li> <li> <a href="#DEPRECATED_ObjectMethod_logEvent_40_36action_44_36webTopic_44_36extra_44_36user_41"> DEPRECATED ObjectMethod logEvent( $action, $webTopic, $extra, $user ) </a>
</li> <li> <a href="#A_61StaticMethod_61_validatePattern_40_36pattern_41_36pattern"> StaticMethod validatePattern( $pattern ) &rarr; $pattern </a>
</li> <li> <a href="#A_61ObjectMethod_61_inlineAlert_40_36template_44_36def_44_..._41_36string"> ObjectMethod inlineAlert($template, $def, ... ) &rarr; $string </a>
</li> <li> <a href="#A_61StaticMethod_61_parseSections_40_36text_41_40_36string_44_36sectionlistref_41"> StaticMethod parseSections($text) &rarr; ($string,$sectionlistref) </a>
</li> <li> <a href="#A_61ObjectMethod_61_expandMacrosOnTopicCreation_40_36topicObject_41"> ObjectMethod expandMacrosOnTopicCreation ( $topicObject ) </a>
</li> <li> <a href="#A_61StaticMethod_61_entityEncode_40_36text_91_44_36extras_93_41_36encodedText"> StaticMethod entityEncode( $text [, $extras] ) &rarr; $encodedText </a>
</li> <li> <a href="#A_61StaticMethod_61_entityDecode_40_36encodedText_41_36text"> StaticMethod entityDecode ( $encodedText ) &rarr; $text </a>
</li> <li> <a href="#A_61StaticMethod_61_urlEncode_40_36perlstring_41_36bytestring"> StaticMethod urlEncode( $perlstring ) &rarr; $bytestring </a>
</li> <li> <a href="#A_61StaticMethod_61_urlDecode_40_36bytestring_41_36perlstring"> StaticMethod urlDecode( $bytestring ) &rarr; $perlstring </a>
</li> <li> <a href="#A_61StaticMethod_61_isTrue_40_36value_44_36default_41_36boolean"> StaticMethod isTrue( $value, $default ) &rarr; $boolean </a>
</li> <li> <a href="#A_61StaticMethod_61_spaceOutWikiWord_40_36word_44_36sep_41_36string"> StaticMethod spaceOutWikiWord( $word, $sep ) &rarr; $string </a>
</li> <li> <a href="#A_61ObjectMethod_61_innerExpandMacros_40_92_36text_44_36topicObject_41"> ObjectMethod innerExpandMacros(\$text, $topicObject) </a>
</li> <li> <a href="#A_61StaticMethod_61_takeOutBlocks_40_92_36text_44_36tag_44_92_37map_41_36text"> StaticMethod takeOutBlocks( \$text, $tag, \%map ) &rarr; $text </a>
</li> <li> <a href="#A_61StaticMethod_61_putBackBlocks_40_92_36text_44_92_37map_44_36tag_44_36newtag_44_36callBack_41_36text"> StaticMethod putBackBlocks( \$text, \%map, $tag, $newtag, $callBack ) &rarr; $text </a>
</li> <li> <a href="#A_61ObjectMethod_61_enterContext_40_36id_44_36val_41"> ObjectMethod enterContext( $id, $val ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_leaveContext_40_36id_41"> ObjectMethod leaveContext( $id ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_inContext_40_36id_41"> ObjectMethod inContext( $id ) </a>
</li> <li> <a href="#A_61StaticMethod_61_registerTagHandler_40_36tag_44_36fnref_44_36syntax_41"> StaticMethod registerTagHandler( $tag, $fnref, $syntax ) </a>
</li> <li> <a href="#A_61ObjectMethod_61_expandMacros_40_36text_44_36topicObject_41_36text"> ObjectMethod expandMacros( $text, $topicObject ) &rarr; $text </a>
</li> <li> <a href="#A_61StaticMethod_61_readFile_40_36filename_41_36text"> StaticMethod readFile( $filename ) &rarr; $text </a>
</li> <li> <a href="#A_61StaticMethod_61_expandStandardEscapes_40_36str_41_36unescapedStr"> StaticMethod expandStandardEscapes($str) &rarr; $unescapedStr </a>
</li> <li> <a href="#A_61ObjectMethod_61_webExists_40_36web_41_36boolean"> ObjectMethod webExists( $web ) &rarr; $boolean </a>
</li> <li> <a href="#A_61ObjectMethod_61_topicExists_40_36web_44_36topic_41_36boolean"> ObjectMethod topicExists( $web, $topic ) &rarr; $boolean </a> <ul>
<li> <a href="#A_61ObjectMethod_61_getWorkArea_40_36key_41_36directorypath"> ObjectMethod getWorkArea( $key ) &rarr; $directorypath </a>
</li></ul> 
</li> <li> <a href="#A_61ObjectMethod_61_getApproxRevTime_40_36web_44_36topic_41_36epochSecs"> ObjectMethod getApproxRevTime (  $web, $topic  ) &rarr; $epochSecs </a>
</li></ul> 
</li></ul> 
</div>
<p></p>
<p></p>
<p></p>
<h2 id="A_61internal_package_61_Fosw_AN1">  <code>internal package</code> Foswiki </h2>
<p></p>
Foswiki operates by creating a singleton object (known as the Session
object) that acts as a point of reference for all the different
modules in the system. This package is the class for this singleton,
and also contains the vast bulk of the basic constants and the per-
site configuration mechanisms.
<p></p>
Global variables are avoided wherever possible to avoid problems
with CGI accelerators such as mod_perl.
<p></p>
<h3 id="Public_Data_members">  Public Data members </h3> <ul>
<li> <code>request</code>          Pointer to the <a href="PerlDoc.html">Foswiki::Request</a>
</li> <li> <code>response</code>         Pointer to the <a href="PerlDoc.html">Foswiki::Response</a>
</li> <li> <code>context</code>          Hash of context ids
</li> <li> <code>plugins</code>          <a href="PerlDoc.html">Foswiki::Plugins</a> singleton
</li> <li> <code>prefs</code>            <a href="PerlDoc.html">Foswiki::Prefs</a> singleton
</li> <li> <code>remoteUser</code>       Login ID when using <a class="foswikiNewLink" rel="nofollow" href="ApacheLogin.html" title="Create this topic">ApacheLogin</a>. Maintained for                        compatibility only, do not use.
</li> <li> <code>requestedWebName</code> Name of web found in URL path or <code>web</code> URL parameter
</li> <li> <code>scriptUrlPath</code>    URL path to the current script. May be dynamically                        extracted from the URL path if {GetScriptUrlFromCgi}.                        Only required to support {GetScriptUrlFromCgi} and                        not consistently used. Avoid.
</li> <li> <code>access</code>         <a href="PerlDoc.html">Foswiki::Access</a> singleton
</li> <li> <code>store</code>            <a href="PerlDoc.html">Foswiki::Store</a> singleton
</li> <li> <code>topicName</code>        Name of topic found in URL path or <code>topic</code> URL                        parameter
</li> <li> <code>urlHost</code>          Host part of the URL (including the protocol)                        determined during intialisation and defaulting to                        {DefaultUrlHost}
</li> <li> <code>user</code>             Unique user ID of logged-in user
</li> <li> <code>users</code>            <a href="PerlDoc.html">Foswiki::Users</a> singleton
</li> <li> <code>webName</code>          Name of web found in URL path, or <code>web</code> URL parameter,                        or {UsersWebName}
</li></ul> 
<p></p>
<blockquote class="foswikiAlert">#SMELL:  Perl 5.10.0 on Mac OSX Snow Leopard warns "v-string in use/require non-portable"</blockquote><blockquote class="foswikiAlert">        # SMELL : Should not assume environment variables; get data from request</blockquote>
<h3 id="A_61StaticMethod_61_decode_utf8_40_36octets_41_36unicode">  <code>StaticMethod</code> decode_utf8($octets) &rarr; $unicode </h3>
<p></p>
Decode a binary string of octets known to be encoded using UTF-8 into
perl characters (unicode).
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_encode_utf8_40_36unicode_41_36octets">  <code>StaticMethod</code> encode_utf8($unicode) &rarr; $octets </h3>
<p></p>
Encode a perl character string into a binary string of octets
encoded using UTF-8.
<p></p>
<blockquote class="foswikiAlert">       # SMELL: mod_perl compatibility note: If Foswiki is running under Apache,</blockquote>
<h3 id="A_61ObjectMethod_61_writeCompletePage_40_36text_44_36pageType_44_36contentType_41">  <code>ObjectMethod</code> writeCompletePage( $text, $pageType, $contentType ) </h3>
<p></p>
Write a complete HTML page with basic header to the browser. <ul>
<li> <code>$text</code> is the text of the page script (&lt;html&gt; to &lt;/html&gt; if it's HTML)
</li> <li> <code>$pageType</code> - May be "edit", which will cause headers to be generated that force     caching for 24 hours, to prevent <a title="Create this topic" rel="nofollow" class="foswikiNewLink" href="../Codev/BackFromPreviewLosesText.html">BackFromPreviewLosesText</a> bug, which caused     data loss with IE5 and IE6.
</li> <li> <code>$contentType</code> - page content type | text/html
</li></ul> 
<p></p>
This method removes noautolink and nop tags before outputting the page unless
$contentType is text/plain.
<p></p>
<blockquote class="foswikiAlert">        # SMELL: can't compute; faking content-type for backwards compatibility;</blockquote><blockquote class="foswikiAlert">        # SMELL: $ENV{'HTTP2'} is a non-standard way to detect http2 protocol</blockquote>
<h3 id="A_61ObjectMethod_61_satisfiedByCache_40_36action_44_36web_44_36topic_41_36boolean">  <code>ObjectMethod</code> satisfiedByCache( $action, $web, $topic ) &rarr; $boolean </h3>
<p></p>
Try and satisfy the current request for the given web.topic from the cache, given
the current action (view, edit, rest etc).
<p></p>
If the action is satisfied, the cache content is written to the output and
true is returned. Otherwise ntohing is written, and false is returned.
<p></p>
Designed for calling from <a href="PerlDoc.html">Foswiki::UI</a>::*
<p></p>
<blockquote class="foswikiAlert">     # SMELL: Cdot doesn't think any other status can get this far.</blockquote>
<h3 id="A_61ObjectMethod_61_setCacheControl_40_36pageType_44_92_37hopts_41">  <code>ObjectMethod</code> setCacheControl( $pageType, \%hopts ) </h3>
<p></p>
Set the cache control headers in a response
<p></p> <ul>
<li> <code>$pageType</code> - page type - 'view', ;edit' etc
</li> <li> =\%hopts - ref to partially filled in hash of headers
</li></ul> 
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_setETags_40_36cachedPage_44_92_37hopts_41_36boolean">  <code>ObjectMethod</code> setETags( $cachedPage, \%hopts ) &rarr; $boolean </h3>
<p></p>
Set etags (and modify status) depending on what the cached page specifies.
Return 1 if the page has been modified since it was last retrieved, 0 otherwise.
<p></p> <ul>
<li> <code>$cachedPage</code> - page cache to use
</li> <li> =\%hopts - ref to partially filled in hash of headers
</li></ul> 
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_generateHTTPHeaders_40_92_37hopts_41">  <code>ObjectMethod</code> generateHTTPHeaders( \%hopts ) </h3>
<p></p>
All parameters are optional. <ul>
<li> =\%hopts - optional ref to partially filled in hash of headers (will be written to)
</li></ul> 
<p></p>
<blockquote class="foswikiAlert">    #TODO: this should really use URI</blockquote>
<h3 id="A_61ObjectMethod_61_redirectto_40_36url_41_36url">  <code>ObjectMethod</code> redirectto($url) &rarr; $url </h3>
<p></p>
If the CGI parameter 'redirectto' is present on the query, then will validate
that it is a legal redirection target (url or topic name). If 'redirectto'
is not present on the query, performs the same steps on $url.
<p></p>
Returns undef if the target is not valid, and the target URL otherwise.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_splitAnchorFromUrl_40_36url_41_40_36url_44_36anchor_41">  <code>StaticMethod</code> splitAnchorFromUrl( $url ) &rarr; ( $url, $anchor ) </h3>
<p></p>
Takes a full url (including possible query string) and splits off the anchor.
The anchor includes the # sign. Returns an empty string if not found in the url.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_redirect_40_36url_44_36passthrough_44_36status_41">  <code>ObjectMethod</code> redirect( $url, $passthrough, $status ) </h3>
<p></p> <ul>
<li> $url - url or topic to redirect to
</li> <li> $passthrough - (optional) parameter to pass through current query     parameters (see below)
</li> <li> $status - HTTP status code (30x) to redirect with. Defaults to 302.
</li></ul> 
<p></p>
Redirects the request to <code>$url</code>, <strong>unless</strong> <ol>
<li> It is overridden by a plugin declaring a <code>redirectCgiQueryHandler</code>     (a dangerous, deprecated handler!)
</li> <li> <code>$session-&gt;{request}</code> is <code>undef</code>
</li></ol> 
Thus a redirect is only generated when in a CGI context.
<p></p>
Normally this method will ignore parameters to the current query. Sometimes,
for example when redirecting to a login page during authentication (and then
again from the login page to the original requested URL), you want to make
sure all parameters are passed on, and for this $passthrough should be set to
true. In this case it will pass all parameters that were passed to the
current query on to the redirect target. If the request_method for the
current query was GET, then all parameters will be passed by encoding them
in the URL (after ?). If the request_method was POST, then there is a risk the
URL would be too big for the receiver, so it caches the form data and passes
over a cache reference in the redirect GET.
<p></p>
NOTE: Passthrough is only meaningful if the redirect target is on the same
server.
<p></p>
<blockquote class="foswikiAlert">    # TODO: this should really use URI</blockquote>
<h3 id="A_61ObjectMethod_61_cacheQuery_40_41_36queryString">  <code>ObjectMethod</code> cacheQuery() &rarr; $queryString </h3>
<p></p>
Caches the current query in the params cache, and returns a rewritten
query string for the cache to be picked up again on the other side of a
redirect.
<p></p>
We can't encode post params into a redirect, because they may exceed the
size of the GET request. So we cache the params, and reload them when the
redirect target is reached.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_getCGISession_40_41_36cgisession">  <code>ObjectMethod</code> getCGISession() &rarr; $cgisession </h3>
<p></p>
Get the CGI::Session object associated with this session, if there is
one. May return undef.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_getLoginManager_40_41_36loginManager">  <code>ObjectMethod</code> getLoginManager() &rarr; $loginManager </h3>
<p></p>
Get the <a href="PerlDoc.html">Foswiki::LoginManager</a> object associated with this session, if there is
one. May return undef.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_isValidWikiWord_40_36name_41_36boolean">  <code>StaticMethod</code> isValidWikiWord( $name ) &rarr; $boolean </h3>
<p></p>
Check for a valid <a href="WikiWord.html">WikiWord</a> or <a href="WikiName.html">WikiName</a>
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_isValidTopicName_40_36name_91_44_36nonww_93_41_36boolean">  <code>StaticMethod</code> isValidTopicName( $name [, $nonww] ) &rarr; $boolean </h3>
<p></p>
Check for a valid topic <code>$name</code>. If <code>$nonww</code>, then accept non wiki-words
(though they must still be composed of only valid, unfiltered characters)
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_isValidWebName_40_36name_44_36system_41_36boolean">  <code>StaticMethod</code> isValidWebName( $name, $system ) &rarr; $boolean </h3>
<p></p>
STATIC Check for a valid web name. If $system is true, then
system web names are considered valid (names starting with _)
otherwise only user web names are valid
<p></p>
If $Foswiki::cfg{EnableHierarchicalWebs} is off, it will also return false
when a nested web name is passed to it.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_isValidEmailAddress_40_36name_41_36boolean">  <code>StaticMethod</code> isValidEmailAddress( $name ) &rarr; $boolean </h3>
<p></p>
STATIC Check for a valid email address name.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_getSkin_40_41_36string">  <code>ObjectMethod</code> getSkin () &rarr; $string </h3>
<p></p>
Get the currently requested skin path
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_getScriptUrl_40_36absolute_44_36script_44_36web_44_36topic_44_..._41_36scriptURL">  <code>ObjectMethod</code> getScriptUrl( $absolute, $script, $web, $topic, ... ) &rarr; $scriptURL </h3>
<p></p>
Returns the URL to a Foswiki script, providing the web and topic as
"path info" parameters.  The result looks something like this:
"http://host/foswiki/bin/$script/$web/$topic". <ul>
<li> <code>...</code> - an arbitrary number of name,value parameter pairs that will
</li></ul> 
be url-encoded and added to the url. The special parameter name '#' is
reserved for specifying an anchor. e.g.
<code>getScriptUrl('x','y','view','#'=&gt;'XXX',a=&gt;1,b=&gt;2)</code> will give
<code>.../view/x/y?a=1&amp;b=2#XXX</code>
<p></p>
If $absolute is set, generates an absolute URL. $absolute is advisory only;
Foswiki can decide to generate absolute URLs (for example when run from the
command-line) even when relative URLs have been requested.
<p></p>
The default script url is taken from {ScriptUrlPath}, unless there is
an exception defined for the given script in {ScriptUrlPaths}. Both
{ScriptUrlPath} and {ScriptUrlPaths} may be absolute or relative URIs. If
they are absolute, then they will always generate absolute URLs. if they
are relative, then they will be converted to absolute when required (e.g.
when running from the command line, or when generating rss). If
$script is not given, absolute URLs will always be generated.
<p></p>
If either the web or the topic is defined, will generate a full url (including web and topic). Otherwise will generate only up to the script name. An undefined web will default to the main web name.
<p></p>
As required by RFC3986, the returned URL will only contain the
allowed characters -A-Za-z0-9_.~!*\'();:@&amp;=+$,/?%#[]
<p></p>
<blockquote class="foswikiAlert">    # SMELL: topics and webs that contain spaces?</blockquote>
<h3 id="A_61StaticMethod_61_make_params_40..._41">  <code>StaticMethod</code> make_params(...) </h3>
Generate a URL parameters string from parameters given. A parameter
named '#' will generate a fragment identifier.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_getPubURL_40_36web_44_36topic_44_36attachment_44_37options_41_36url">  <code>ObjectMethod</code> getPubURL($web, $topic, $attachment, %options) &rarr; $url </h3>
<p></p>
Composes a pub url. <ul>
<li> <code>$web</code> - name of the web for the URL, defaults to $session-&gt;{webName}
</li> <li> <code>$topic</code> - name of the topic, defaults to $session-&gt;{topicName}
</li> <li> <code>$attachment</code> - name of the attachment, defaults to no attachment
</li></ul> 
Supported %options are: <ul>
<li> <code>topic_version</code> - version of topic to retrieve attachment from
</li> <li> <code>attachment_version</code> - version of attachment to retrieve
</li> <li> <code>absolute</code> - requests an absolute URL (rather than a relative path)
</li></ul> 
<p></p>
If <code>$web</code> is not given, <code>$topic</code> and <code>$attachment</code> are ignored.
If <code>$topic</code> is not given, <code>$attachment</code> is ignored.
<p></p>
If <code>topic_version</code> is not given, the most recent revision of the topic
will be linked. Similarly if attachment_version= is not given, the most recent
revision of the attachment will be assumed. If <code>topic_version</code> is specified
but <code>attachment_version</code> is not (or the specified <code>attachment_version</code> is not
present), then the most recent version of the attachment in that topic version
will be linked.
<p></p>
If Foswiki is running in an absolute URL context (e.g. the skin requires
absolute URLs, such as print or rss, or Foswiki is running from the
command-line) then <code>absolute</code> will automatically be set.
<p></p>
Note: for compatibility with older plugins, which use %PUBURL*% with
a constructed URL path, do not use <code>*</code> unless <code>web</code>, <code>topic</code>, and
<code>attachment</code> are all specified.
<p></p>
As required by RFC3986, the returned URL will only contain the
allowed characters -A-Za-z0-9_.~!*\'();:@&amp;=+$,/?%#[]
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_deepWebList_40_36filter_44_36web_41_64list">  <code>ObjectMethod</code> deepWebList($filter, $web) &rarr; @list </h3>
<p></p>
Deep list subwebs of the named web. $filter is a <a href="PerlDoc.html">Foswiki::WebFilter</a>
object that is used to filter the list. The listing of subwebs is
dependent on $Foswiki::cfg{EnableHierarchicalWebs} being true.
<p></p>
Webs are returned as absolute web pathnames.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_normalizeWebTopicName_40_36web_44_36topic_41_40_36web_44_36topic_41">  <code>ObjectMethod</code> normalizeWebTopicName( $web, $topic ) &rarr; ( $web, $topic ) </h3>
<p></p>
Normalize a Web.TopicName
<p></p>
See <code><a href="PerlDoc.html">Foswiki::Func</a></code> for a full specification of the expansion (not duplicated
here)
<p></p>
<strong>WARNING</strong> if there is no web specification (in the web or topic parameters)
the web defaults to $Foswiki::cfg{UsersWebName}. If there is no topic
specification, or the topic is '0', the topic defaults to the web home topic
name.
<p></p>
<strong>WARNING</strong> if the input topic name is tainted, then the output web and
topic names will be tainted.
<p></p>
<blockquote class="foswikiAlert">   #SMELL: Item12567: Writing the separator as a character class for some reason</blockquote>
<h3 id="A_61StaticMethod_61_load_package_40_36full_package_name_41">  <code>StaticMethod</code> load_package( $full_package_name ) </h3>
<p></p>
Will cleanly load the package or fail. This is better than 'eval "require $package"'.
<p></p>
It is not perfect for Perl &lt; 5.10. For Perl 5.8, if somewhere else 'eval "require $package"' 
was used <strong>earlier</strong> for a module that fails to load, then not only is the failure not detected
then. Neither will it be detected here.
<p></p>
The recommendation is to replace all dynamic require calls in Foswiki to be replaced with this call.
<p></p>
This functionality used to be done via module Class::Load, but that had painful dependencies.
<p></p>
See <a href="http://blog.fox.geek.nz/2010/11/searching-design-spec-for-ultimate.html">http://blog.fox.geek.nz/2010/11/searching-design-spec-for-ultimate.html</a> for the gory details.
<p></p>
<p></p>
<h3 id="Private_parsePath_40_36this_44_36webtopic_44_36defaultweb_44_36topicOverride_41">  Private _parsePath( $this, $webtopic, $defaultweb, $topicOverride ) </h3>
<p></p>
Parses the Web/Topic path parameters to safely establish a valid web and topic,
or assign safe defaults.
<p></p> <ul>
<li> $webtopic - A "web/topic" path.  It might have originated from the query path_info,   or from the topic= URL parameter. (only when the topic param contained a web component)
</li> <li> $defaultweb - The default web to use if the web part of webtopic is missing or invalid.   This can be from the default <a title="Create this topic" rel="nofollow" class="foswikiNewLink" href="UsersWebName.html">UsersWebName</a>,  or from the url parameter defaultweb.
</li> <li> $topicOverride - A topic name to use instead of any topic provided in the pathinfo.
</li></ul> 
<p></p>
Note if $webtopic ends with a trailing slash, it provides a hint that the last component should be
considered web.  This allows disambiguation between a topic and subweb with the same name.
Trailing slash forces it to be recognized as a webname, otherwise the topic is shown.
Note. If the web doesn't exist, the force will be ignored.  It's not possible to create a missing web
by referencing it in a URL.
<p></p>
This routine sets two variables when encountering invalid input: <ul>
<li> $this-&gt;{invalidWeb}  contains original invalid web / pathinfo content when validation fails.
</li> <li> $this-&gt;{invalidTopic} Same function but for topic name
</li></ul> 
When invalid / illegal characters are encountered, the session {webName} and {topicName} will be
defaulted to safe defaults.  Scripts using those fields should also test if the corresponding
invalid* versions are defined, and should throw an oops exception rathern than allowing execution
to proceed with defaulted values.
<p></p>
The topic name will always have the first character converted to upper case, to prevent creation of
or access to invalid topics.
<p></p>
<p></p>
<h3 id="A_61ClassMethod_61_new_40_36defaultUser_44_36query_44_92_37initialContext_41">  <code>ClassMethod</code> new( $defaultUser, $query, \%initialContext ) </h3>
<p></p>
Constructs a new Foswiki session object. A unique session object exists for
every transaction with Foswiki, for example every browser request, or every
script run. Session objects do not persist between mod_perl runs.
<p></p> <ul>
<li> <code>$defaultUser</code> is the username (<strong>not</strong> the wikiname) of the default     user you want to be logged-in, if none is available from a session     or browser. Used mainly for unit tests and debugging, it is typically     undef, in which case the default user is taken from     $Foswiki::cfg{DefaultUserName}.
</li> <li> <code>$query</code> the <a href="PerlDoc.html">Foswiki::Request</a> query (may be undef, in which case an     empty query is used)
</li> <li> <code>\%initialContext</code> - reference to a hash containing context     name=value pairs to be pre-installed in the context hash. May be undef.
</li></ul> 
<p></p>
<blockquote class="foswikiAlert">        # SMELL: how can we validate the PATH?</blockquote><blockquote class="foswikiAlert">        # SMELL: this is a really dangerous hack. It will fail</blockquote><blockquote class="foswikiAlert">        # SMELL: why not just use $query-&gt;script_name?</blockquote><blockquote class="foswikiAlert">        # SMELL: unchecked implicit untaint?</blockquote><blockquote class="foswikiAlert">   # SMELL: It is completely bogus that we do this for the jsonrpc script.</blockquote><blockquote class="foswikiAlert">    # SMELL: what happens if we move this into the Foswiki::Users::new?</blockquote><blockquote class="foswikiAlert">    # SMELL: should collapse these into one. The duplication is pretty</blockquote>
<h3 id="A_61ObjectMethod_61_renderer_40_41">  <code>ObjectMethod</code> renderer() </h3>
Get a reference to the renderer object. Done lazily because not everyone
needs the renderer.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_renderer_AN1">  <code>ObjectMethod</code> renderer() </h3>
Get a reference to the zone renderer object. Done lazily because not everyone
needs the zones.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_attach_40_41">  <code>ObjectMethod</code> attach() </h3>
Get a reference to the attach object. Done lazily because not everyone
needs the attach.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_templates_40_41">  <code>ObjectMethod</code> templates() </h3>
Get a reference to the templates object. Done lazily because not everyone
needs the templates.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_i18n_40_41">  <code>ObjectMethod</code> i18n() </h3>
Get a reference to the i18n object. Done lazily because not everyone
needs the i18ner.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_reset_i18n_40_41">  <code>ObjectMethod</code> reset_i18n() </h3>
Kill the i18n object, if there is one, to force language re-initialisation.
Essential for changing language dynamically.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_logger_40_41">  <code>ObjectMethod</code> logger() </h3>
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_search_40_41">  <code>ObjectMethod</code> search() </h3>
Get a reference to the search object. Done lazily because not everyone
needs the searcher.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_net_40_41">  <code>ObjectMethod</code> net() </h3>
Get a reference to the net object. Done lazily because not everyone
needs the net.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_access_40_41">  <code>ObjectMethod</code> access() </h3>
Get a reference to the ACL object. 
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_DESTROY_40_41">  <code>ObjectMethod</code> DESTROY() </h3>
<p></p>
called by Perl when the Foswiki object goes out of scope
(maybe should be used kist to ASSERT that finish() was called..
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_finish_40_41">  <code>ObjectMethod</code> finish() </h3>
Break circular references.
<p></p>
<p></p>
<h3 id="DEPRECATED_ObjectMethod_logEvent_40_36action_44_36webTopic_44_36extra_44_36user_41">  DEPRECATED  <a href="ObjectMethod.html">ObjectMethod</a> logEvent( $action, $webTopic, $extra, $user ) </h3> <ul>
<li> <code>$action</code> - what happened, e.g. view, save, rename
</li> <li> <code>$webTopic</code> - what it happened to
</li> <li> <code>$extra</code> - extra info, such as minor flag
</li> <li> <code>$user</code> - login name of user - default current user,     or failing that the user agent
</li></ul> 
<p></p>
Write the log for an event to the logfile
<p></p>
The method is deprecated,  Call logger-&gt;log directly.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_validatePattern_40_36pattern_41_36pattern">  <code>StaticMethod</code> validatePattern( $pattern ) &rarr; $pattern </h3>
<p></p>
Validate a pattern provided in a parameter to $pattern so that
dangerous chars (interpolation and execution) are disabled.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_inlineAlert_40_36template_44_36def_44_..._41_36string">  <code>ObjectMethod</code> inlineAlert($template, $def, ... ) &rarr; $string </h3>
<p></p>
Format an error for inline inclusion in rendered output. The message string
is obtained from the template 'oops'.$template, and the DEF $def is
selected. The parameters (...) are used to populate %PARAM1%..%PARAMn%
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_parseSections_40_36text_41_40_36string_44_36sectionlistref_41">  <code>StaticMethod</code> parseSections($text) &rarr; ($string,$sectionlistref) </h3>
<p></p>
Generic parser for sections within a topic. Sections are delimited
by STARTSECTION and ENDSECTION, which may be nested, overlapped or
otherwise abused. The parser builds an array of sections, which is
ordered by the order of the STARTSECTION within the topic. It also
removes all the SECTION tags from the text, and returns the text
and the array of sections.
<p></p>
Each section is a <code><a href="PerlDoc.html">Foswiki::Attrs</a></code> object, which contains the attributes
{type, name, start, end}
where start and end are character offsets in the
string <strong>after all section tags have been removed</strong>. All sections
are required to be uniquely named; if a section is unnamed, it
will be given a generated name. Sections may overlap or nest.
<p></p>
See test/unit/Fn_SECTION.pm for detailed testcases that
round out the spec.
<p></p>
<blockquote class="foswikiAlert">            # SMELL: unchecked implicit untaint?</blockquote><blockquote class="foswikiAlert">            # SMELL: unchecked implicit untaint?</blockquote>
<h3 id="A_61ObjectMethod_61_expandMacrosOnTopicCreation_40_36topicObject_41">  <code>ObjectMethod</code> expandMacrosOnTopicCreation ( $topicObject ) </h3>
<p></p> <ul>
<li> <code>$topicObject</code> - the topic
</li></ul> 
<p></p>
Expand only that subset of Foswiki variables that are
expanded during topic creation, in the body text and
PREFERENCE meta only. The expansion is in-place inside
the topic object.
<p></p>
# SMELL: no plugin handler
<blockquote class="foswikiAlert"># SMELL: no plugin handler</blockquote>
<p></p>
<h3 id="A_61StaticMethod_61_entityEncode_40_36text_91_44_36extras_93_41_36encodedText">  <code>StaticMethod</code> entityEncode( $text [, $extras] ) &rarr; $encodedText </h3>
<p></p>
Escape special characters to HTML numeric entities. This is <strong>not</strong> a generic
encoding, it is tuned specifically for use in Foswiki.
<p></p>
HTML4.0 spec:
"Certain characters in HTML are reserved for use as markup and must be
escaped to appear literally. The "&lt;" character may be represented with
an <em>entity</em>, <strong class=html>&amp;lt;</strong>. Similarly, "&gt;"
is escaped as <strong class=html>&amp;gt;</strong>, and "&amp;" is escaped
as <strong class=html>&amp;amp;</strong>. If an attribute value contains a
double quotation mark and is delimited by double quotation marks, then the
quote should be escaped as <strong class=html>&amp;quot;</strong>.
<p></p>
Other entities exist for special characters that cannot easily be entered
with some keyboards..."
<p></p>
This method encodes: <ul>
<li> all non-printable 7-bit chars (&lt; \x1f), except \n (\xa) and \r (\xd)
</li> <li> HTML special characters '&gt;', '&lt;', '&amp;', ''' (single quote) and '"' (double quote).
</li> <li> TML special characters '%', '|', '[', ']', '@', '_', '*', '$' and "="
</li></ul> 
<p></p>
$extras is an optional param that may be used to include <strong>additional</strong>
characters in the set of encoded characters. It should be a string
containing the additional chars.
<p></p>
This internal function is available for use by expanding the <code>%ENCODE</code> macro,
or the <code>%URLPARAM</code> macro, specifying <code>type="entities"</code> or <code>type="entity"</code>.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_entityDecode_40_36encodedText_41_36text">  <code>StaticMethod</code> entityDecode ( $encodedText ) &rarr; $text </h3>
<p></p>
Decodes all numeric entities (e.g. &amp;#123;). <em>Does not</em> decode
named entities such as &amp;amp; (use HTML::Entities for that)
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_urlEncode_40_36perlstring_41_36bytestring">  <code>StaticMethod</code> urlEncode( $perlstring ) &rarr; $bytestring </h3>
<p></p>
Encode by converting characters that are reserved in URLs to
their %NN equivalents. This method is used for encoding
strings that must be embedded <em>verbatim</em> in URLs; it cannot
be applied to URLs themselves, as it escapes reserved
characters such as =, &amp;, %, ;, # and ?.
<p></p>
RFC 1738, Dec. '94:
    <pre>
    ...Only alphanumerics &#91;0-9a-zA-Z&#93;, the special
    characters &#36;-&#95;.+!&#42;&#39;(), and reserved characters used for their
    reserved purposes may be used unencoded within a URL.
    </pre>
<p></p>
However this function is tuned for use with Foswiki. As such, it
encodes <strong>all</strong> characters except 0-9a-zA-Z-_.:~!*/
<p></p>
This internal function is available for use by expanding the <code>%ENCODE</code> macro,
specifying <code>type="url"</code>.  It is also the default encoding used by the <code>%URLPARAM</code> macro. 
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_urlDecode_40_36bytestring_41_36perlstring">  <code>StaticMethod</code> urlDecode( $bytestring ) &rarr; $perlstring </h3>
<p></p>
Reverses the encoding done in urlEncode.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_isTrue_40_36value_44_36default_41_36boolean">  <code>StaticMethod</code> isTrue( $value, $default ) &rarr; $boolean </h3>
<p></p>
Returns 1 if <code>$value</code> is true, and 0 otherwise. "true" means set to
something with a Perl true value, with the special cases that "off",
"false" and "no" (case insensitive) are forced to false. Leading and
trailing spaces in <code>$value</code> are ignored.
<p></p>
If the value is undef, then <code>$default</code> is returned. If <code>$default</code> is
not specified it is taken as 0.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_spaceOutWikiWord_40_36word_44_36sep_41_36string">  <code>StaticMethod</code> spaceOutWikiWord( $word, $sep ) &rarr; $string </h3>
<p></p>
Spaces out a wiki word by inserting a string (default: one space) between each word component.
With parameter $sep any string may be used as separator between the word components; if $sep is undefined it defaults to a space.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_innerExpandMacros_40_92_36text_44_36topicObject_41">  <code>ObjectMethod</code> innerExpandMacros(\$text, $topicObject) </h3>
Expands variables by replacing the variables with their
values. Some example variables: %TOPIC%, %SCRIPTURL%,
%WIKINAME%, etc.
$web and $incs are passed in for recursive include expansion. They can
safely be undef.
The rules for tag expansion are: <ol>
<li> Tags are expanded left to right, in the order they are encountered.
</li> <li> Tags are recursively expanded as soon as they are encountered -     the algorithm is inherently single-pass
</li> <li> A tag is not "encountered" until the matching }% has been seen, by     which time all tags in parameters will have been expanded
</li> <li> Tag expansions that create new tags recursively are limited to a     set number of hierarchical levels of expansion
</li></ol> 
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_takeOutBlocks_40_92_36text_44_36tag_44_92_37map_41_36text">  <code>StaticMethod</code> takeOutBlocks( \$text, $tag, \%map ) &rarr; $text </h3> <ul>
<li> <code>$text</code> - Text to process
</li> <li> <code>$tag</code> - XML-style tag.
</li> <li> <code>\%map</code> - Reference to a hash to contain the removed blocks
</li></ul> 
<p></p>
Return value: $text with blocks removed
<p></p>
Searches through $text and extracts blocks delimited by an XML-style tag,
storing the extracted block, and replacing with a token string which is
not affected by TML rendering.  The text after these substitutions is
returned.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_putBackBlocks_40_92_36text_44_92_37map_44_36tag_44_36newtag_44_36callBack_41_36text">  <code>StaticMethod</code> putBackBlocks( \$text, \%map, $tag, $newtag, $callBack ) &rarr; $text </h3>
<p></p>
Return value: $text with blocks added back <ul>
<li> <code>\$text</code> - reference to text to process
</li> <li> <code>\%map</code> - map placeholders to blocks removed by takeOutBlocks
</li> <li> <code>$tag</code> - Tag name processed by takeOutBlocks
</li> <li> <code>$newtag</code> - Tag name to use in output, in place of $tag.     If undefined, uses $tag.
</li> <li> <code>$callback</code> - Reference to function to call on each block     being inserted (optional)
</li></ul> 
<p></p>
Reverses the actions of takeOutBlocks.
<p></p>
Each replaced block is processed by the callback (if there is one) before
re-insertion.
<p></p>
Parameters to the outermost cut block are replaced into the open tag,
even if that tag is changed. This allows things like <code>&lt;verbatim class=''&gt;</code>
to be changed to <code>&lt;pre class=''&gt;</code>
<p></p>
If you set $newtag to '', replaces the taken-out block with the contents
of the block, not including the open/close. This is used for &lt;literal&gt;,
for example.
<p></p>
<blockquote class="foswikiAlert">                # SMELL: unchecked implicit untaint?</blockquote>
<h3 id="A_61ObjectMethod_61_enterContext_40_36id_44_36val_41">  <code>ObjectMethod</code> enterContext( $id, $val ) </h3>
<p></p>
Add the context id $id into the set of active contexts. The $val
can be anything you like, but should always evaluate to boolean
TRUE.
<p></p>
An example of the use of contexts is in the use of tag
expansion. The commonTagsHandler in plugins is called every
time tags need to be expanded, and the context of that expansion
is signalled by the expanding module using a context id. So the
forms module adds the context id "form" before invoking common
tags expansion.
<p></p>
Contexts are not just useful for tag expansion; they are also
relevant when rendering.
<p></p>
Contexts are intended for use mainly by plugins. Core modules can
use $session-&gt;inContext( $id ) to determine if a context is active.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_leaveContext_40_36id_41">  <code>ObjectMethod</code> leaveContext( $id ) </h3>
<p></p>
Remove the context id $id from the set of active contexts.
(see <code>enterContext</code> for more information on contexts)
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_inContext_40_36id_41">  <code>ObjectMethod</code> inContext( $id ) </h3>
<p></p>
Return the value for the given context id
(see <code>enterContext</code> for more information on contexts)
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_registerTagHandler_40_36tag_44_36fnref_44_36syntax_41">  <code>StaticMethod</code> registerTagHandler( $tag, $fnref, $syntax ) </h3>
<p></p>
STATIC Add a tag handler to the function tag handlers. <ul>
<li> <code>$tag</code> name of the tag e.g. MYTAG
</li> <li> <code>$fnref</code> Function to execute. Will be passed ($session, \%params, $web, $topic )
</li> <li> <code>$syntax</code> somewhat legacy - 'classic' or 'context-free' (context-free may be removed in future)
</li></ul> 
<p></p>
<p></p>
$syntax parameter:
Way back in prehistory, back when the dinosaur still roamed the earth, 
Crawford tried to extend the tag syntax of macros such that they could be processed 
by a context-free parser (hence the "context-free") 
and bring them into line with HTML. 
This work was banjaxed by one particular tyrranosaur, 
who felt that the existing syntax was perfect. 
However by that time Crawford had used it in a couple of places - most notable in the action tracker. 
<p></p>
The syntax isn't vastly different from what's there; the differences are:  <ol>
<li> Use either type of quote for parameters 
</li> <li> Optional quotes on parameter values e.g. recurse=on 
</li> <li> Standardised use of \ for escapes 
</li> <li> Boolean (valueless) options (i.e. recurse instead of recurse="on" 
</li></ol> 
<p></p>
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_expandMacros_40_36text_44_36topicObject_41_36text">  <code>ObjectMethod</code> expandMacros( $text, $topicObject ) &rarr; $text </h3>
<p></p>
Processes %VARIABLE%, and %TOC% syntax; also includes
'commonTagsHandler' plugin hook.
<p></p>
Returns the text of the topic, after file inclusion, variable substitution,
table-of-contents generation, and any plugin changes from commonTagsHandler.
<p></p>
$topicObject may be undef when, for example, expanding templates, or one-off strings
at a time when meta isn't available.
<p></p>
DO NOT CALL THIS DIRECTLY; use $topicObject-&gt;expandMacros instead.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_readFile_40_36filename_41_36text">  <code>StaticMethod</code> readFile( $filename ) &rarr; $text </h3>
<p></p>
Returns the entire contents of the given file, which can be specified in any
format acceptable to the Perl open() function. Fast, but inherently unsafe.
<p></p>
WARNING: Never, ever use this for accessing topics or attachments! Use the
Store API for that. This is for global control files only, and should be
used <strong>only</strong> if there is <strong>absolutely no alternative</strong>.
<p></p>
<p></p>
<h3 id="A_61StaticMethod_61_expandStandardEscapes_40_36str_41_36unescapedStr">  <code>StaticMethod</code> expandStandardEscapes($str) &rarr; $unescapedStr </h3>
<p></p>
Expands standard escapes used in parameter values to block evaluation. See
<a href="FormatTokens.html">FormatTokens</a> for a full list of supported tokens.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_webExists_40_36web_41_36boolean">  <code>ObjectMethod</code> webExists( $web ) &rarr; $boolean </h3>
<p></p>
Test if web exists <ul>
<li> <code>$web</code> - Web name, required, e.g. <code>'Sandbox'</code>
</li></ul> 
<p></p>
A web <em>has</em> to have a preferences topic to be a web.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_topicExists_40_36web_44_36topic_41_36boolean">  <code>ObjectMethod</code> topicExists( $web, $topic ) &rarr; $boolean </h3>
<p></p>
Test if topic exists <ul>
<li> <code>$web</code> - Web name, optional, e.g. <code>'Main'</code>
</li> <li> <code>$topic</code> - Topic name, required, e.g. <code>'TokyoOffice'</code>, or <code>"Main.TokyoOffice"</code>
</li></ul> 
<p></p>
<p></p>
<h4 id="A_61ObjectMethod_61_getWorkArea_40_36key_41_36directorypath">  <code>ObjectMethod</code> getWorkArea( $key ) &rarr; $directorypath </h4>
<p></p>
Gets a private directory uniquely identified by $key. The directory is
intended as a work area for plugins etc. The directory will exist.
<p></p>
<p></p>
<h3 id="A_61ObjectMethod_61_getApproxRevTime_40_36web_44_36topic_41_36epochSecs">  <code>ObjectMethod</code> getApproxRevTime (  $web, $topic  ) &rarr; $epochSecs </h3>
<p></p>
Get an approximate rev time for the latest rev of the topic. This method
is used to optimise searching. Needs to be as fast as possible.
<p></p>
SMELL: is there a reason this is in Foswiki.pm, and not in Search?
<blockquote class="foswikiAlert">SMELL: is there a reason this is in Foswiki.pm, and not in Search?</blockquote>
<blockquote class="foswikiAlert"> <strong>SMELL / FIX / TODO count: 22</strong>
</blockquote>
<p></p>
<hr />
<p></p>
<hr />
<p></p>
</body>