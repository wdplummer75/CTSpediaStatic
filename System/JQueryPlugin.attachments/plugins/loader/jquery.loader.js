"use strict";!function(e){var o={mode:"manual",url:void 0,params:{},topic:void 0,section:void 0,skin:"text",select:void 0,hideEffect:"fadeOut",showEffect:"fadeIn",reloadAfter:0,delay:0,onload:function(){},finished:function(){},beforeload:function(){}};function t(t,n){var i=this;i.elem=e(t),i.opts=e.extend({},o,n),i.elem.is("pre")?i.setContent(""):i.container=i.elem.contents().wrapAll("<div class='jqLoaderContainer'></div>").parent(),i.init(),"auto"===i.opts.mode?i.loadAfter():i.opts.reloadAfter&&i.loadAfter(i.opts.reloadAfter)}t.prototype.setContent=function(o){var t=this;void 0!==t.container&&t.container.remove(),t.elem.empty(),t.container=e("<div class='jqLoaderContainer'></div>"),t.container.append(o),t.elem.is("pre")?t.container.insertAfter(t.elem):t.container.appendTo(t.elem)},t.prototype.init=function(){var o=this;o.elem.on("refresh.jqloader",(function(t,n){e.extend(o.opts,n),o.loadAfter(0),t.stopPropagation()})),"function"==typeof o.opts.onload&&o.elem.on("onload.jqloader",(function(e){o.opts.onload.call(o),e.stopPropagation()})),"function"==typeof o.opts.beforeload&&o.elem.on("beforeload.jqloader",(function(e){o.opts.beforeload.call(o),e.stopPropagation()})),"function"==typeof o.opts.finished&&o.elem.on("finished.jqloader",(function(e){o.opts.finished.call(o),e.stopPropagation()})),o.opts.reloadAfter&&o.elem.on("finished.jqloader",(function(e){o.loadAfter(o.opts.reloadAfter),e.stopPropagation()}))},t.prototype.loadAfter=function(e){var o=this;e=e||o.opts.delay,void 0!==o.timer&&(window.clearTimeout(o.timer),o.timer=void 0),e?o.timer=window.setTimeout((function(){o.load()}),e):o.load()},t.prototype.load=function(){var o=this,t=o.opts.web||foswiki.getPreference("WEB"),n=o.opts.topic||foswiki.getPreference("TOPIC"),i=e.extend({},o.opts.params),a=o.opts.url;void 0===a&&(a=foswiki.getScriptUrl("view",t,n)),void 0!==o.opts.section&&(i.section=o.opts.section),void 0!==o.opts.skin&&o.opts.skin&&(i.skin=o.opts.skin),o.opts.hideEffect&&o.container.animateCSS({effect:o.opts.hideEffect}).one("stop.animate",(function(){o.container.hide()})),o.elem.trigger("beforeload.jqloader",o,i),e.get(a,i,(function(t){void 0!==o.opts.select&&(t=e(t).find(o.opts.select)),o.elem.empty(),o.setContent(t),o.elem.trigger("onload.jqloader",o);var n=o.opts.effect||o.opts.showEffect;n&&"show"!==n&&"hide"!==n?o.container.animateCSS({effect:n}).on("stop.animate",(function(){o.elem.trigger("finished.jqloader",o)})):o.elem.trigger("finished.jqloader",o)}),"html")},e.fn.jqLoader=function(o){return this.each((function(){e.data(this,"jqLoader")||e.data(this,"jqLoader",new t(this,o))}))},e(".jqLoader").livequery((function(){var o=e(this),t=e.extend({},o.data(),o.metadata());o.jqLoader(t)})),e("head").append("<style>pre.jqLoader { display:none; }</style>")}(jQuery);
