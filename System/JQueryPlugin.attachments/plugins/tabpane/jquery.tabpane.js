"use strict";var bottomBarHeight=-1;!function(t){var e={select:1,animate:!1,autoMaxExpand:!1,remember:!1,minHeight:0};function a(a,i){this.elem=t(a),this.opts=t.extend({},e,this.elem.data(),i),this.init()}a.prototype.init=function(){var e,a,i=this;i.id=i.getId(),i.elem.prepend('<span class="foswikiClear"></span>'),e=t('<ul class="jqTabGroup clearfix"></ul>').prependTo(i.elem),a=1,i.elem.find("> .jqTab").each((function(){var i=t(this),n=i.find(".jqTabLabel:first").remove().html();e.append('<li><a href="#" data-index="'+a+'">'+n+"</a></li>"),i.data("index",a),a++})),void 0===i.currentIndex&&i.switchTab(1),i.opts.autoMaxExpand&&i.autoMaxExpand(),i.elem.find(".jqTabGroup > li > a").on("click",(function(){var e=t(this),a=e.data("index");return e.trigger("blur"),a!==i.currentIndex&&(i.switchTab(a),i.opts.remember&&i.setHash(a)),!1})),i.opts.remember?(t(window).on("hashchange",(function(){i.switchTab(i.getHash()||i.opts.select||1)})),i.switchTab(i.getHash()||i.opts.select||1)):i.switchTab(i.opts.select||1)},a.prototype.parseHash=function(){var t,e,a=window.location.hash.replace(/^.*#!/,"").split(";"),i={},n=a.length;for(e=0;e<n;e++)2==(t=a[e].split("=")).length&&(i[t[0]]=parseInt(t[1],10));return i},a.prototype.getId=function(){var e=this.elem.attr("id");return t("#"+e+".jqTabPane").length>1?(e=parseInt(e.replace(/^tabpane/,""),10),this.elem.prop("id","tabpane"+(e+1)),this.getId()):e},a.prototype.getHash=function(){return this.parseHash()[this.id]},a.prototype.setHash=function(e){var a=this.parseHash(),i=[];e!==a[this.id]&&(void 0!==e?a[this.id]=e:delete a[this.id],t.each(a,(function(t,e){Array.isArray(e)&&(e=join("|",e)),i.push(t+="="+e)})),i="!"+i.join(";"),window.location.hash=i)},a.prototype.getTab=function(t){var e;return void 0!==(e="object"==typeof(t=t||this.currentIndex||this.opts.select)?t:"number"==typeof t?this.elem.find("> .jqTab").eq(t-1):this.elem.find(t))&&0==e.length&&(e=void 0),e},a.prototype.getNextTab=function(t){var e=this.getTab(t);if(e)return this.getTab(e.data("index")+1)},a.prototype.hideTab=function(t){var e,a=this.getTab(t);a&&(e=a.data("index"),a.hide(),this.getNaviOfTab(e).hide(),this.switchTab(e+1))},a.prototype.showTab=function(t){var e,a=this.getTab(e);a&&(e=a.data("index"),this.getNaviOfTab(e).show(),a.show())},a.prototype.getNaviOfTab=function(e){var a,i=this.getTab(e);return i?(a=i.data("index"),this.elem.find("> .jqTabGroup li a").eq(a-1)):t()},a.prototype.switchTab=function(e){var a,i,n,o,r,s,h,d,p=this,c=p.currentIndex,u=p.getTab(e);function l(){var e,a="none";n>0&&(a="easeInOutQuad"),p.opts.autoMaxExpand?p.opts.animate&&"none"!==a&&h.css({opacity:0}).animate({opacity:1},300):p.opts.animate&&"none"!==a&&(r.height("auto"),e=r.height(),d?(r.height(n).animate({height:e},300,a,(function(){r.height("auto")})),h.css({opacity:0}).animate({opacity:1},300,a)):r.height(n).css({opacity:0}).animate({opacity:1,height:e},300,a,(function(){r.height("auto")}))),t(window).trigger("resize"),void 0!==s.afterHandler&&window[s.afterHandler].call(p,c,o),p.currentIndex=o}u&&(void 0!==c&&(i=(a=p.getTab(c)).find(".jqTabContents:first"),c=a.data("index"),n=i.height()),o=u.data("index"),c!==o&&(a&&(a.removeClass("current").hide(),p.getNaviOfTab(c).parent().removeClass("current")),u.addClass("current").show(),p.getNaviOfTab(o).parent().addClass("current"),void 0!==(s=u.data()).beforeHandler&&window[s.beforeHandler].call(p,c,o),r=u.find(".jqTabContents:first"),(p.opts.animate||p.opts.autoMaxExpand)&&n>0&&!r.is(".jqTabDisableMaxExpand")&&r.height(n),h=r,d=!1,void 0!==s.container&&((h=r.find(s.container)).length?d=!0:h=r),void 0!==s.url?(h.load(s.url,void 0,(function(){void 0!==s.afterLoadHandler&&window[s.afterLoadHandler].call(p,c,o),l()})),u.removeData("url")):l()))},a.prototype.autoMaxExpand=function(){var e=this;window.setTimeout((function(){e.fixHeight(),t(window).one("resize.tabpane",(function(){e.autoMaxExpand()}))}),100)},a.prototype.fixHeight=function(){var e,a=this.elem.find("> .jqTab.current .jqTabContents:first"),i=t(window).height()||window.innerHeight;a.length&&!a.is(".jqTabDisableMaxExpand")&&(bottomBarHeight<=0&&(bottomBarHeight=t(".natEditBottomBar").outerHeight(!0)+a.outerHeight(!0)-a.height()),e=i-a.offset().top-bottomBarHeight-2,this.opts&&this.opts.minHeight&&e<this.opts.minHeight&&(e=this.opts.minHeight),e<0||a.height(e))},t.fn.tabpane=function(e){return this.each((function(){t.data(this,"tabPane")||t.data(this,"tabPane",new a(this,e))}))},t((function(){t(".jqTabPane:not(.jqInitedTabpane)").livequery((function(){t(this).tabpane().addClass("jqInitedTabpane")}))}))}(jQuery);
