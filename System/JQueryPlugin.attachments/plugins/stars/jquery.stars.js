"use strict";!function(t){var e={split:1,numStars:5};function s(s,n){this.elem=t(s),this.opts=t.extend({},e,n),this.init()}s.prototype._toFixed=function(t){return t=Number(t),Number(t.toFixed(this.prec))},s.prototype.init=function(){var e,s,n=this;n.elem.removeClass("jqStars").addClass("jqStarsInput").wrap("<div class='jqStars jqStarsInited' />"),n.mapping={},n.opts.values&&(n.opts.values.constructor===String?n.opts.values=n.opts.values.split(/\s*,\s*/):n.opts.values.constructor===Array&&(s=[],t.each(n.opts.values,(function(t,i){if(i.constructor===Object)for(e in i)n.mapping[i[e]]=e,s.push(i[e]);else s.push(i)})),n.opts.values=s),n.opts.numStars=n.opts.values.length-1,n.opts.split=1),n.prec=0,n.opts.split>1&&n.prec++,n.opts.split>10&&n.prec++,n.opts.split>100&&n.prec++,n.blockMouseMove=!1,n.timeoutId=void 0,n.elem.hide(),n.container=t("<div />").addClass("jqStarsContainer").insertAfter(n.elem),n.labelElem=t("<span />").addClass("jqStarsLabel").insertAfter(n.container),n.onElem=t("<div />").addClass("jqStarsOn").appendTo(n.container),n.widthStar=parseInt(n.container.css("background-size"),10),n.width=n.opts.numStars*n.widthStar,n.container.width(n.width),n.elem.is(":disabled")?n.container.addClass("jqStarsReadOnly"):(n.deleteElem=t("<div />").addClass("jqStarsDelete").insertAfter(n.elem),n.container.on("mousemove",(function(t){n.blockMouseMove||n.displayAtIndex((t.pageX-n.container.offset().left)/n.widthStar)})),n.container.on("mouseleave",(function(){n.blockMouseMove&&(void 0!==n.timeoutId&&window.clearTimeout(n.timeoutId),n.timeoutId=window.setTimeout((function(){n.blockMouseMove=!1,n.timeoutId=void 0}),1e3)),n.display(n.elem.val()),n.container.removeClass("jqStarsSelected")})),n.container.on("mouseenter",(function(){n.elem.trigger("focus"),n.blockMouseMove=!1})),n.container.on("click",(function(t){return n.displayAtIndex((t.pageX-n.container.offset().left)/n.widthStar),n.container.addClass("jqStarsSelected"),n.blockMouseMove=!0,n.selectAtIndex(n._tmpIndex),!1})),n.deleteElem.hover((function(){n.display()}),(function(){n.display(n.elem.val())})),n.deleteElem.on("click",(function(){return n.select(),!1})),n.container.on("mousewheel",(function(t){var e=1/n.opts.split;return t.deltaY>0?(n._tmpIndex+=e,n._tmpIndex>n.opts.numStars&&(n._tmpIndex=n.opts.numStars)):(n._tmpIndex-=e,n._tmpIndex<0&&(n._tmpIndex=0)),n._tmpIndex=n._toFixed(n._tmpIndex),n.selectAtIndex(n._tmpIndex),n.container.addClass("jqStarsSelected"),n.blockMouseMove=!0,!1})),t(document).on("keydown",(function(t){if(n.container.is(":hover")){var e=1/n.opts.split,s=!1;switch(t.keyCode){case 38:case 33:n._tmpIndex=Math.floor(n._tmpIndex+1),s=!0;break;case 40:case 34:n._tmpIndex=Math.ceil(n._tmpIndex-1),s=!0;break;case 35:n._tmpIndex=n.opts.numStars,s=!0;break;case 36:n._tmpIndex=0,s=!0;break;case 37:n._tmpIndex-=e,s=!0;break;case 39:n._tmpIndex+=e,s=!0;break;default:s=!1}if(s)return n._tmpIndex>n.opts.numStars&&(n._tmpIndex=n.opts.numStars),n._tmpIndex<0&&(n._tmpIndex=0),n._tmpIndex=n._toFixed(n._tmpIndex),n.selectAtIndex(n._tmpIndex),!1}}))),n.select(n.elem.val())},s.prototype.getStoreValue=function(t){return t=t||0,void 0===this.mapping[t]?this.getDisplayVal(t):t},s.prototype.getDisplayVal=function(t){var e;return this.opts.values?(e=this.opts.values[t],void 0!==this.mapping[e]&&(e=this.mapping[e])):e=sprintf("%."+this.prec+"f",t),e},s.prototype.displayAtIndex=function(t){var e,s;void 0===t&&(t=0),t=Math.ceil(t*this.opts.split)/this.opts.split,t=this._toFixed(t),e=this.widthStar*t,s=this.getDisplayVal(t),t!==this._tmpIndex&&(this.onElem.width(e),this.labelElem.html(s),this._tmpIndex=t,this.elem.trigger("display.stars",t,s))},s.prototype.display=function(t){var e;e=void 0===t||""===t?0:void 0!==this.opts.values?this.opts.values.indexOf(t):t,this.displayAtIndex(e)},s.prototype.selectAtIndex=function(t){var e;this._tmpIndex=void 0,void 0===t&&(t=0),e=void 0!==this.opts.values?this.opts.values[t]:t,this.displayAtIndex(t),e=this.getStoreValue(t),this.elem.val(e)},s.prototype.select=function(t){this._tmpIndex=void 0,this.display(t),this.elem.val(this.getStoreValue(t))},t.fn.stars=function(e){return this.each((function(){t.data(this,"stars")||t.data(this,"stars",new s(this,e))}))},t((function(){t(".jqStars:not(.jqStarsInited)").livequery((function(){var e=t(this),s=t.extend({},e.data());e.stars(s)}))}))}(jQuery);
