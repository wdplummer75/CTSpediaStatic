!function(t){jQuery.fn.farbtastic=function(e){return t.farbtastic(this,e),this},jQuery.farbtastic=function(e,o){return(e=t(e).get(0)).farbtastic||(e.farbtastic=new jQuery._farbtastic(e,o))},jQuery._farbtastic=function(e,o){var a=this;t(e).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var r=t(".farbtastic",e);a.wheel=t(".wheel",e).get(0),a.radius=84,a.square=100,a.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&t("*",r).each((function(){if("none"!=this.currentStyle.backgroundImage){var e=this.currentStyle.backgroundImage;e=this.currentStyle.backgroundImage.substring(5,e.length-2),t(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+e+"')"})}})),a.linkTo=function(e){return"object"==typeof a.callback&&t(a.callback).off("keyup",a.updateValue),a.color=null,"function"==typeof e?a.callback=e:"object"!=typeof e&&"string"!=typeof e||(a.callback=t(e),a.callback.on("keyup",a.updateValue),a.callback.get(0).value&&a.setColor(a.callback.get(0).value)),this},a.updateValue=function(t){this.value&&this.value!=a.color&&a.setColor(this.value)},a.setColor=function(t){var e=a.unpack(t);return a.color!=t&&e&&(a.color=t,a.rgb=e,a.hsl=a.RGBToHSL(a.rgb),a.updateDisplay()),this},a.setHSL=function(t){return a.hsl=t,a.rgb=a.HSLToRGB(t),a.color=a.pack(a.rgb),a.updateDisplay(),this},a.widgetCoords=function(e){var o,r,s=e.target||e.srcElement,n=a.wheel;if(void 0!==e.offsetX){for(var u={x:e.offsetX,y:e.offsetY},i=s;i;)i.mouseX=u.x,i.mouseY=u.y,u.x+=i.offsetLeft,u.y+=i.offsetTop,i=i.offsetParent;i=n;for(var c={x:0,y:0};i;){if(void 0!==i.mouseX){o=i.mouseX-c.x,r=i.mouseY-c.y;break}c.x+=i.offsetLeft,c.y+=i.offsetTop,i=i.offsetParent}for(i=s;i;)i.mouseX=void 0,i.mouseY=void 0,i=i.offsetParent}else{u=a.absolutePosition(n);o=(e.pageX||0*(e.clientX+t("html").get(0).scrollLeft))-u.x,r=(e.pageY||0*(e.clientY+t("html").get(0).scrollTop))-u.y}return{x:o-a.width/2,y:r-a.width/2}},a.mousedown=function(e){document.dragging||(t(document).on("mousemove",a.mousemove).on("mouseup",a.mouseup),document.dragging=!0);var o=a.widgetCoords(e);return a.circleDrag=2*Math.max(Math.abs(o.x),Math.abs(o.y))>a.square,a.mousemove(e),!1},a.mousemove=function(t){var e=a.widgetCoords(t);if(a.circleDrag){var o=Math.atan2(e.x,-e.y)/6.28;o<0&&(o+=1),a.setHSL([o,a.hsl[1],a.hsl[2]])}else{var r=Math.max(0,Math.min(1,-e.x/a.square+.5)),s=Math.max(0,Math.min(1,-e.y/a.square+.5));a.setHSL([a.hsl[0],r,s])}return!1},a.mouseup=function(){t(document).off("mousemove",a.mousemove),t(document).off("mouseup",a.mouseup),document.dragging=!1},a.updateDisplay=function(){var e=6.28*a.hsl[0];t(".h-marker",r).css({left:Math.round(Math.sin(e)*a.radius+a.width/2)+"px",top:Math.round(-Math.cos(e)*a.radius+a.width/2)+"px"}),t(".sl-marker",r).css({left:Math.round(a.square*(.5-a.hsl[1])+a.width/2)+"px",top:Math.round(a.square*(.5-a.hsl[2])+a.width/2)+"px"}),t(".color",r).css("backgroundColor",a.pack(a.HSLToRGB([a.hsl[0],1,.5]))),"object"==typeof a.callback?(t(a.callback).css({backgroundColor:a.color,color:a.hsl[2]>.5?"#000":"#fff"}),t(a.callback).each((function(){this.value&&this.value!=a.color&&(this.value=a.color)}))):"function"==typeof a.callback&&a.callback.call(a,a.color)},a.absolutePosition=function(t){var e={x:t.offsetLeft,y:t.offsetTop};if(t.offsetParent){var o=a.absolutePosition(t.offsetParent);e.x+=o.x,e.y+=o.y}return e},a.pack=function(t){var e=Math.round(255*t[0]),o=Math.round(255*t[1]),a=Math.round(255*t[2]);return"#"+(e<16?"0":"")+e.toString(16)+(o<16?"0":"")+o.toString(16)+(a<16?"0":"")+a.toString(16)},a.unpack=function(t){return 7==t.length?[parseInt("0x"+t.substring(1,3))/255,parseInt("0x"+t.substring(3,5))/255,parseInt("0x"+t.substring(5,7))/255]:4==t.length?[parseInt("0x"+t.substring(1,2))/15,parseInt("0x"+t.substring(2,3))/15,parseInt("0x"+t.substring(3,4))/15]:void 0},a.HSLToRGB=function(t){var e,o,a=t[0],r=t[1],s=t[2];return e=2*s-(o=s<=.5?s*(r+1):s+r-s*r),[this.hueToRGB(e,o,a+.33333),this.hueToRGB(e,o,a),this.hueToRGB(e,o,a-.33333)]},a.hueToRGB=function(t,e,o){return 6*(o=o<0?o+1:o>1?o-1:o)<1?t+(e-t)*o*6:2*o<1?e:3*o<2?t+(e-t)*(.66666-o)*6:t},a.RGBToHSL=function(t){var e,o,a,r,s,n,u=t[0],i=t[1],c=t[2];return e=Math.min(u,Math.min(i,c)),a=(o=Math.max(u,Math.max(i,c)))-e,s=0,(n=(e+o)/2)>0&&n<1&&(s=a/(n<.5?2*n:2-2*n)),r=0,a>0&&(o==u&&o!=i&&(r+=(i-c)/a),o==i&&o!=c&&(r+=2+(c-u)/a),o==c&&o!=u&&(r+=4+(u-i)/a),r/=6),[r,s,n]},t("*",r).on("mousedown",a.mousedown),a.setColor("#000000"),o&&a.linkTo(o)}}(jQuery);
