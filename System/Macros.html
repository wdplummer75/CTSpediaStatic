<!DOCTYPE html><html lang="en">
<head>
<title>Macros &lt; System &lt; Foswiki</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.5, user-scalable=yes" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<link rel="icon" href="../MISSING RESOURCE System/Macros/favicon.ico" type="image/x-icon"> <link type="image/x-icon" rel="shortcut icon" href="../MISSING RESOURCE System/Macros/favicon.ico">
<link href="Macros.html" rel="alternate" title="edit Macros" type="application/x-wiki">
<meta name="description" content="Macros" />
<link type="text/css" media="all" rel="stylesheet" class="head JQUERYPLUGIN::TABPANE" href="JQueryPlugin.attachments/plugins/tabpane/jquery.tabpane.css?version=2.10"><!--JQUERYPLUGIN::TABPANE-->
<link media="all" class="head SMILIESPLUGIN" rel="stylesheet" href="SmiliesPlugin.attachments/smilies.css" type="text/css"><!--SMILIESPLUGIN-->
<style class='head TABLEPLUGIN_default' type="text/css" media="all">
body .foswikiTable {border-width:1px}
body .foswikiTable .tableSortIcon img {padding-left:.3em; vertical-align:text-bottom}
body .foswikiTable td {border-style:solid none; vertical-align:top}
body .foswikiTable th {border-style:none solid; vertical-align:top; background-color:#d6d3cf; color:#000000}
body .foswikiTable th a:link {color:#000000}
body .foswikiTable th a:visited {color:#000000}
body .foswikiTable th a:hover {color:#000000; background-color:#d6d3cf}
body .foswikiTable th.foswikiSortedCol {background-color:#c4c1ba}
body .foswikiTable tr.foswikiTableRowdataBg0 td {background-color:#ffffff}
body .foswikiTable tr.foswikiTableRowdataBg0 td.foswikiSortedCol {background-color:#f7f7f6}
body .foswikiTable tr.foswikiTableRowdataBg1 td {background-color:#f7f7f6}
body .foswikiTable tr.foswikiTableRowdataBg1 td.foswikiSortedCol {background-color:#f0f0ee}
</style><!--TABLEPLUGIN_default-->
<script class="script JQUERYPLUGIN" src="JQueryPlugin.attachments/jquery-2.2.4.js"></script><!--JQUERYPLUGIN-->
<script src="JQueryPlugin.attachments/plugins/observer/observer.js?version=0.1" class="script JQUERYPLUGIN::OBSERVER"></script><!--JQUERYPLUGIN::OBSERVER-->
<script src="JQueryPlugin.attachments/plugins/migrate/jquery.migrate.js?version=3.3.1" class="script JQUERYPLUGIN::MIGRATE"></script><!--JQUERYPLUGIN::MIGRATE-->
<script src="JQueryPlugin.attachments/plugins/foswiki/jquery.foswiki.js?version=3.01" class="script JQUERYPLUGIN::FOSWIKI"></script><!--JQUERYPLUGIN::FOSWIKI-->
<script class="script JQUERYPLUGIN::BROWSER" src="JQueryPlugin.attachments/plugins/browser/jquery.browser.js?version=0.1.0"></script><!--JQUERYPLUGIN::BROWSER-->
<script class="script JQUERYPLUGIN::METADATA" src="JQueryPlugin.attachments/plugins/metadata/jquery.metadata.js?version=2.1ef2bb44c86f5d0e98d55"></script><!--JQUERYPLUGIN::METADATA-->
<script class="script JQUERYPLUGIN::CHILI" src="JQueryPlugin.attachments/plugins/chili/jquery.chili.js?version=2.2_1"></script>
<script src="JQueryPlugin.attachments/plugins/chili/jquery.chili.init.js?version=2.2_1" class="script JQUERYPLUGIN::CHILI"></script><!--JQUERYPLUGIN::CHILI-->
<script class="script JQUERYPLUGIN::EASING" src="JQueryPlugin.attachments/plugins/easing/jquery.easing.js?version=1.3"></script><!--JQUERYPLUGIN::EASING-->
<script class='script JQUERYPLUGIN::FOSWIKI::PREFERENCES foswikiPreferences' type='text/json'>{
   "SERVERTIME" : "08 Feb 2023 - 15:51",
   "TOPIC" : "Macros",
   "WIKIUSERNAME" : "Main.WikiAdmin",
   "USERSWEB" : "Main",
   "PUBURLPATH" : "/foswiki/pub",
   "USERNAME" : "WikiAdmin",
   "NAMEFILTER" : "[\\\\\\s*?~^$@%`\"'&|<:;>\\[\\]#\\x00-\\x1f]",
   "SCRIPTURLPATHS" : {},
   "WEB" : "System",
   "COOKIEREALM" : "",
   "PUBURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/pub",
   "URLHOST" : "http://biostat1478.dhcp.mc.vanderbilt.edu",
   "SCRIPTURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/bin",
   "SYSTEMWEB" : "System",
   "SKIN" : "natedit,pattern",
   "SCRIPTSUFFIX" : "",
   "SCRIPTURLPATH" : "/foswiki/bin",
   "WIKINAME" : "WikiAdmin"
}
</script><!--JQUERYPLUGIN::FOSWIKI::PREFERENCES-->
<script src="JQueryPlugin.attachments/plugins/tabpane/jquery.tabpane.js?version=2.10" class="script JQUERYPLUGIN::TABPANE"></script><!--JQUERYPLUGIN::TABPANE-->
</head>
<body>
<p></p>
<h1 id="Macros">  Macros </h1>
<p></p>
Special text strings expand on the fly to display information, or trigger a function.
<p></p>
Macros are text strings in one of three basic forms:
<p></p>
<pre class="tml">
&#37;MACRONAME&#37;
&#37;MACRONAME{ parameter&#61;&#34;value&#34; }&#37;
&#37;MACRONAME{
  param1&#61;&#34;value &#34;
        +&#34;&#38; more &#34;
  param2&#61;&#34;whatever&#34;
  param1+&#61;&#34;and even more&#34;
}&#37;
</pre>
<p></p>
The third form is a new feature in Foswiki 2.1 to significantly improve readability with complex macros, see <a href="#Readable_Macros" class="foswikiCurrentTopicLink">Readable Macros</a> for details.
<p></p>
These usually expand into content when a topic is rendered for viewing. There are two types of macros: <ol>
<li> <a href="PreferenceSettings.html">Preference settings</a>: May be defined and modified by the user
</li> <li> Registered macros: Defined by the system or by Plugins (for example, the <a href="SpreadSheetPlugin.html">SpreadSheetPlugin</a> introduces a <code>%CALC{}%</code> macro)
</li></ol> 
<p></p>
<div class="foswikiToc" id="foswikiTOC"><span class="foswikiTocTitle">On this page:</span> <ul>
<li> <a href="#Using_Macros"> Using Macros </a> <ul>
<li> <a href="#Order_of_expansion"> Order of expansion </a> <ul>
<li> <a href="#Standard_form"> Standard form </a> <ul>
<li> <a href="#Step_45by_45Step_Example"> Step-by-Step Example </a>
</li></ul> 
</li> <li> <a href="#Delayed_form"> Delayed form </a> <ul>
<li> <a href="#Step_45by_45Step_Example_AN1"> Step-by-Step Example </a>
</li></ul> 
</li></ul> 
</li></ul> 
</li> <li> <a href="#Macro_Names"> Macro Names </a>
</li> <li> <a href="#Writing_preference_settings"> Writing preference settings </a> <ul>
<li> <a href="#Hiding_preference_settings"> Hiding preference settings </a>
</li> <li> <a href="#Order_of_preference_settings"> Order of preference settings </a>
</li> <li> <a href="#Preference_settings_and_topic_revision_history"> Preference settings and topic revision history </a>
</li> <li> <a href="#Parameters"> Parameters </a> <ul>
<li> <a href="#Parameter_defaults"> Parameter defaults </a>
</li></ul> 
</li> <li> <a href="#Access_Control_Settings"> Access Control Settings </a>
</li> <li> <a href="#Local_values_for_preferences"> Local values for preferences </a>
</li></ul> 
</li> <li> <a href="#Predefined_Macros"> Predefined Macros </a>
</li> <li> <a href="#Readable_Macros"> Readable Macros </a>
</li></ul> 
</div>
<p></p>
<h2 id="Using_Macros">  Using Macros </h2>
<p></p>
To use a macro type its name. For example, <ul>
<li> type <code>%T%</code> to get <img title="TIP" width="16" src="DocumentGraphics.attachments/tip.png" height="16" alt="TIP"> (a <a href="PreferenceSettings.html">predefined preference setting</a>)
</li> <li> type <code>%TOPIC%</code> to get <code>Macros</code> (a predefined <a href="VarTOPIC.html">macro</a>)
</li> <li> type <code>%CALC{ "$UPPER(Text)" }%</code> to get <code>TEXT</code> (<a href="VarCALC.html">CALC</a> is a macro defined by <a href="SpreadSheetPlugin.html">SpreadSheetPlugin</a>)
</li></ul> 
<p></p>
<strong>Note:</strong> <ul>
<li> To leave a macro unexpanded, precede it with an exclamation mark, e.g. type <code>!%TOPIC%</code> to get <code>%TOPIC%</code> <ul>
<li> Alternatively, insert a <code>&lt;nop&gt;</code> anywhere in the macro, Eg. <code>%&lt;nop&gt;TOPIC%</code>
</li></ul> 
</li> <li> Macros are expanded relative to the topic they are <em>used</em> in, not the topic they are <em>defined</em> in
</li> <li> Type <code>%SHOWPREFERENCE%</code> to get a full listing of all macros defined for a particular topic, or <code>%SHOWPREFERENCE{"foo"}%</code> to see an individual setting.
</li> <li> If a macro is not defined, then it will be left in the text <em>unless</em> it is called with a <code>default</code> parameter, in which case the value of the <code>default</code> parameter will replace the macro call in the output. For example, <code>%UNDEFINED{default="blank"}%</code> will expand to <code>blank</code>.
</li></ul> 
<p></p>
<h3 id="Order_of_expansion">  Order of expansion </h3>
The following describes only these types of macros: <ul>
<li> <a href="PreferenceSettings.html">Preference settings</a>
</li> <li> Most macros provided by plugins (notable exceptions include <a href="VarCALC.html">CALC</a>, <a href="VarTABLE.html">TABLE</a> and any other macros that are expanded in <code>commonTagsHandler()</code>)
</li> <li> Most built-in Foswiki macros (exceptions include <a href="VarTOC.html">TOC</a> and macros that have start/stop parts e.g: <a href="VarSTARTSECTION.html">STARTSECTION</a>/ENDSECTION, <a href="VarSTARTINCLUDE.html">STARTINCLUDE</a>/STOPINCLUDE)
</li></ul> 
<p></p>
<p></p>
<span id="StandardForm"></span>
<h4 id="Standard_form">  Standard form </h4>
<span id="InsideOutLeftToRight"></span>
The key to understanding nested expressions in Foswiki is to understand that macros are expanded "inside-out, left-to-right". <strong>Example:</strong>
<p></p>
<pre class="tml">
&#37;MACRO1{
   something&#61;&#34;&#37;MACRO2{
      somethingelse&#61;&#34;&#37;MACRO3&#37;, &#37;MACRO4&#37;&#34;
   }&#37;&#34;
}&#37;
</pre>
The macros are expanded in this order: MACRO3, MACRO4, MACRO2, MACRO1.
<p></p>
<h5 id="Step_45by_45Step_Example">  Step-by-Step Example </h5>
<p></p>
<div class='jqTabPane jqTabPanePlain'  data-select='1' data-auto-max-expand='false' data-animate='true' data-remember='false' data-min-height='0'>
<div id='tab3686' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 1</h2>
<div class='jqTabContents' >
<pre class="tml">
%INCLUDE{
    "%QUERY{
        "'%THETOPIC%'/%THEFIELD%"
    }%"
    section="Summary"
}%
   * Set THETOPIC = %SYSTEMWEB%.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
<div id='tab4143' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 2</h2>
<div class='jqTabContents' >
<pre class="tml">
%INCLUDE{
    "%QUERY{
        "'%SYSTEMWEB%.FAQWhatIsWikiWiki'/%THEFIELD%"
    }%"
    section="Summary"
}%
   * Set THETOPIC = %SYSTEMWEB%.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
<div id='tab6955' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 3</h2>
<div class='jqTabContents' >
<pre class="tml">
%INCLUDE{
    "%QUERY{
        "'%SYSTEMWEB%.FAQWhatIsWikiWiki'/TopicClassification"
    }%"
    section="Summary"
}%
   * Set THETOPIC = %SYSTEMWEB%.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
<div id='tab4967' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 4</h2>
<div class='jqTabContents' >
<pre class="tml">
%INCLUDE{
    "%QUERY{
        "'System.FAQWhatIsWikiWiki'/TopicClassification"
    }%"
    section="Summary"
}%
   * Set THETOPIC = %SYSTEMWEB%.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
<div id='tab2990' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 5</h2>
<div class='jqTabContents' >
<pre class="tml">
%INCLUDE{
    "FrequentlyAskedQuestion"
    section="Summary"
}%
   * Set THETOPIC = %SYSTEMWEB%.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
<div id='tab9683' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 6</h2>
<div class='jqTabContents' >
<pre class="tml">

These topics are for frequently
asked questions including answers.

   * Set THETOPIC = %SYSTEMWEB%.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
<div id='tab3981' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 7</h2>
<div class='jqTabContents' >
<pre class="tml">

These topics are for frequently
asked questions including answers.

   * Set THETOPIC = System.FAQWhatIsWikiWiki
   * Set THEFIELD = TopicClassification
</pre>
</div></div>
</div>
<p></p>
<span id="DelayedForm"></span>
<h4 id="Delayed_form">  Delayed form </h4>
<a href="#StandardForm" class="foswikiCurrentTopicLink">Standard form</a> macros can nearly always be used to build the parameter string of another macro; however, sometimes it is desirable to bypass the <a href="#InsideOutLeftToRight" class="foswikiCurrentTopicLink">inside-out</a> expansion order and delay the inner macro until after the outer macro has finished expansion. This is accomplished by using the <a href="FormatTokens.html">$percent</a> format token instead of <code>%</code>, and escaping any <code>"</code> character it uses (becomes <code>\"</code>)
<p></p>
<div class="foswikiHelp">
  <img src="DocumentGraphics.attachments/tip.png" height="16" alt="TIP" title="TIP" width="16"> When working with a given <a class="foswikiCurrentTopicLink" href="Macros.html">macro</a>, consult its documentation to determine which parameters support the <code>$percent/$percnt</code> <a href="FormatTokens.html">format tokens</a>. Generally only <em>output parameters</em> like <code>header</code>, <code>format</code> and <code>footer</code> support <a href="FormatTokens.html">format tokens</a>.
  </div>
<strong>Example:</strong>
<pre class="tml">
&#37;MACRO1{
   format&#61;&#34;&#36;percentMACRO2{
      format&#61;\&#34;&#37;MACRO3&#37;, &#37;MACRO4&#37;\&#34;
   }&#36;percent&#34;
}&#37;
</pre>
The macros are expanded in this order: MACRO3, MACRO4, MACRO1, <strong>MACRO2</strong>.
<p></p>
<h5 id="Step_45by_45Step_Example_AN1">  Step-by-Step Example </h5>
<p></p>
From the <a href="FormattedSearch.html">conditional output example</a>:
<p></p>
<div class='jqTabPane jqTabPanePlain'  data-select='1' data-auto-max-expand='false' data-animate='true' data-remember='false' data-min-height='0'>
<div id='tab4581' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 1</h2>
<div class='jqTabContents' >
<pre class="tml">
&#37;SEARCH{
  &#34;info.date &#62;&#61; d2n(&#39;2009-01-01&#39;) AND info.date &#60;&#61; d2n(&#39;2009-12-31&#39;)&#34;
  type&#61;&#34;query&#34;
  limit&#61;&#34;2&#34;
  nonoise&#61;&#34;on&#34;
  format&#61;&#34;   &#42; &#36;percentICON{
    \&#34;&#36;percentIF{
      \&#34;&#39;&#36;topic&#39;/parent.name&#61;&#39;&#37;PARENT&#37;&#39;\&#34;
      then&#61;\&#34;info\&#34; else&#61;\&#34;gear\&#34;
    }&#36;percent\&#34;
  }&#36;percent &#91;&#91;&#36;topic&#93;&#93;&#34;
}&#37;
----
   &#42; Set PARENT &#61; UserDocumentationCategory
</pre>
</div></div>
<div id='tab5397' class='jqTab ' style='display:none'>
<h2 class='jqTabLabel'>Step 2</h2>
<div class='jqTabContents' >
<pre class="tml">
%SEARCH{
  "info.date >= d2n('2009-01-01') AND info.date <= d2n('2009-12-31')"
  type="query"
  limit="2"
  nonoise="on"
  format="   * $percentICON{
    \"$percentIF{
      \"'$topic'/parent.name='UserDocumentationCategory'\"
      then=\"info\" else=\"gear\"
    }$percent\"
  }$percent [[$topic]]"
}%
----
   * Set PARENT = UserDocumentationCategory
</pre>
</div></div>
<div id='tab8444' class='jqTab  jqAjaxTab' data-url="/foswiki/bin/view/System/Macros?skin=text&amp;section=step3" style='display:none'>
<h2 class='jqTabLabel'>Step 3</h2>
<div class='jqTabContents' >
<span class='foswikiIcon'><img alt="processing" height="16" src="DocumentGraphics.attachments/processing.gif" width="16"></span>
<pre class="foswikiHidden">
&#37;STARTSECTION{&#34;step3&#34;}&#37;
&#60;pre class&#61;&#34;tml&#34;&#62;
&#37;SEARCH{
  &#34;info.date &#62;&#61; d2n(&#39;2009-01-01&#39;) AND info.date &#60;&#61; d2n(&#39;2009-12-31&#39;)&#34;
  type&#61;&#34;query&#34;
  limit&#61;&#34;2&#34;
  nonoise&#61;&#34;on&#34;
  format&#61;&#34;   &#42; &#36;percent&#60;nop&#62;ICON{
    \&#34;&#36;percent&#60;nop&#62;IF{
      \&#34;&#39;&#36;topic&#39;/parent.name&#61;&#39;UserDocumentationCategory&#39;\&#34;
      then&#61;\&#34;info\&#34; else&#61;\&#34;gear\&#34;
    }&#36;percent\&#34;
  }&#36;percent &#91;&#91;&#36;topic&#93;&#93;&#34;
}&#37;
----
   &#42; Set PARENT &#61; UserDocumentationCategory
&#60;/pre&#62;
&#37;ENDSECTION{&#34;step3&#34;}&#37;
</pre>
</div></div>
<div id='tab8136' class='jqTab  jqAjaxTab' data-url="/foswiki/bin/view/System/Macros?skin=text&amp;section=step4" style='display:none'>
<h2 class='jqTabLabel'>Step 4</h2>
<div class='jqTabContents' >
<span class='foswikiIcon'><img width="16" height="16" alt="processing" src="DocumentGraphics.attachments/processing.gif"></span>
<pre class="foswikiHidden">
&#37;STARTSECTION{&#34;step4&#34;}&#37;
&#60;pre class&#61;&#34;tml&#34;&#62;
&#37;SEARCH{
  &#34;info.date &#62;&#61; d2n(&#39;2009-01-01&#39;) AND info.date &#60;&#61; d2n(&#39;2009-12-31&#39;)&#34;
  type&#61;&#34;query&#34;
  limit&#61;&#34;2&#34;
  nonoise&#61;&#34;on&#34;
  format&#61;&#34;   &#42; &#36;percent&#60;nop&#62;ICON{
    \&#34;&#36;percentIF{
      \&#34;&#39;&#36;topic&#39;/parent.name&#61;&#39;UserDocumentationCategory&#39;\&#34;
      then&#61;\&#34;info\&#34; else&#61;\&#34;gear\&#34;
    }&#36;percent\&#34;
  }&#36;percent &#91;&#91;&#36;topic&#93;&#93;&#34;
}&#37;
----
   &#42; Set PARENT &#61; UserDocumentationCategory
&#60;/pre&#62;
&#37;ENDSECTION{&#34;step4&#34;}&#37;
</pre>
</div></div>
<div id='tab1655' class='jqTab  jqAjaxTab' data-url="/foswiki/bin/view/System/Macros?skin=text&amp;section=step5" style='display:none'>
<h2 class='jqTabLabel'>Step 5</h2>
<div class='jqTabContents' >
<span class='foswikiIcon'><img width="16" height="16" alt="processing" src="DocumentGraphics.attachments/processing.gif"></span>
<pre class="foswikiHidden">
&#37;STARTSECTION{&#34;step5&#34;}&#37;
&#60;pre class&#61;&#34;tml&#34;&#62;
&#37;SEARCH{
  &#34;info.date &#62;&#61; d2n(&#39;2009-01-01&#39;) AND info.date &#60;&#61; d2n(&#39;2009-12-31&#39;)&#34;
  type&#61;&#34;query&#34;
  limit&#61;&#34;2&#34;
  nonoise&#61;&#34;on&#34;
  format&#61;&#34;   &#42; &#38;lt;img src&#61;\&#34;&#36;percentICONURL{
    \&#34;&#36;percentIF{
      \&#34;&#39;&#36;topic&#39;/parent.name&#61;&#39;UserDocumentationCategory&#39;\&#34;
      then&#61;\&#34;info\&#34; else&#61;\&#34;gear\&#34;
    }&#36;percent\&#34;
  }&#36;percent\&#34;/&#38;gt; &#91;&#91;&#36;topic&#93;&#93;&#34;
}&#37;
----
   &#42; Set PARENT &#61; UserDocumentationCategory
&#60;/pre&#62;
&#37;ENDSECTION{&#34;step5&#34;}&#37;
</pre>
</div></div>
</div>
<p></p>
<p></p>
See also: <a href="FormattedSearch.html">FormattedSearch</a>
<p></p>
<h2 id="Macro_Names">  Macro Names </h2>
Macro names must start with an ASCII letter. The following characters can be ASCII letters, numbers and the underscore '_'. Letters may be upper or lower-case, E.g. <code>%MYVAR%</code>, <code>%MyVar%</code>, <code>%My2ndVar%</code>, and <code>%My_Var%</code> are all separate, valid macro names (macros are case sensitive  - <code>%MyVAR%</code> and <code>%MYVAR%</code> are not the same).
<p></p>
By convention all settings, predefined macros and macros registered by plugins are always UPPER-CASE.
<!-- <ul>
<li> Set CONDITIONS = According to <a href="Macros.html" class="foswikiCurrentTopicLink">Macros</a>, The %WHAT% is %STATE% today. (Set in <a class="foswikiCurrentTopicLink" href="Macros.html">Macros</a>).
</li> <li> Set WEATHER = It's raining.
</li></ul> 
-->
<span id="SettingPrefs"></span>
<span id="PreferencesMacros"></span>
<h2 id="Preference_Settings">  Preference Settings </h2>
<p></p>
A <em>preference setting</em> lets you define a simple <a href="Macros.html" class="foswikiCurrentTopicLink">macro</a> that will be expanded in your output. In addition:  <ul>
<li> preference settings are used by Plugins to control their features,
</li> <li> preference settings are used for <a href="AccessControl.html">Access Control</a>.
</li></ul> 
<p></p>
A preference setting looks like this:
<p></p>
<code>[multiple of 3 spaces] * [space] Set [space] MACRONAME [space] = [space] value</code>
<p></p>
Example:
<p></p>
<pre class='tml'>   &#42; Set WEBBGCOLOR &#61; #FFFFC0</pre>
<p></p>
Macros defined using preference settings are expanded by enclosing their name in percent signs. So when you write <code>%WEBBGCOLOR%</code>, it gets expanded to <code>#B9DAFF</code>
<p></p>
Preferences can also be set dynamically by using the <code>%SET{"setting" value="value"}%</code> Macro. With the exception of these dynamic preference settings, preferences are always taken from the most current topic revision, <strong><em>even when accessing previous revisions of a topic.</em></strong>
<p></p>
Preferences can be defined in a number of places: <ol>
<li> <a href="DefaultPreferences.html">DefaultPreferences</a> (Foswiki upgrades overwrite this topic)
</li> <li> In (some) plugin documentation topics. (Deprecated)
</li> <li> <a href="../Main/SitePreferences.html">SitePreferences</a>
</li> <li> In user topics, if the user has one (yours is <a href="../Main/WikiAdmin.html">Main.WikiAdmin</a>)
</li> <li> WebPreferences in each web.
</li> <li> Sub-webs inherit the WebPreferences of their parent
</li> <li> In the topic when it is loaded from the Store
</li> <li> In <a href="VarSET.html">SET</a> macros for run-time preferences
</li></ol> 
<p></p>
<code>Set</code> statements which occur at numerically higher locations override macros of the same name defined at lower numbered levels, <em>unless the macro was listed in a finalpreferences setting (finalised) at a lower-numbered level.</em> When a preference is <em>finalized</em>, the macro is locked to the value at that level; <code>SET</code> statements at higher-numbered levels are ignored.  Looking at it graphically:
<p></p>
     <img height="432" alt="prefs-stack.jpg" src="PreferenceSettings.attachments/prefs-stack.jpg" width="560">
<p></p>
Access Control rules (ACLs) are also written as preference settings. <strong>ACLs cannot be dynamically modified by the <code>%SET{}%</code> macro.</strong>
<p></p>
<p></p>
<h2 id="Writing_preference_settings">  Writing preference settings </h2>
<p></p>
Preference settings are written as a simple bullet. In <a href="TopicMarkupLanguage.html">TopicMarkupLanguage</a> (TML)
they are written as <code>3-spaces,asterisk,equals,value</code>
<p></p>
<pre class='tml'>   &#42; Set MYSETTING &#61; My setting value</pre>
<p></p>
When using the Wysiwyg editor, click the "Bullet" button and write the setting
as a simple bullet.  Don't include the asterisk or the leading spaces.
<p></p>
Spaces between the = sign and the value will be ignored. You can split a value over several lines by indenting following lines with spaces - as long as you don't try to use * as the first character on the following line. (Not when using the Wysiwyg editor.)
<p></p>
<strong>Example:</strong>
<p></p>
<pre class='tml'>   &#42; Set MACRONAME &#61; value starts here
     and continues here</pre>
<p></p>
<img width="16" title="IDEA!" alt="IDEA!" height="16" src="DocumentGraphics.attachments/tip.png"> preference settings can easily be disabled with a # sign. Example:<br />
<p></p>
<pre class='tml'>   &#42; #Set DENYWEBCHANGE &#61; &#37;USERSWEB&#37;.UnknownUser</pre>
<p></p>
<p></p>
<p></p>
Whatever you include in your bullet style setting will be expanded on display, exactly as if it had been entered directly (though see Parameters, below). (%SET{}% settings are expanded during the set process. See <a href="VarSET.html">VarSET</a> for further information.
<p></p>
<strong>Example: Create a custom logo macro</strong> <ul>
<li> To place a logo anywhere in a web by typing <code><b>%MYLOGO%</b></code>, define the preference settings in the web's WebPreferences topic, and upload a logo file, ex: <code>mylogo.gif</code>. You can upload by <a href="FileAttachment.html">attaching the file</a> to <a href="WebPreferences.html">WebPreferences</a>, or, to avoid clutter, to any other topic in the same web, e.g. <code>LogoTopic</code>. Sample preference setting in <a href="WebPreferences.html">WebPreferences</a>:
</li></ul> 
<pre class='tml'>   &#42; Set MYLOGO &#61; &#37;PUBURL&#37;/&#37;WEB&#37;/LogoTopic/mylogo.gif</pre>
<p></p>
Preference settings are <strong>case sensitive</strong>.   (Foswiki by convention always writes settings in upper case.)
<pre class='tml'>
   &#42; Set lower &#61; This is LOWER
   &#42; Set LOWER &#61; This is UPPER
   &#42; Set LoWeR &#61; This is MIXED
Expand &#37;lower&#37;, &#37;LOWER&#37; and &#37;LoWeR&#37;</pre>
<p></p>
Expand %lower%, %LOWER% and %LoWeR%.
<p></p>
<h3 id="Hiding_preference_settings">  Hiding preference settings </h3>
<p></p>
You can hide preference settings in the output by enclosing them in HTML comments; for example,
<pre>
&#60;!--
   &#42; Set HIDDEN &#61; This will be invisible in the output
--&#62;</pre>
<p></p>
You can also set preference settings in a topic by clicking the link <code>Edit topic preference settings</code> under <code>More topic actions</code>. Preferences set in this manner are known as 'meta' preferences and are not visible in the topic text, but take effect nevertheless.
<strong>If the same setting appears as both an inline setting, and in topic meta settings,  the meta setting will override the inline setting!</strong>  There is no warning when the setting is duplicate. This should be avoided to prevent confusion.
<p></p>
<div class='foswikiHelp'><img src="DocumentGraphics.attachments/warning.png" alt="ALERT!" height="16" title="ALERT!" width="16"> <strong>Caution</strong> If your topic will be used in an INCLUDE, it is recommended to not use HTML comments. instead, set preferences
into the topic metadata  by using the "Edit Settings for this topic" button on the "More topic actions" page.  Settings in an included topic are always ignored, but nested comments will break the HTML.</div>
<p></p>
<h3 id="Order_of_preference_settings">  Order of preference settings </h3>
<p></p>
If you are setting a preference and using it in the same topic, note that Foswiki reads all the bullet style preference settings from the saved version of the topic before it displays anything.  This means you can use a setting anywhere in the topic, even if you set it at the very end. <strong>But beware:</strong>  it also means that if you change the setting of a macro you are using in the same topic, <code><b>Preview</b></code> will show the wrong thing, and you must <code><b>Save</b></code> the topic to see it correctly.  (<code>%SET{}%</code> style settings <em>are</em> assigned during the topic rendering, and their effect will be visible in the preview.)
<p></p>
<h3 id="Preference_settings_and_topic_revision_history">  Preference settings and topic revision history </h3>
<p></p>
Foswiki always reads the bullet style settings from the most current topic revision, so viewing older revisions of a topic can show unexpected results.
<p></p>
And especially important, <strong>bullet style preference settings are never overridden or set in when a topic content is obtained by "%INCLUDE{".</strong>  However <strong>%SET{ style settings can be overidden</strong> when an INCLUDE is expanded.
in the below example about weather conditions, note the difference in the CONDITIONS expansion
<p></p>
<span id="MacroParam"></span>
<h3 id="Parameters">  Parameters </h3>
<p></p>
<!-- <ul>
<li> Set CONDITIONS = According to <a href="PreferenceSettings.html">PreferenceSettings</a>, the %WHAT% is %STATE% today (Set in <a href="PreferenceSettings.html">PreferenceSettings</a>).
</li> <li> Set WEATHER = It's raining.
</li></ul> 
-->
<em>The following block of code was read from <a href="PreferenceSettings.html">PreferenceSettings</a>, and the "Set" statements were defined in <a class="foswikiCurrentTopicLink" href="Macros.html">Macros</a></em>
<blockquote>
Macros defined using preference settings can take parameters. These are symbols passed in the call to the macro to define local macros that will be expanded in the output.
For example, Both System.Macros and <a href="PreferenceSettings.html">PreferenceSettings</a> have a Set statement that defines the <code>%CONDITIONS%</code> macro as shown here:
<p></p>
<pre class='tml'> &#42; Set CONDITIONS &#61; According to &#91;&#91;&#37;TOPIC&#37;&#93;&#93; the &#37;WHAT&#37; is &#37;STATE&#37; today (Set in ...).</pre>
The <code>%TOPIC%</code> shows where the CONDITIONS macro is expanded, and the ...  shows where the Set statement was actually defined.
<p></p>
You can call this macro passing in values for <code>WHAT</code> and <code>STATE</code>. For example: <ul>
<li> <code>%CONDITIONS{WHAT="sea" STATE="choppy"}%</code> <ul>
<li> expands to <code>According to <a href="PreferenceSettings.html">PreferenceSettings</a>, The sea is choppy today. (Set in <a href="Macros.html" class="foswikiCurrentTopicLink">Macros</a>).</code>
</li></ul> 
</li></ul> 
</blockquote>
Note that &#37;CONDITIONS% expands differently when this example is viewed in <a href="PreferenceSettings.html">PreferenceSettings</a>.
This is because Set statement are not active in included topics.  The including topic's set statements are used.
<p></p>
<h4 id="Parameter_defaults">  Parameter defaults </h4> <ul>
<li> The special parameter name <code>DEFAULT</code> gets the value of any unnamed parameter in the macro call.
</li> <li> Parameter macros can accept a <code>default</code> parameter so that they expand to something even when a value isn't passed for them in the call.
</li></ul> 
Example:
<p></p>
<pre class='tml'>
   &#42; Set WEATHER &#61; It&#39;s &#37;DEFAULT{default&#61;&#34;raining&#34;}&#37;.</pre> <ul>
<li> <code>%WEATHER%</code> expands to <code>It's raining.</code>
</li> <li> <code>%WEATHER{"sunny"}%</code> expands to <code>It's sunny.</code>
</li></ul> 
The standard <a href="FormatTokens.html">formatting tokens</a> can be used in parameters. They will be expanded immediately when the macro is instantiated.
<p></p>
<p></p>
<img width="16" title="ALERT!" height="16" alt="ALERT!" src="DocumentGraphics.attachments/warning.png"> Note that parameters <strong>override</strong> all other macros, including system defined macros, in the expansion of the macro where they are used.
<p></p>
<h3 id="Access_Control_Settings">  Access Control Settings </h3>
<p></p>
These are special types of preference settings to control access to content. <a href="AccessControl.html">AccessControl</a> explains these security settings in detail. Parameters are <strong>not</strong> available in access control settings. <a href="AccessControl.html">AccessControl</a> settings cannot be set or changed by the <code>%SET{}%</code> macro.
<p></p>
<h3 id="Local_values_for_preferences">  Local values for preferences </h3>
<p></p>
Certain topics (user, plugin, web, site and default preferences topics) have a problem; macros defined in those topics can have two meanings. For example, consider a user topic. A user may want to use the wiki text editor, but <strong>only</strong> when editing their home topic. The rest of the time, they want to use the default Wysiwyg editor. This separation is achieved using <code>Local</code> in place of <code>Set</code> in the macro definition. For example, if the user sets the following in their home topic:
<p></p>
<pre class='tml'>   &#42; Local NOWYSIWYG &#61; 1</pre>
<p></p>
Then, when they are editing any other topic, they will get the Wysiwyg editor. However, when they are editing their home topic they will get the wikitext editor.
<code>Local</code> can be used wherever a preference needs to take a different value depending on where the current operation is being performed.
<p></p>
<code>%SHOWPREFERENCE%</code> can be used to get a listing of the values of all macros in their evaluation order, so you can see macro scope if you get confused.
<pre class="tml">&#37;SHOWPREFERENCE{&#34;CONDITIONS&#34;}&#37;</pre> expands into: <ul>
<li> Set CONDITIONS = "According to &#91;&#91;&#37;TOPIC&#37;&#93;&#93;, The &#37;WHAT&#37; is &#37;STATE&#37; today. (Set in &#91;&#91;Macros&#93;&#93;)." <ul>
<li> CONDITIONS was defined in System.Macros
</li></ul> 
</li></ul> 
<p></p>
<p></p>
<!--  -->
<p></p>
<span id="PreDef"></span>
<h2 id="Predefined_Macros">  Predefined Macros </h2>
<p></p>
Most predefined macros return values that were either set in the configuration when Foswiki was installed, or taken from server info (such as current username, or date and time). Some, like <code>%SEARCH%</code>, are powerful and general tools.
<p></p>
<div class="foswikiHelp">
<img width="16" title="ALERT!" height="16" alt="ALERT!" src="DocumentGraphics.attachments/warning.png"> Predefined macros can be overridden by <a href="PreferenceSettings.html">preference settings</a> (except TOPIC and WEB)
<p></p>
<img src="DocumentGraphics.attachments/warning.png" height="16" alt="ALERT!" title="ALERT!" width="16"> Plugins may extend the set of predefined macros (see individual Plugins topics for details)
<p></p>
<img height="16" alt="TIP" src="DocumentGraphics.attachments/tip.png" width="16" title="TIP"> <strong>Take the time to thoroughly read through ALL preference macros.</strong> If you actively configure your site, review macros periodically. They cover a wide range of functions, and it can be easy to miss the one perfect macro for something you have in mind. For example, see <code>%BASETOPIC%</code>, <code>%INCLUDE%</code>, and the mighty <code>%SEARCH%</code>.
</div>
<p></p>
See <a href="MacrosQuickReference.html">MacrosQuickReference</a> for a complete list of predefined macros in your installation.
<p></p>
<h2 id="Readable_Macros">  Readable Macros </h2>
<p></p>
Some macros can become quite complex and, as such, hard to read. Over the years changes have been made to make this easier. For some time it has been possible to break a macro over multiple lines. Nonetheless, each parameter can easily extend onto many lines (it can after all be another macro). In general Foswiki allows lines to be continued by ending a line with a <code>\</code> character. This is generally useful but with macros you need precise control of spaces which <code>\</code> does not give you.
<p></p>
From Foswiki 2.1 it's now possible to use the following in macros to make them much more readable: <ul>
<li> <code>parameter="value" +"more" +"and more"</code>
</li> <li> <code>param1+="value1" param2+="value2" param1+="more1" param2+="more2"</code>
</li></ul> 
<p></p>
Once upon a time in the early days of the project the parameters to SEARCH would need to be written as one line of TML, an example from an active Foswiki site:
<pre class="tml">
type&#61;&#34;query&#34; nonoise&#61;&#34;on&#34; web&#61;&#34;Batch&#34; header&#61;&#34;&#124;&#42;Batch Code&#42;&#124;&#42;Batch Value&#42;&#124;&#42;Currencies&#42;&#124;&#42;Sizes&#42;&#124;&#42;Count&#42;&#124;&#42;To Queue&#42;&#124;&#42;Killed&#42;&#124;&#42;Ignored&#42;&#124;&#42;Errors&#42;&#124;&#42;Notes&#42;&#124;&#42;History&#42;&#124;&#42;Flow&#42;&#124;&#34; format&#61;&#34;&#124; &#91;&#91;&#36;topic&#93;&#91;&#36;formfield(BatchCode) &#36;formfield(BatchDate) &#36;formfield(BatchNumber) &#36;formfield(BatchLocation)&#93;&#93;&#34;}&#36;percnt &#124; &#36;formfield(BatchValue) &#124; &#36;formfield(BatchCurrencies) &#124; &#36;formfield(BatchSizes) &#124; &#36;formfield(BatchCount) &#124; &#36;formfield(BatchToQueue) &#124; &#36;formfield(BatchKilled) &#124; &#36;formfield(BatchIgnored) &#124; &#60;div style&#61;&#39;background-color:#&#36;percntCALC{&#36;SET(dat,&#36;formfield(BatchDate))&#36;SET(pdat,&#36;formfield(BatchProcessDate))&#36;SET(age,&#36;EVAL(&#36;percnt&#36;formfield(BatchCode)&#95;days&#36;percnt))&#36;IF(&#36;EXACT(&#36;percntWORKFLOWSTATE{\&#34;&#36;topic\&#34;}&#36;percnt,CHECKED),FAF0D4,&#36;IF(&#36;GET(age)&#62;&#61;0,ff3300,&#36;IF(&#36;GET(age)&#62;&#61;-2,ff9933,66cc33)))}&#36;percnt&#39;&#62;&#36;formfield(BatchErrors)&#38;nbsp;&#60;/div&#62; &#124; &#36;formfield(BatchOperators) &#124; &#36;formfield(BatchActivities) &#124; &#60;form name&#61;\&#34;Edit\&#34; action&#61;\&#34;&#37;SCRIPTURLPATH{edit}&#37;/&#37;WEB&#37;/\&#34;&#62; &#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;action\&#34; value&#61;\&#34;form\&#34;/&#62; &#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;topic\&#34; value&#61;\&#34;&#36;topic\&#34;/&#62; &#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;redirectto\&#34; value&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING{encode&#61;&#34;url&#34;}&#37;\&#34;/&#62; &#60;input type&#61;\&#34;image\&#34; src&#61;\&#34;&#37;ICONURL{pencil}&#37;\&#34; alt&#61;\&#34;Edit Form\&#34; /&#62; &#60;/form&#62; &#36;formfield(BatchNotes) &#124; &#36;percntWORKFLOWHISTORY{\&#34;&#36;topic\&#34;}&#36;percnt &#124; &#36;percntWORKFLOWTRANSITION{\&#34;&#36;topic\&#34; redirectto&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING{encode&#61;&#34;url&#34;}&#37;\&#34;}&#36;percnt &#124;&#34;
</pre>
<p></p>
That is very hard to read and debug, and even harder to maintain months or years later and for readability this example excludes the complex and many line <code>search</code> parameter.
<p></p>
Now, we can improve that by splitting each parameter onto a separate line:
<pre class="tml">
  type&#61;&#34;query&#34;
  nonoise&#61;&#34;on&#34;
  web&#61;&#34;Batch&#34;
  header&#61;&#34;&#124;&#42;Batch Code&#42;&#124;&#42;Batch Value&#42;&#124;&#42;Currencies&#42;&#124;&#42;Sizes&#42;&#124;&#42;Count&#42;&#124;&#42;To Queue&#42;&#124;&#42;Killed&#42;&#124;&#42;Ignored&#42;&#124;&#42;Errors&#42;&#124;&#42;Notes&#42;&#124;&#42;History&#42;&#124;&#42;Flow&#42;&#124;&#34;
  format&#61;&#34;&#124; &#91;&#91;&#36;topic&#93;&#91;&#36;formfield(BatchCode) &#36;formfield(BatchDate) &#36;formfield(BatchNumber) &#36;formfield(BatchLocation)&#93;&#93; &#124; &#36;formfield(BatchValue) &#124; &#36;formfield(BatchCurrencies) &#124; &#36;formfield(BatchSizes) &#124; &#36;formfield(BatchCount) &#124; &#36;formfield(BatchToQueue) &#124; &#36;formfield(BatchKilled) &#124; &#36;formfield(BatchIgnored) &#124; &#60;div style&#61;&#39;background-color:#&#36;percntCALC{&#36;SET(dat,&#36;formfield(BatchDate))&#36;SET(pdat,&#36;formfield(BatchProcessDate))&#36;SET(age,&#36;EVAL(&#36;percnt&#36;formfield(BatchCode)&#95;days&#36;percnt))&#36;IF(&#36;EXACT(&#36;percntWORKFLOWSTATE{\&#34;&#36;topic\&#34;}&#36;percnt,CHECKED),FAF0D4,&#36;IF(&#36;GET(age)&#62;&#61;0,ff3300,&#36;IF(&#36;GET(age)&#62;&#61;-2,ff9933,66cc33)))}&#36;percnt&#39;&#62;&#36;formfield(BatchErrors)&#38;nbsp;&#60;/div&#62; &#124; &#36;formfield(BatchOperators) &#124; &#36;formfield(BatchActivities) &#124; &#60;form name&#61;\&#34;Edit\&#34; action&#61;\&#34;&#37;SCRIPTURLPATH{edit}&#37;/&#37;WEB&#37;/\&#34;&#62; &#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;action\&#34; value&#61;\&#34;form\&#34;/&#62; &#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;topic\&#34; value&#61;\&#34;&#36;topic\&#34;/&#62; &#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;redirectto\&#34; value&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING{encode&#61;&#34;url&#34;}&#37;\&#34;/&#62; &#60;input type&#61;\&#34;image\&#34; src&#61;\&#34;&#37;ICONURL{pencil}&#37;\&#34; alt&#61;\&#34;Edit Form\&#34; /&#62; &#60;/form&#62; &#36;formfield(BatchNotes) &#124; &#36;percntWORKFLOWHISTORY{\&#34;&#36;topic\&#34;}&#36;percnt &#124; &#36;percntWORKFLOWTRANSITION{\&#34;&#36;topic\&#34; redirectto&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING{encode&#61;&#34;url&#34;}&#37;\&#34;}&#36;percnt &#124;&#34;
</pre>
<p></p>
That helps a little, but the <code>format</code> parameter still covers multiple lines and is still hard to follow.
<p></p>
Now we could use the standard Foswiki line continuation, but you do not get full control of spacing and you cannot achieve the result you want. In the example above, which creates a table, one possible problem is having cell values centred instead of right justified.
<p></p>
This is when the ability to cleanly separate comes into its own. This is achieved by using the <code>+"more"</code> option to break a parameter into appropriate pieces, we can now transform the above to:
<pre class="tml">
  type&#61;&#34;query&#34;
  nonoise&#61;&#34;on&#34;
  web&#61;&#34;Batch&#34;
  header&#61;&#34;&#34;
        +&#34;&#124;&#42;Batch Code&#42;&#34;
        +&#34;&#124;&#42;Batch Value&#42;&#34;
        +&#34;&#124;&#42;Currencies&#42;&#34;
        +&#34;&#124;&#42;Sizes&#42;&#34;
        +&#34;&#124;&#42;Count&#42;&#34;
        +&#34;&#124;&#42;To Queue&#42;&#34;
        +&#34;&#124;&#42;Killed&#42;&#34;
        +&#34;&#124;&#42;Ignored&#42;&#34;
        +&#34;&#124;&#42;Errors&#42;&#34;
        +&#34;&#124;&#42;Notes&#42;&#34;
        +&#34;&#124;&#42;History&#42;&#34;
        +&#34;&#124;&#42;Flow&#42;&#34;
        +&#34;&#124;&#34;
  format&#61;&#34;&#34;
        +&#34;&#124; &#91;&#91;&#36;topic&#93;&#91;&#36;formfield(BatchCode) &#36;formfield(BatchDate) &#36;formfield(BatchNumber) &#36;formfield(BatchLocation)&#93;&#93;&#34;
        +&#34;&#124; &#36;formfield(BatchValue) &#34;
        +&#34;&#124; &#36;formfield(BatchCurrencies) &#34;
        +&#34;&#124; &#36;formfield(BatchSizes) &#34;
        +&#34;&#124; &#36;formfield(BatchCount) &#34;
        +&#34;&#124; &#36;formfield(BatchToQueue) &#34;
        +&#34;&#124; &#36;formfield(BatchKilled) &#34;
        +&#34;&#124; &#36;formfield(BatchIgnored) &#34;
        +&#34;&#124; &#60;div style&#61;&#39;background-color:#&#34;
        +&#34;&#36;percntCALC{&#34;
        +&#34;&#36;SET(dat,&#36;formfield(BatchDate))&#34;
        +&#34;&#36;SET(pdat,&#36;formfield(BatchProcessDate))&#34;
        +&#34;&#36;SET(age,&#36;EVAL(&#36;percnt&#36;formfield(BatchCode)&#95;days&#36;percnt))&#34;
        +&#34;&#36;IF(&#36;EXACT(&#36;percntWORKFLOWSTATE{\&#34;&#36;topic\&#34;}&#36;percnt,CHECKED),FAF0D4,&#34;
        +&#34;&#36;IF(&#36;GET(age)&#62;&#61;0,ff3300,&#36;IF(&#36;GET(age)&#62;&#61;-2,ff9933,66cc33)))}&#34;
        +&#34;&#36;percnt&#39;&#62;&#36;formfield(BatchErrors)&#38;nbsp;&#60;/div&#62; &#34;
        +&#34;&#124; &#36;formfield(BatchOperators) &#34;
        +&#34;&#124; &#36;formfield(BatchActivities) &#34;
        +&#34;&#124; &#60;form name&#61;\&#34;Edit\&#34; action&#61;\&#34;&#37;SCRIPTURLPATH{edit}&#37;/&#37;WEB&#37;/\&#34;&#62;&#34;
        +&#34;&#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;action\&#34; value&#61;\&#34;form\&#34;/&#62;&#34;
        +&#34;&#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;topic\&#34; value&#61;\&#34;&#36;topic\&#34;/&#62;&#34;
        +&#34;&#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;redirectto\&#34; value&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING{encode&#61;&#34;url&#34;}&#37;\&#34;/&#62;&#34;
        +&#34;&#60;input type&#61;\&#34;image\&#34; src&#61;\&#34;&#37;ICONURL{pencil}&#37;\&#34; alt&#61;\&#34;Edit Form\&#34; /&#62; &#60;/form&#62; &#36;formfield(BatchNotes) &#34;
        +&#34;&#124; &#36;percntWORKFLOWHISTORY{\&#34;&#36;topic\&#34;}&#36;percnt &#34;
        +&#34;&#124; &#36;percntWORKFLOWTRANSITION{\&#34;&#36;topic\&#34; redirectto&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING{encode&#61;&#34;url&#34;}&#37;\&#34;}&#36;percnt &#34;
        +&#34;&#124;&#34;
</pre>
<p></p>
Note the use of <code>+</code> to concatenate all the pieces of the <code>format</code> and <code>header</code> parameters together. Also note that each piece is of the form <code>+"more"</code> and as that is quoted you have full control of the contents. This is especially true for those all important spaces &mdash; you'll see some pieces have a trailing space and some do not.
<p></p>
<div class="foswikiHelp">
<img title="TIP" width="16" src="DocumentGraphics.attachments/tip.png" height="16" alt="TIP"> parameter="value" +" and more"       &mdash; is quite valid on one line if its useful
<p></p>
<img width="16" title="ALERT!" alt="ALERT!" height="16" src="DocumentGraphics.attachments/warning.png"> parameter="1" +"2" gives you "12" <strong>not</strong> "3"
</div>
<p></p>
Both the <code>header</code> and <code>format</code> parameters above start each table cell on a separate line. This makes it a little easier to scan the topic text the match the cell positions and check they line up (i.e. the Header cell #n will match the contents from Format cell #n).
<p></p>
Another trick used above for easier maintenance is to initialise a parameter to <code>""</code> and then add the pieces on separate lines. (In the example we are dealing with table cells hence <code>"|"</code>, on a separate line, is used as an end of row marker.) This helps by allowing you to cut and paste whole lines, representing cells, into different column positions without concern as to whether or not it's the 1st column, last column or one in the middle because they have an identical structure.
<p></p>
Nonetheless, keeping the <code>header</code> of a table column separate from the <code>format</code> of each cell in the SEARCH can still be troublesome especially as the number of columns and/or complexity of <code>header</code> and <code>footer</code> cells grow.
<p></p>
To remedy that the <code>param1+="value1" param2="value2" param1+="more1" param2+="more2"</code> can be used. Not that the pieces of different parameters can now be intermingled in whatever way you need to make the macro easier to read. For example we can transform the above to:
<pre class="tml">
  type&#61;&#34;query&#34;
  nonoise&#61;&#34;on&#34;
  web&#61;&#34;Batch&#34;

  header+&#61;&#34;&#124;&#42;Control record&#42;&#34;
  format+&#61;&#34;&#124; &#60;span style&#61;\&#34;display:none;\&#34;&#62;&#34;
         +&#34;&#36;formfield(BatchNumber) &#36;formfield(BatchLocation) &#34;
         +&#34;&#36;percntCALC{&#36;SUBSTRING(&#36;topic,13,3)}&#36;percnt &#36;formfield(BatchDate) &#34;
         +&#34;!&#36;formfield(BatchCode)&#34;
         +&#34;&#60;/span&#62;&#34;
         +&#34;&#60;a id&#61;\&#34;&#36;topic\&#34;/&#62;&#91;&#91;&#36;topic&#93;&#93;&#34;

  header+&#61;&#34;&#124;&#42;Batch Value&#42;&#34;
  format+&#61;&#34;&#124;  &#36;formfield(BatchValue) &#34;

  header+&#61;&#34;&#124;&#42;Batch Curr- encies&#42;&#34;
  format+&#61;&#34;&#124; &#36;formfield(BatchCurrencies) &#34;

  header+&#61;&#34;&#124;&#42;Success&#42;&#34;
  format+&#61;&#34;&#124;  &#36;formfield(BatchCount) &#34;

  header+&#61;&#34;&#124;&#42;To Queue&#42;&#34;
  format+&#61;&#34;&#124;  &#36;formfield(BatchToQueue) &#34;

  header+&#61;&#34;&#124;&#42;Killed&#42;&#34;
  format+&#61;&#34;&#124;  &#36;formfield(BatchKilled) &#34;

  header+&#61;&#34;&#124;&#42;Ignored&#42;&#34;
  format+&#61;&#34;&#124;  &#36;formfield(BatchIgnored) &#34;

  header+&#61;&#34;&#124;&#42;Batch Size&#42;&#34;
  format+&#61;&#34;&#124;  &#36;formfield(BatchSizes) &#34;

  header+&#61;&#34;&#124;&#42;Batch Errors&#42;&#34;
  format+&#61;&#34;&#124; &#60;div style&#61;&#39;background-color:#&#34;
         +&#34;&#36;percntCALC{&#36;SET(dat,&#36;formfield(BatchDate))&#34;
         +&#34;&#36;SET(pdat,&#36;formfield(BatchProcessDate))&#34;
         +&#34;&#36;SET(age,&#36;EVAL(&#36;percnt&#36;formfield(BatchCode)&#95;days&#36;percnt))&#34;
         +&#34;&#36;IF(&#36;EXACT(&#36;percntWORKFLOWSTATE{\&#34;&#36;topic\&#34;}&#36;percnt,CHECKED),FAF0D4,&#34;
         +&#34;&#36;IF(&#36;GET(age)&#62;&#61;0,ff3300,&#36;IF(&#36;GET(age)&#62;&#61;-2,ff9933,66cc33)))}&#36;percnt&#39;&#62;&#34;
         +&#34;&#36;formfield(BatchErrors) &#60;/div&#62; &#34;

  header+&#61;&#34;&#124;&#42;Batch Oper- ators&#42;&#34;
  format+&#61;&#34;&#124; &#36;formfield(BatchOperators) &#34;

  header+&#61;&#34;&#124;&#42;Batch Acti- vities&#42;&#34;
  format+&#61;&#34;&#124; &#36;formfield(BatchActivities) &#34;

  header+&#61;&#34;&#124;&#42;Batch Notes&#42;&#34;
  format+&#61;&#34;&#124; &#60;form name&#61;\&#34;Edit\&#34; action&#61;\&#34;&#37;SCRIPTURLPATH{edit}&#37;/&#37;WEB&#37;/\&#34;&#62;&#34;
         +&#34;&#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;action\&#34; value&#61;\&#34;form\&#34;/&#62;&#34;
         +&#34;&#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;topic\&#34; value&#61;\&#34;&#36;topic\&#34;/&#62;&#34;
         +&#34;&#60;input type&#61;\&#34;hidden\&#34; name&#61;\&#34;redirectto\&#34; value&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING&#37;#&#36;topic\&#34;/&#62;&#34;
         +&#34;&#60;input type&#61;\&#34;image\&#34; src&#61;\&#34;&#37;ICONURL{pencil}&#37;\&#34; alt&#61;\&#34;Edit Form\&#34; /&#62; &#60;/form&#62; &#36;formfield(BatchNotes)&#34;

  header+&#61;&#34;&#124;&#42;Status History&#42;&#34;
  format+&#61;&#34;&#124; &#36;percntWORKFLOWHISTORY{\&#34;&#36;topic\&#34;}&#36;percnt &#34;

  header+&#61;&#34;&#124;&#42;Change Status&#42;&#34;
  format+&#61;&#34;&#124; &#36;percntWORKFLOWTRANSITION{\&#34;&#36;topic\&#34; redirectto&#61;\&#34;&#37;TOPIC&#37;?&#37;QUERYSTRING&#37;#&#36;topic\&#34;}&#36;percnt &#34;

  header+&#61;&#34;&#124;&#34;
  format+&#61;&#34;&#124;&#34;
</pre>
<p></p>
There is no guesswork (or cell counting) required to work out which cell <code>header</code> matches which <code>format</code> cell. Also note how this enables you to better manage table layouts by keeping the coding for each column together and in turn the easy ability to move a column into other positions by cut and paste.
<p></p>
The 1st parameter in a macro does not have to be named, e.g <code>%MACRO{"I'm the first"}%</code>. How can you extend such a value with <code>name+="more"</code> when it has no name? Well actually it does and it's name is <code>_DEFAULT</code> so you can have <code>%MACRO{"I'm the first" type="X" _DEFAULT+=", with seconds"}%</code>. Some macros may give you an alternative name to use, e.g. <code>%SEARCH</code> allows <code>search</code> i.e. <code>%SEARCH{search="find him" type="literal" search+=" and her"}%</code>. In this situation it is better to use one or the other and not both as that could lead to confusion. In the case of <code>%SEARCH</code> if you use both then this macro will ignore <code>search</code> and use <code>_DEFAULT</code>, so take care.
<p></p>
The following is a working example using the Foswiki FAQ topics follows. You can use this to create yourself a <a href="../Sandbox/WebHome.html">Sandbox</a> topic to try out the <code>+</code> and <code>+=</code> options to experiment with ways to make macros easier to read.
<pre class="tml">
&#37;SEARCH{&#34;form.name ~ &#39;FAQForm&#39;&#34;
  type&#61;&#34;query&#34;
  web&#61;&#34;System&#34;
  nonoise&#61;&#34;on&#34;

  header+&#61;&#34;&#124;&#42;Title&#42;&#34;
  format+&#61;&#34;&#124;&#36;formfield(TopicTitle)&#34;

  header+&#61;&#34;&#124;&#42;Topic&#42;&#34;
  format+&#61;&#34;&#124;&#36;web.&#36;topic&#34;

  header+&#61;&#34;&#124;&#42;Summary&#42;&#34;
  format+&#61;&#34;&#124;&#36;formfield(TopicSummary)&#34;

  header+&#61;&#34;&#124;&#42;Related Topics&#42;&#34;
  format+&#61;&#34;&#124;&#36;formfield(RelatedTopics)&#34;

  header+&#61;&#34;&#124;&#34;
  format+&#61;&#34;&#124;&#34;
}&#37;</pre>
<p></p>
This gives:
<table class="foswikiTable" rules="none">
	<thead>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<th class="foswikiTableCol0 foswikiFirstCol"> <a title="Sort by this column" rel="nofollow" href="../PublishPlugin/publish.html">Title</a> </th>
			<th class="foswikiTableCol1"> <a rel="nofollow" href="../PublishPlugin/publish.html" title="Sort by this column">Topic</a> </th>
			<th class="foswikiTableCol2"> <a rel="nofollow" href="../PublishPlugin/publish.html" title="Sort by this column">Summary</a> </th>
			<th class="foswikiTableCol3 foswikiLastCol"> <a title="Sort by this column" href="../PublishPlugin/publish.html" rel="nofollow">Related Topics</a> </th>
		</tr>
	</thead>
	<tbody>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol"> Creating applications with <a href="DataForms.html">DataForms</a> </td>
			<td class="foswikiTableCol1"> <a href="FAQAnApplicationWithWikiForm.html">FAQAnApplicationWithWikiForm</a> </td>
			<td class="foswikiTableCol2"> How can I create a simple data form based application? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="UserDocumentationCategory.html">UserDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted1 foswikiTableRowdataBg1">
			<td class="foswikiTableCol0 foswikiFirstCol"> Deleting and renaming topics </td>
			<td class="foswikiTableCol1"> <a href="FAQDeleteOrRenameATopic.html">FAQDeleteOrRenameATopic</a> </td>
			<td class="foswikiTableCol2"> How do I delete or rename a topic? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="UserDocumentationCategory.html">UserDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol"> Deleting and renaming attachments </td>
			<td class="foswikiTableCol1"> <a href="FAQDeleteOrRenameAnAttachment.html">FAQDeleteOrRenameAnAttachment</a> </td>
			<td class="foswikiTableCol2"> How do I delete or rename a file attachment? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="UserDocumentationCategory.html">UserDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted1 foswikiTableRowdataBg1">
			<td class="foswikiTableCol0 foswikiFirstCol"> Get Foswiki </td>
			<td class="foswikiTableCol1"> <a href="FAQDownloadSources.html">FAQDownloadSources</a> </td>
			<td class="foswikiTableCol2"> I would like to install Foswiki on my server. Can I get the source? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="AdminDocumentationCategory.html">AdminDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol"> Explanation of Foswiki's <code>repRev</code> feature </td>
			<td class="foswikiTableCol1"> <a href="FAQEditDoesNotIncreaseTheRevision.html">FAQEditDoesNotIncreaseTheRevision</a> </td>
			<td class="foswikiTableCol2"> Why does the topic revision not increase when I edit a topic? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="UserDocumentationCategory.html">UserDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted1 foswikiTableRowdataBg1">
			<td class="foswikiTableCol0 foswikiFirstCol"> Foswiki software license </td>
			<td class="foswikiTableCol1"> <a href="FAQGnuGeneralPublicLicense.html">FAQGnuGeneralPublicLicense</a> </td>
			<td class="foswikiTableCol2"> Foswiki has a GPL (GNU General Public License). What is GPL? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="UserDocumentationCategory.html">UserDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol"> <a class="foswikiNewLink" rel="nofollow" href="HiddenUsersAndGroups.html" title="Create this topic">HiddenUsersAndGroups</a> </td>
			<td class="foswikiTableCol1"> <a href="FAQHiddenUsersAndGroups.html">FAQHiddenUsersAndGroups</a> </td>
			<td class="foswikiTableCol2"> How to hide groups and users from common view </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="VarGROUPINFO.html">VarGROUPINFO</a>, <a href="AccessControl.html">AccessControl</a> </td>
		</tr>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted1 foswikiTableRowdataBg1">
			<td class="foswikiTableCol0 foswikiFirstCol"> Rebuilding <a title="Create this topic" href="WikiUsers.html" class="foswikiNewLink" rel="nofollow">WikiUsers</a> topic </td>
			<td class="foswikiTableCol1"> <a href="FAQRebuildingWikiUsersTopic.html">FAQRebuildingWikiUsersTopic</a> </td>
			<td class="foswikiTableCol2"> How can I re-build my <a href="../Main/WikiUsers.html">WikiUsers</a> topic? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> Foswiki:Support.Faq27, <a href="TopicUserMappingContrib.html">TopicUserMappingContrib</a>, <a href="../Main/WikiUsers.html">WikiUsers</a>, <a href="AdminDocumentationCategory.html">AdminDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol"> Fixing broken <code>%SEARCH</code> caused by faulty configuration. </td>
			<td class="foswikiTableCol1"> <a href="FAQSearchDoesNotWork.html">FAQSearchDoesNotWork</a> </td>
			<td class="foswikiTableCol2"> I've problems with the WebSearch. There is no Search Result on any inquiry. By clicking the Index topic it's the same problem. </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="AdminDocumentationCategory.html">AdminDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted1 foswikiTableRowdataBg1">
			<td class="foswikiTableCol0 foswikiFirstCol"> How simultaneous edits are handled in Foswiki </td>
			<td class="foswikiTableCol1"> <a href="FAQSimultaneousEdits.html">FAQSimultaneousEdits</a> </td>
			<td class="foswikiTableCol2"> What happens if two or more users try to edit the same topic simultaneously? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> <a href="UserDocumentationCategory.html">UserDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol">  </td>
			<td colspan="3"> System.FAQTemplate </td>
		</tr>
		<tr class="foswikiTableOdd foswikiTableRowdataBgSorted1 foswikiTableRowdataBg1">
			<td class="foswikiTableCol0 foswikiFirstCol"> Troubleshooting Extensions </td>
			<td class="foswikiTableCol1"> <a href="FAQTroubleshootingExtensions.html">FAQTroubleshootingExtensions</a> </td>
			<td class="foswikiTableCol2"> A plugin I installed is not working. How can I troubleshoot it? </td>
			<td class="foswikiTableCol3 foswikiLastCol"> Foswiki:Support.Faq31, <a href="InstalledPlugins.html">InstalledPlugins</a>, <a href="AdminDocumentationCategory.html">AdminDocumentationCategory</a> </td>
		</tr>
		<tr class="foswikiTableEven foswikiTableRowdataBgSorted0 foswikiTableRowdataBg0">
			<td class="foswikiTableCol0 foswikiFirstCol foswikiLast"> Definition of "WikiWiki" </td>
			<td class="foswikiTableCol1 foswikiLast"> <a href="FAQWhatIsWikiWiki.html">FAQWhatIsWikiWiki</a> </td>
			<td class="foswikiTableCol2 foswikiLast"> So what is this WikiWiki thing exactly? </td>
			<td class="foswikiTableCol3 foswikiLastCol foswikiLast"> <a href="WelcomeGuest.html">WelcomeGuest</a>, <a href="GoodStyle.html">GoodStyle</a>, <a href="FrequentlyAskedQuestions.html">FrequentlyAskedQuestions</a>, <a href="WikiCulture.html">WikiCulture</a> </td>
		</tr>
	</tbody></table>
<p></p>
<p></p>
<p></p>
<hr />
<strong>Related Topics:</strong> <a href="MacrosQuickReference.html">MacrosQuickReference</a>, <a href="PreferenceSettings.html">PreferenceSettings</a>, <a href="UserDocumentationCategory.html">UserDocumentationCategory</a>
<!--  -->
<hr />
<p></p>
<hr />
<p></p>
</body>