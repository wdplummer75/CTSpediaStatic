var TML={STYLING:[[/(^|[\s(])\{(\S+?|\S[^\n]*?\S)\}($|(?=[\s,.;:!?)]))/g,"$1<strong><code>{$2}</code></strong>"],[/(^|[\s\(])\*(\S+?|\S[^\n]*?\S)\*(?:$|(?=[\s,.;:!?\)]))/g,"$1<strong>$2</strong>"],[/(^|[\s\(])\_(\S+?|\S[^\n]*?\S)\_(?:$|(?=[\s,.;:!?\)]))/g,"$1<em>$2</em>"],[/(^|[\s\(])\=(\S+?|\S[^\n]*?\S)\=(?:$|(?=[\s,.;:!?\)]))/g,"$1<code>$2</code>"],[/\[\[([^\]]+)\]\]/g,'<a target="_blank" href="$1">$1</a>'],[/\[\[([^\]]+)\]\[([^\]]+)\]\]/g,'<a target="_blank" href="$1">$2</a>']],render:function(e){var t,l,r,n,s,c,p,a,i,g;for(t=[],l=(e=e.replace(/<verbatim>((.|\n)*?)<\/verbatim>/g,(function(e,l){return l=l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.push("<pre>"+l+"</pre>"),"PLACEHOLDER"+(t.length-1)+";"})).replace(/(<(button|select|option|textarea)\b(?:.|\n)*?<\/\1>)/g,(function(e,l){return t.push(l),"PLACEHOLDER"+(t.length-1)+";"})).replace(/^>(.*)$/gm,'<p class="one_line_report"> $1 </p>')).split(/\n/),r=!1,n=!1,c=0;c<l.length;c++)if(i=l[c],/^\s*$/.test(i))n?(l.splice(c++,0,"</"+s+">"),n=!1):r&&(l.splice(c++,0,"</table>"),r=!1),l[c]="<br />";else{for(p=0;p<TML.STYLING.length;p++)i=i.replace(TML.STYLING[p][0],TML.STYLING[p][1]);l[c]=i,(a=/^(?: {3}|\t)(\*|\d) (.*)$/.exec(i))?(l[c]=i.replace(/^( {3}|\t)\*|\d /,""),n||(s="*"===a[1]?"ul":"ol",r&&(l.splice(c++,0,"</table>"),r=!1),l.splice(c++,0,"<"+s+">"),n=!0),l.splice(c++,0,"<li>"),l.splice(++c,0,"</li>")):(a=/^\|(.*)\|$/.exec(i))?((g=i.split(/\|/)).shift(),g.pop(),n&&(l.splice(c++,0,"</"+s+">"),n=!1),r||(l.splice(c++,0,'<table class="tml">'),r=!0),l.splice(c++,0,"<tr><td>"),l[c]=g.join("</td><td>"),l.splice(++c,0,"</td></tr>")):(n?/^( {3}|\t)/.test(i)||(l.splice(c++,0,"</"+s+">"),n=!1):r&&(l.splice(c++,0,"</table>"),r=!1),(a=/^---(\++) (.*)$/.exec(i))&&(l[c]="<h"+a[1].length+">"+a[2]+"</h"+a[1].length+">"))}return n?l.push("</"+s+">"):r&&l.push("</table>"),(e=l.join(" ")).replace(/PLACEHOLDER(\d+);/g,(function(e,l){return t[l]}))},render_reports:function(e){var t,l,r="",n="";for(t=0;t<e.length;t++)e[t].level!==l&&(n.length>0&&(r+='<div class="'+l+'">'+TML.render(n)+"</div>",n=""),l=e[t].level),n+=e[t].text+"\n";return n.length>0&&(r+='<div class="'+l+'">'+TML.render(n)+"</div>"),r}};
