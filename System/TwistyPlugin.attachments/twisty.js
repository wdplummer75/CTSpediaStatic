var foswiki;foswiki||(foswiki={}),foswiki.TwistyPlugin=new function(){var i=this;this._getName=function(i){var t=new RegExp("(.*)(hide|show|toggle)","g").exec(i);return t&&t[1]?t[1]:""},this._getType=function(i){var t=new RegExp("(.*)(hide|show|toggle)","g").exec(i);return t&&t[2]?t[2]:""},this._toggleTwisty=function(t){t&&(t.state=t.state==foswiki.TwistyPlugin.CONTENT_HIDDEN?foswiki.TwistyPlugin.CONTENT_SHOWN:foswiki.TwistyPlugin.CONTENT_HIDDEN,i._update(t,!0))},this._update=function(i,t){var s=i.show,e=i.hide,w=i.toggle;i.state==foswiki.TwistyPlugin.CONTENT_SHOWN?(foswiki.CSS.addClass(s,"twistyHidden"),foswiki.CSS.removeClass(e,"twistyHidden"),foswiki.CSS.removeClass(w,"twistyHidden")):(foswiki.CSS.removeClass(s,"twistyHidden"),foswiki.CSS.addClass(e,"twistyHidden"),foswiki.CSS.addClass(w,"twistyHidden")),t&&i.saveSetting&&foswiki.Pref.setPref(foswiki.TwistyPlugin.COOKIE_PREFIX+i.name,i.state),i.clearSetting&&foswiki.Pref.setPref(foswiki.TwistyPlugin.COOKIE_PREFIX+i.name,"")},this._register=function(t){if(t){var s=i._getName(t.id),e=i._storage[s];e||(e=new foswiki.TwistyPlugin.Storage),foswiki.CSS.hasClass(t,"twistyRememberSetting")&&(e.saveSetting=!0),foswiki.CSS.hasClass(t,"twistyForgetSetting")&&(e.clearSetting=!0),foswiki.CSS.hasClass(t,"twistyStartShow")&&(e.startShown=!0),foswiki.CSS.hasClass(t,"twistyStartHide")&&(e.startHidden=!0),foswiki.CSS.hasClass(t,"twistyFirstStartShow")&&(e.firstStartShown=!0),foswiki.CSS.hasClass(t,"twistyFirstStartHide")&&(e.firstStartHidden=!0),e.name=s;var w=i._getType(t.id);switch(e[w]=t,i._storage[s]=e,w){case"show":case"hide":t.onclick=function(){return i._toggleTwisty(e),!1}}return e}},this._storage={},this._UIbehaviour={".twistyTrigger":function(i){foswiki.TwistyPlugin.init(i.id),i=null},".twistyContent":function(i){foswiki.TwistyPlugin.init(i.id),i=null},".twistyExpandAll":function(i){i.onclick=function(){foswiki.TwistyPlugin.toggleAll(foswiki.TwistyPlugin.CONTENT_SHOWN)},i=null},".twistyCollapseAll":function(i){i.onclick=function(){foswiki.TwistyPlugin.toggleAll(foswiki.TwistyPlugin.CONTENT_HIDDEN)},i=null}},Behaviour.register(this._UIbehaviour)},foswiki.TwistyPlugin.CONTENT_HIDDEN=0,foswiki.TwistyPlugin.CONTENT_SHOWN=1,foswiki.TwistyPlugin.COOKIE_PREFIX="TwistyPlugin_",foswiki.TwistyPlugin.prefList,foswiki.TwistyPlugin.init=function(i){var t=document.getElementById(i);if(t){var s=this._getName(i),e=this._storage[s];if(e&&e.show&&e.hide&&e.toggle)return e;if(e=this._register(t),foswiki.CSS.replaceClass(t,"twistyMakeHidden","twistyHidden"),foswiki.CSS.removeClass(t,"foswikiMakeVisible"),foswiki.CSS.removeClass(t,"foswikiMakeVisibleBlock"),foswiki.CSS.removeClass(t,"foswikiMakeVisibleInline"),foswiki.CSS.removeClass(t,"foswikiMakeHidden"),e.show&&e.hide&&e.toggle){if(foswiki.CSS.hasClass(t,"twistyInited1"))return e.state=foswiki.TwistyPlugin.CONTENT_SHOWN,this._update(e,!1),e;if(foswiki.CSS.hasClass(t,"twistyInited0"))return e.state=foswiki.TwistyPlugin.CONTENT_HIDDEN,this._update(e,!1),e;null==foswiki.TwistyPlugin.prefList&&(foswiki.TwistyPlugin.prefList=foswiki.Pref.getPrefList());var w=foswiki.Pref.getPrefValueFromPrefList(foswiki.TwistyPlugin.COOKIE_PREFIX+e.name,foswiki.TwistyPlugin.prefList);e.firstStartHidden&&(e.state=foswiki.TwistyPlugin.CONTENT_HIDDEN),e.firstStartShown&&(e.state=foswiki.TwistyPlugin.CONTENT_SHOWN),w&&"0"==w&&(e.state=foswiki.TwistyPlugin.CONTENT_HIDDEN),w&&"1"==w&&(e.state=foswiki.TwistyPlugin.CONTENT_SHOWN),e.startHidden&&(e.state=foswiki.TwistyPlugin.CONTENT_HIDDEN),e.startShown&&(e.state=foswiki.TwistyPlugin.CONTENT_SHOWN),this._update(e,!1)}return e}},foswiki.TwistyPlugin.toggleAll=function(i){for(var t in this._storage){var s=this._storage[t];s.state=i,this._update(s,!0)}},foswiki.TwistyPlugin.Storage=function(){this.name,this.state=foswiki.TwistyPlugin.CONTENT_HIDDEN,this.hide,this.show,this.toggle,this.saveSetting=!1,this.clearSetting=!1,this.startShown,this.startHidden,this.firstStartShown,this.firstStartHidden};
