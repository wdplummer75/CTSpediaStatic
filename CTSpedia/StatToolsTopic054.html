<!DOCTYPE html>
<html lang="en">
<head>
<title> StatToolsTopic054 &lt; CTSpedia &lt; Foswiki</title>
		  <meta charset="utf-8" />
		  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
		  <meta name="robots" content="noindex" />
		  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.5, user-scalable=yes" />
		  <meta name="mobile-web-app-capable" content="yes" />
		  <meta name="mobile-web-app-status-bar-style" content="black-translucent" />
		  <meta name="apple-mobile-web-app-capable" content="yes" />
		  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" /> <link rel="alternate" href="WebRss.html" type="application/rss+xml" title="RSS Feed">
<link rel="icon" href="../MISSING RESOURCE CTSpedia/StatToolsTopic054/favicon.ico" type="image/x-icon"> <link rel="shortcut icon" href="../MISSING RESOURCE CTSpedia/StatToolsTopic054/favicon.ico" type="image/x-icon">
<link type="application/x-wiki" title="edit StatToolsTopic054" rel="alternate" href="StatToolsTopic054.html">
<meta name="description" content="StatToolsTopic054" />
	 <!--[if IE]></base><![endif]-->
<link media="all" type="text/css" rel="stylesheet" href="../System/SkinTemplates.attachments/base.css">
<link media="all" type="text/css" href="../System/SkinTemplates.attachments/default.css" rel="stylesheet">
<!--[if IE]><style type="text/css" media="screen">
pre {
	overflow-x:auto;
	padding-bottom:expression(this.scrollWidth > this.offsetWidth ? 16 : 0);
}
</style>
<![endif]-->

<link class="head SMILIESPLUGIN" href="../System/SmiliesPlugin.attachments/smilies.css" rel="stylesheet" media="all" type="text/css"><!--SMILIESPLUGIN-->
<script class="script JQUERYPLUGIN" src="../System/JQueryPlugin.attachments/jquery-2.2.4.js"></script><!--JQUERYPLUGIN-->
<script class="script JQUERYPLUGIN::OBSERVER" src="../System/JQueryPlugin.attachments/plugins/observer/observer.js?version=0.1"></script><!--JQUERYPLUGIN::OBSERVER-->
<script src="../System/JQueryPlugin.attachments/plugins/migrate/jquery.migrate.js?version=3.3.1" class="script JQUERYPLUGIN::MIGRATE"></script><!--JQUERYPLUGIN::MIGRATE-->
<script class="script JQUERYPLUGIN::FOSWIKI" src="../System/JQueryPlugin.attachments/plugins/foswiki/jquery.foswiki.js?version=3.01"></script><!--JQUERYPLUGIN::FOSWIKI-->
<script src="../System/JQueryPlugin.attachments/plugins/browser/jquery.browser.js?version=0.1.0" class="script JQUERYPLUGIN::BROWSER"></script><!--JQUERYPLUGIN::BROWSER-->
<script class='script JQUERYPLUGIN::FOSWIKI::PREFERENCES foswikiPreferences' type='text/json'>{
   "COOKIEREALM" : "",
   "TOPIC" : "StatToolsTopic054",
   "SERVERTIME" : "16 Feb 2023 - 10:32",
   "SKIN" : "natedit,pattern",
   "PUBURLPATH" : "/foswiki/pub",
   "WIKIUSERNAME" : "Main.AdminUser",
   "USERSWEB" : "Main",
   "SCRIPTURLPATHS" : {},
   "PUBURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/pub",
   "URLHOST" : "http://biostat1478.dhcp.mc.vanderbilt.edu",
   "SYSTEMWEB" : "System",
   "NAMEFILTER" : "[\\\\\\s*?~^$@%`\"'&|<:;>\\[\\]#\\x00-\\x1f]",
   "WEB" : "CTSpedia",
   "SCRIPTSUFFIX" : "",
   "SCRIPTURLPATH" : "/foswiki/bin",
   "SCRIPTURL" : "http://biostat1478.dhcp.mc.vanderbilt.edu/foswiki/bin",
   "USERNAME" : "admin",
   "WIKINAME" : "AdminUser"
}
</script><!--JQUERYPLUGIN::FOSWIKI::PREFERENCES-->

</head> 
<body class="foswikiNoJs  foswikiHasChangePermission foswikiLoggedIn"><div class="foswikiPage">
<span id="PageTop"></span> <div class="foswikiMain"><h1></h1><a href="StatToolsHome.html">Return to Stat Tools Home</a>
<p></p>
<h1 id="Title:_Example_Testing_SAS_Format">  Title: Example Testing SAS Format </h1>
<p></p>
<h2 id="Evaluate_this_tool_by_clicking_on_the_stars:">  Evaluate this tool by clicking on the stars: </h2>
<p></p> <ul>
<li> 5 stars = highest rating
</li> <li> 1 star = lowest
</li> <li> SCORE = average of all votes
</li></ul> 
%VOTE{id="EvalStatTools" stars1="Tools Overall Rating" stars2="Code Works Well" stars3="Good Instructions" global="off" open="off" secret="off" format="| $key | $small<br /><small>Score: $score, My vote: $mylast, Total votes: $sum</small> |" }%
<p></p>
<h2 id="Add_Comments_and_then_click_on_34Add_comment_34_button">  Add Comments and then click on "Add comment" button </h2>
<h4 id="Please_note_any_errors_found_in_the_macros.">  Please note any errors found in the macros. </h4>
<p></p>
%COMMENT%
<p></p>
<span id="TopicEnd"></span>
<div class="foswikiForm foswikiFormStep"><h3> <a href="StatToolsForm.html">StatToolsForm</a> <span class='foswikiSmall'><a href="StatToolsTopic054.html">edit</a></span></h3><table class='foswikiFormTable' border='1' summary='Form data'><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Type of Tool</strong> </td><td> SAS Macro </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Title</strong> </td><td> Example Testing SAS Formats </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Programmer/Email</strong> </td><td> Rochester </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Contributing Site</strong> </td><td> Rochester </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Description</strong> </td><td> Here is an example of attaching the code or cut and pasting the code directly into the form. </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Example</strong> </td><td> Example code </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Classification Graph Type</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>References</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Datasets</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Data</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Software Program</strong> </td><td> SAS </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Software</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Macro Parameters</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>R-Code - Attachment</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>R-Code</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>SAS-Code - Attachment</strong> </td><td> <a href="https://www.ctspedia.org/wiki/pub/CTSpedia/StatToolsTopic054/Rochester_EGTesting_SASmainmacro.sas">Rochester_EGTesting_SASmainmacro</a> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>SAS-Code</strong> </td><td> * Macro logistic invokes SAS proc logistic and organizes the output.  It has options for automatic creation of quartile<br />  variables and/or quadratic variables.<br />  The macro parameters are:<br /><br />   DSName       = name of SAS data set<br />   Outcome      = name of outcome variable.  This variable is assumed to be coded 0, 1 and the model predicts the<br />                  probability of a 1 outcome.<br />   Predictors   = list of predictor variables. This list should include class variables and variables to be 'quartiled.'<br />				      Interaction variables may be included in which case the predictor list should be quoted, e.g.<br />				      Predictors = %quote(Age Gender Age*Gender).  Note: all variables appearing in interaction terms<br />				      should also appear as main effects. <br />   Classvar     = classification variables with reference level.  Use %quote function.  For example,<br />                  Classvar=%quote(Gender(ref='Male')Race(ref='Asian'))  Gender and Race could be numeric variables with<br />                  formatted values of Male or Asian or they could be alphanumeric variables with string values of 'Male'<br />                  and 'Asian'.  Do not include variables for which quartiles are to be generated.<br />   Quartiles    = list of numeric variables which should be entered into the model as class variables with four quartile<br />                  levels. Variables in this list will not be included in the model as linear predictors.<br />   Quad         = Y/N for creating and testing quadratic terms (default = Y)<br />   Out          = name of output SAS data set containing logistic estimates, p-values, etc.<br />   Print        = Y/N (default = N)<br />   Include      = F,P,FP,or N<br />                  F = frequencies of outcome variable are displayed for each class variable value, e.g., Sex Female 31/100<br />                  P = percentages are displayed with class variable values, e.g., Sex Female 31.0%<br />                  FP = frequencies and percentages are displayed with class variable values, e.g., Sex Female  31/100 (31.0%).<br />                  N = no frequencies or percentages are displayed with class variable values (default = FP)<br />   Obs          = Y/N  If Y, then the number of observations in each outcome group and the total are displayed. (default = Y)<br />   LL           = Y/N  If Y, then -2log(likelihood) is displayed. (default = N)<br />   HL           = Y/N  If Y, then the Hosmer-Lemeshow p-value is displayed along with the number of groups of estimates<br />                  (default = N).<br /><br />Special features:<br />   The macro will automatically test a quadratic term for numeric (non-class) predictors with more than two values.<br />   The macro will automatically output odds ratios that have been rescaled until the units &gt; 1/10 of the IQR.<br /><br />The macros called by this macro are %words, %checkvar, %univariate, and %quartiles.  The global macro <em>Model<br />is incremented by one with each call to the logistic macro.  The model number is printed and/or saved to the output file.<br />To reset the model counter to start at one, use the command: [percent sign]Let _Model = 0;<br /><br />filename words URL "http://ctspedia.org/twiki/pub/CTSpedia/UtilityMacros/words.sas";<br />%include words;<br />filename chkvar URL "http://ctspedia.org/twiki/pub/CTSpedia/UtilityMacros/CheckVar.sas";<br />%include chkvar;<br />filename quart URL "http://ctspedia.org/twiki/pub/CTSpedia/UtilityMacros/quartiles.sas";<br />%include quart;<br />filename univar URL "http://ctspedia.org/twiki/pub/CTSpedia/UtilityMacros/Univariate.sas";<br />%include univar;<br /><br /><br />%macro logistic(DSName=,Outcome=,Predictors=,ClassVar=,Quartiles=,Quad=Y,Out=,Print=N,Include=FP,Obs=Y,LL=N,HL=N);<br /><br />   %Local AFormat <a href="BadOutcome.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">BadOutcome</a> <a class="foswikiNewLink" href="ClassVariables.html" rel="nofollow" title="Create this topic">ClassVariables</a> Flag Has0 Has1 I J K L <a rel="nofollow" href="MaxAfter.html" class="foswikiNewLink" title="Create this topic">MaxAfter</a> <a class="foswikiNewLink" href="MaxBefore.html" rel="nofollow" title="Create this topic">MaxBefore</a> NAst NClass <a title="Create this topic" href="NextVar.html" rel="nofollow" class="foswikiNewLink">NextVar</a> NInt NPred NQuart<br />          <a rel="nofollow" href="NNumVars.html" class="foswikiNewLink" title="Create this topic">NNumVars</a> <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="NumVars.html">NumVars</a> <a title="Create this topic" href="NNumVars2.html" rel="nofollow" class="foswikiNewLink">NNumVars2</a> NObs <a rel="nofollow" href="NumVars2.html" class="foswikiNewLink" title="Create this topic">NumVars2</a> Status <a class="foswikiNewLink" href="TempVars.html" rel="nofollow" title="Create this topic">TempVars</a> <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="TestVar.html">TestVar</a> <a href="ThisVar.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ThisVar</a> Unique Var <a title="Create this topic" rel="nofollow" href="VarList.html" class="foswikiNewLink">VarList</a> <a title="Create this topic" rel="nofollow" href="VarName.html" class="foswikiNewLink">VarName</a> <a title="Create this topic" href="VarType.html" rel="nofollow" class="foswikiNewLink">VarType</a> ;<br /><br />   %Global  _ClassVar _ClassVariables _Error _Model;<br /><br />   <strong>Make sure just one leading and trailing blank and replace multiple blanks with single blanks in all lists.<br />    Convert all text to uppercase;<br />   %Let Predictors = %str( )%upcase(%cmpres(&amp;Predictors))%str( );<br />   %Let Quartiles = %str( )%upcase(%cmpres(&amp;Quartiles))%str( );<br />   %Let NQuart = %words(&amp;Quartiles);<br />   %Let Include = %upcase(&amp;Include);<br />   %Let LL = %upcase(&amp;LL);<br />   %Let HL = %upcase(&amp;HL);<br />   %Let Print = %upcase(&amp;Print);<br />   %Let Quad = %upcase(&amp;Quad);<br />   %Let Obs = %upcase(&amp;Obs);<br /><br />	* Look for interactions and make sure asterisks have one blank on each side;<br />	%Let <a title="Create this topic" href="TempVars.html" rel="nofollow" class="foswikiNewLink">TempVars</a> = &Predictors;<br />	%Let Predictors = ;<br />	%Let NAst = 0;											* number of asterisks in predictor list;<br />	%do %while(%index(&amp;TempVars,%str(</strong>)) &gt; 0);<br />		%Let K = %index(&amp;TempVars,%str(<strong>));<br />		%Let NAst = %eval(&amp;NAst + 1);<br />		%Let Predictors = &amp;Predictors %substr(&amp;TempVars,1,%eval(&amp;K-1))%str( )%str(</strong>)%str( );<br />		%Let <a class="foswikiNewLink" href="TempVars.html" rel="nofollow" title="Create this topic">TempVars</a> = %substr(&amp;TempVars,%eval(&amp;K+1));<br />	%end;<br />	%Let Predictors = &amp;Predictors &TempVars;<br />	%Let Predictors = %str( )%cmpres(&amp;Predictors)%str( );<br />	%Let NPred = %words(&amp;Predictors);						* This will count 3 predictors for Age * Sex;<br /><br />   <strong>Create a list of class variable names in <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ClassVariables.html">ClassVariables</a>;<br />   %Let <a href="ClassVariables.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ClassVariables</a> <code>;<br /> &nbsp; %Let <a rel="nofollow" href="TempVars.html" class="foswikiNewLink" title="Create this topic">TempVars</a> = %upcase(&amp;ClassVar)%str( ); &nbsp; * Make a copy that can be modified. Then remove reference values spece.;<br /> &nbsp; %do %while(%index(&amp;TempVars,%str(%()) &gt; 0);<br />&nbsp; &nbsp; &nbsp; %Let K = %index(&amp;TempVars,%str(%());<br />&nbsp; &nbsp; &nbsp; %Let L = %index(&amp;TempVars,%str(%)));<br />&nbsp; &nbsp; &nbsp; %if &amp;L = 0 %then<br /> &nbsp; &nbsp; &nbsp; &nbsp; %do;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %put;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %put Error: Unbalanced parens in classvar parameter.;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %put;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %goto <a title="Create this topic" rel="nofollow" href="ExitLogistic.html" class="foswikiNewLink">ExitLogistic</a>;<br /> &nbsp; &nbsp; &nbsp; &nbsp; %end;<br />&nbsp; &nbsp; &nbsp; %else<br /> &nbsp; &nbsp; &nbsp; &nbsp; %do;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let <a class="foswikiNewLink" href="TempVars.html" rel="nofollow" title="Create this topic">TempVars</a> = %substr(&amp;TempVars,1,%eval(&amp;K-1))%str( )%substr(&amp;TempVars,%eval(&amp;L+1));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let <a title="Create this topic" class="foswikiNewLink" href="TempVars.html" rel="nofollow">TempVars</a> = %cmpres(&amp;TempVars)%str( );<br /> &nbsp; &nbsp; &nbsp; &nbsp; %end;<br /> &nbsp; %end;<br /> &nbsp; %Let Flag = 0; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * Flag = 1 indicates we have all the class variables;<br /> &nbsp; %Let <a class="foswikiNewLink" rel="nofollow" href="TempVars.html" title="Create this topic">TempVars</a> = %cmpres(&amp;TempVars)%str( );<br /> &nbsp; <br /> &nbsp; %do %while(&amp;Flag = 0);<br />&nbsp; &nbsp; &nbsp; %Let K = %Index(&amp;TempVars,%str( ));&nbsp; &nbsp; * look for a blank;<br />&nbsp; &nbsp; &nbsp; %if &amp;K = 0 or &amp;K &gt; %length(&amp;TempVars) %then<br /> &nbsp; &nbsp; &nbsp; &nbsp; %do;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let Flag = 1;<br /> &nbsp; &nbsp; &nbsp; &nbsp; %end;<br />&nbsp; &nbsp; &nbsp; %else<br /> &nbsp; &nbsp; &nbsp; &nbsp; %do;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %if &amp;K &gt; 1 %then<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %do;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let <a title="Create this topic" class="foswikiNewLink" href="VarName.html" rel="nofollow">VarName</a> = %substr(&amp;TempVars,1,%eval(&amp;K-1));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let <a title="Create this topic" rel="nofollow" href="ClassVariables.html" class="foswikiNewLink">ClassVariables</a> = &amp;ClassVariables%str( )&VarName;<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %end;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let K = %eval(&amp;K+1);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %if &amp;K &lt;</code> %length(&amp;TempVars) %then<br />               %do;<br />                  %Let <a title="Create this topic" href="TempVars.html" rel="nofollow" class="foswikiNewLink">TempVars</a> = %substr(&amp;TempVars,&amp;K);  * Delete this portion of <a title="Create this topic" href="TempVars.html" rel="nofollow" class="foswikiNewLink">TempVars</a>;<br />                  %Let <a rel="nofollow" href="TempVars.html" class="foswikiNewLink" title="Create this topic">TempVars</a> = %cmpres(&amp;TempVars)%str( );<br />               %end;<br />            %else %Let <a rel="nofollow" href="TempVars.html" class="foswikiNewLink" title="Create this topic">TempVars</a>=;<br />         %end;<br /><br />   %end;<br />   %Let <a rel="nofollow" href="ClassVariables.html" class="foswikiNewLink" title="Create this topic">ClassVariables</a> = %str( )%cmpres(&amp;ClassVariables)%str( );<br />   %Let NClass = %words(&amp;ClassVariables);<br /><br />	* Create a list of unique variable names in the predictor list;<br />	%Let Unique <code>;<br /> &nbsp; %do i = 1 %to &NPred;<br />&nbsp; &nbsp; &nbsp; %Let <a title="Create this topic" href="ThisVar.html" rel="nofollow" class="foswikiNewLink">ThisVar</a> = %scan(&amp;Predictors,&amp;i);<br />&nbsp; &nbsp; &nbsp; %Let K = %index(&amp;Unique,%str( )&amp;ThisVar%str( ));<br />&nbsp; &nbsp; &nbsp; %if &amp;K = 0 %then<br /> &nbsp; &nbsp; &nbsp; &nbsp; %do;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %Let Unique = &amp;Unique%str( )&amp;ThisVar%str( );<br /> &nbsp; &nbsp; &nbsp; &nbsp; %end;<br /> &nbsp; %end;<br /> &nbsp; * Check that the outcome and all variables in the predictor list are in the data set;<br /> &nbsp; %Let <a rel="nofollow" href="VarList.html" class="foswikiNewLink" title="Create this topic">VarList</a> = %upcase(%cmpres(&amp;Outcome%str( )&amp;unique));<br /> &nbsp; %CheckVar(CVDsname=&amp;DSName,CVVars=&amp;Varlist,Message=Y);<br /> &nbsp; %if &amp;_Error = 1 %then %goto <a rel="nofollow" href="ExitLogistic.html" class="foswikiNewLink" title="Create this topic">ExitLogistic</a>;<br /><br /> &nbsp; * Check that outcome is not in the predictor list;<br /> &nbsp; %if %index(%str( )%upcase(&amp;Predictors)%str( ),%str( )%upcase(&amp;Outcome)%str( )) &gt; 0 %then<br />&nbsp; &nbsp; &nbsp; %do;<br /> &nbsp; &nbsp; &nbsp; &nbsp; %put;<br /> &nbsp; &nbsp; &nbsp; &nbsp; %put Error: Outcome variable cannot be in the list of predictors.;<br /> &nbsp; &nbsp; &nbsp; &nbsp; %put;<br /> &nbsp; &nbsp; &nbsp; &nbsp; %goto <a title="Create this topic" rel="nofollow" href="ExitLogistic.html" class="foswikiNewLink">ExitLogistic</a>;<br />&nbsp; &nbsp; &nbsp; %end;<br /><br /> &nbsp; * Check that variables in the <a title="Create this topic" href="ClassVariables.html" rel="nofollow" class="foswikiNewLink">ClassVariables</a> and Quartiles lists are all in the Predictor list;<br /> &nbsp; %Let <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="VarList.html">VarList</a> = %str( )%cmpres(&amp;ClassVariables &amp;Quartiles)%str( );<br /> &nbsp; %do i = 1 %to %words(&amp;Varlist);<br />&nbsp; &nbsp; &nbsp; %Let <a rel="nofollow" href="TestVar.html" class="foswikiNewLink" title="Create this topic">TestVar</a> = %scan(&amp;Varlist,&amp;i);<br />&nbsp; &nbsp; &nbsp; %Let K</code> %Index(&amp;Predictors,%str( )&amp;TestVar%str( ));<br />      %if &amp;K = 0 %then<br />         %do;<br />            %put;<br />            %put Error: Variable &amp;TestVar is not in the list of predictors.;<br />            %put;<br />            %goto <a title="Create this topic" rel="nofollow" href="ExitLogistic.html" class="foswikiNewLink">ExitLogistic</a>;<br />         %end;<br />   %end;<br /><br />   * Check that variables in the predictor list that are not in <a title="Create this topic" href="ClassVariables.html" rel="nofollow" class="foswikiNewLink">ClassVariables</a> are in fact numeric. <br />	  Variables in main effects and interaction terms will be checked more than once, but that is ok;<br />   %do i = 1 %to %eval(&amp;NPred - &amp;NAst);<br />      %Let <a title="Create this topic" class="foswikiNewLink" href="TestVar.html" rel="nofollow">TestVar</a> = %scan(&amp;Predictors,&amp;i);	<br />	   %Let K = %Index(&amp;ClassVariables,%str( )&amp;TestVar%str( ));<br />      %if &amp;K = 0 %then<br />         %do;<br />            data _null</em>;<br />               set &amp;dsname (obs = 1);<br />               <a title="Create this topic" class="foswikiNewLink" href="VarType.html" rel="nofollow">VarType</a> = Vtype(&amp;TestVar);<br />               call symput('VarType',VarType);<br />            run;<br />            %if &amp;VarType ne N %then<br />               %do;<br />                  %put;<br />                  %put Error: Variable &amp;TestVar is not numeric and is not in the list of class variables.;<br />                  %put;<br />                  %goto <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ExitLogistic.html">ExitLogistic</a>;<br />               %end;<br />         %end;<br />    %end;<br />	<br />   * Create a a series of macro variables <em>LogDV1,_LogDV2,...,_LogDV&amp;NPred that will be 1 if that numeric variable is a date variable<br />     otherwise 0.;<br />   data _null</em>;<br />      set &amp;dsname (obs = 1);<br />      %do i = 1 %to %eval(&amp;NPred - &amp;NAst);<br />         %Let <a title="Create this topic" rel="nofollow" href="ThisVar.html" class="foswikiNewLink">ThisVar</a> = %scan(&amp;Predictors,&amp;i);<br />         Fmt = <a title="Create this topic" rel="nofollow" href="VFormatN.html" class="foswikiNewLink">VFormatN</a>(&amp;ThisVar);<br />			Call Symput("_LogDV&amp;I",0);<br />         if Fmt in('DATE','NENGO','DDMMYY','JULIAN','MMDDYY','YYMMDD','WEEKDATE','WEEKDATX','WORDDATE','WORDDATX') then Call Symput("_LogDV&amp;I",1);<br />      %end;<br />   run;<br />		<br />   * Create dataset <em>nomiss that eliminates all observations with any missing data on the predictors or the outcome.<br />     Also check that the outcome variable has only values of 0 and 1 (and at least one of each).;<br />   data _nomiss;<br />      set &amp;dsname (Keep = &amp;Outcome &amp;Unique) end = done;       * Keep only the needed variables for efficiency;<br />      if _n</em> = 1 then<br />         do;<br />            <em>Outcome0 = 0;<br />            _Outcome1 = 0;<br />            _BadOutcome = 0;<br />         end;<br />      retain _Outcome0 _Outcome1 _BadOutcome;<br />      <a title="Create this topic" rel="nofollow" href="AnyMissing.html" class="foswikiNewLink">AnyMissing</a> = 0;<br />      if missing(&amp;Outcome) then <a title="Create this topic" href="AnyMissing.html" rel="nofollow" class="foswikiNewLink">AnyMissing</a> = 1;          * Missing() returns 1 if either a character or numeric var is missing;<br />      %do i = 1 %to %eval(&amp;NPred - &amp;NAst);<br />         %Let <a href="ThisVar.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ThisVar</a> = %scan(&amp;Predictors,&amp;i);<br />         if missing(&amp;ThisVar) then <a title="Create this topic" href="AnyMissing.html" rel="nofollow" class="foswikiNewLink">AnyMissing</a> = 1;<br />      %end;<br />      if <a title="Create this topic" rel="nofollow" href="AnyMissing.html" class="foswikiNewLink">AnyMissing</a> Then Delete;<br />      if &amp;Outcome = 0 then _Outcome0 = _Outcome0 + 1;<br />      if &amp;Outcome = 1 then _Outcome1 = _Outcome1 + 1;<br />      if &amp;Outcome ne 0 and &amp;Outcome ne 1 then _BadOutcome = 1;<br />      if done then<br />         do;<br />            call symput('BadOutcome',_BadOutcome);<br />            call symput('Has0',_Outcome0);<br />            call symput('Has1',_Outcome1);<br />         end;<br />   run;<br />   %if &amp;BadOutcome = 1 %then<br />      %do;<br />         %put;<br />         %put Error: Outcome variable &amp;Outcome has nonmissing values other than 0 and 1;<br />         %put<br />         %goto <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ExitLogistic.html">ExitLogistic</a>;<br />      %end;<br />   %if &amp;Has0 = 0 %then<br />      %do;<br />         %put;<br />         %put Error: Outcome variable &amp;Outcome has no zeros;<br />         %put;<br />         %goto <a class="foswikiNewLink" href="ExitLogistic.html" rel="nofollow" title="Create this topic">ExitLogistic</a>;<br />      %end;<br />   %if &amp;Has1 = 0 %then<br />      %do;<br />         %put;<br />         %put Error: Outcome variable &amp;Outcome has no ones;<br />         %put;<br />         %goto <a class="foswikiNewLink" href="ExitLogistic.html" rel="nofollow" title="Create this topic">ExitLogistic</a>;<br />      %end;<br />	<br />   * Create a list of numeric predictors that are not class or quartile variables;<br />   %Let <a href="VarList.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">VarList</a> = %str( )%cmpres(&amp;ClassVariables &amp;Quartiles)%str( );<br />   %Let <a rel="nofollow" href="NumVars.html" class="foswikiNewLink" title="Create this topic">NumVars</a> =;<br />   %do i = 1 %to %words(&amp;unique);<br />      %Let <a rel="nofollow" href="ThisVar.html" class="foswikiNewLink" title="Create this topic">ThisVar</a> = %scan(&amp;unique,&amp;i);<br />      %Let K = %Index(&amp;VarList,%str( )&amp;ThisVar%str( ));<br />      %if &amp;K = 0 %then<br />         %do;<br />            %Let <a title="Create this topic" href="NumVars.html" rel="nofollow" class="foswikiNewLink">NumVars</a> = &amp;NumVars%str( )&ThisVar;<br />         %end;<br />   %end;<br />   %Let <a title="Create this topic" href="NumVars.html" rel="nofollow" class="foswikiNewLink">NumVars</a> = %str( )%cmpres(&amp;NumVars)%str( );<br />   %Let <a class="foswikiNewLink" rel="nofollow" href="NNumVars.html" title="Create this topic">NNumVars</a> = %words(&amp;NumVars);<br /><br />   * Check that each of these numeric predictors has more than two levels.<br />     Put numeric variables with more than two levels into &NumVars2;<br />   %Let <a title="Create this topic" class="foswikiNewLink" href="NumVars2.html" rel="nofollow">NumVars2</a> =;<br />   %if &amp;NNumVars &gt; 0 %then<br />      %do i = 1 %to &NNumVars;<br />         %Let <a class="foswikiNewLink" href="ThisVar.html" rel="nofollow" title="Create this topic">ThisVar</a> = %scan(&amp;NumVars,&amp;i);<br />         proc freq noprint data = _nomiss; tables &amp;ThisVar/out=_counts;<br />         run;<br />         data _null</em>;<br />            set <em>counts (obs = 1) nobs = last;<br />            call symput('NObs',Last);<br />         run;<br />         %if &amp;NObs &gt; 2 %then %Let <a href="NumVars2.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">NumVars2</a> = &amp;Numvars2%str( )&ThisVar;<br />      %end;<br />   %Let <a rel="nofollow" href="NumVars2.html" class="foswikiNewLink" title="Create this topic">NumVars2</a> = %str( )%cmpres(&amp;NumVars2)%str( );<br />   %Let <a title="Create this topic" rel="nofollow" href="NNumVars2.html" class="foswikiNewLink">NNumVars2</a> = %words(&amp;NumVars2);<br /><br />   * Create squared variables for all variables in <a class="foswikiNewLink" rel="nofollow" href="NumVars2.html" title="Create this topic">NumVars2</a>;<br />   %if <a rel="nofollow" href="NNumVars2.html" class="foswikiNewLink" title="Create this topic">NNumVars2</a> &gt; 0 and &amp;Quad = Y %then<br />      %do;<br />         data _nomiss;<br />            set _nomiss;<br />            %do i = 1 %to &NNumVars2;<br />               %Let <a title="Create this topic" rel="nofollow" href="ThisVar.html" class="foswikiNewLink">ThisVar</a> = %scan(&amp;NumVars2,&amp;i);<br />               _&amp;ThisVar.2 = &amp;ThisVar * &ThisVar;<br />            %end;<br />         run;<br />      %end;<br /><br />   * Create quartile variables and add them to the classvar and classvariables lists;<br />   %if &amp;NQuart &gt; 0 %then<br />      %do;<br />         %Let _ClassVar = &ClassVar;<br />         %Let _ClassVariables = &ClassVariables;<br />         %Quartiles(QDsname=_nomiss,QVars=&amp;Quartiles)<br />         %Let <a href="ClassVar.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ClassVar</a> =&_ClassVar;<br />         %Let <a title="Create this topic" href="ClassVariables.html" rel="nofollow" class="foswikiNewLink">ClassVariables</a> = &_ClassVariables;<br />      %end;<br /><br />   %Let NClass = %eval(&amp;NClass + &amp;NQuart);<br /><br />   * Now fit the basic model without quadratic terms;<br />   ods listing close;<br />   proc logistic data = _nomiss order = internal descending;<br />      %if %length(&amp;ClassVar)&gt; 0 %then %do; class &amp;classvar/param=ref order=internal desc; %end;<br />      model &amp;Outcome = &amp;Predictors/lackfit;<br />      ods output <a title="Create this topic" class="foswikiNewLink" href="ConvergenceStatus.html" rel="nofollow">ConvergenceStatus</a> = _cs;<br />      ods output <a class="foswikiNewLink" href="FitStatistics.html" rel="nofollow" title="Create this topic">FitStatistics</a> = _fs;<br />      ods output <a href="LackFitChiSq.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">LackFitChiSq</a> = _hl;<br />      ods output <a title="Create this topic" href="ParameterEstimates.html" rel="nofollow" class="foswikiNewLink">ParameterEstimates</a> = _pe;<br />      %if %length(&amp;Classvar) &gt; 0 %then %do; ods output Type3 = _t3; %end;<br />      ods output <a title="Create this topic" href="ResponseProfile.html" rel="nofollow" class="foswikiNewLink">ResponseProfile</a> = _rp;<br />   run;<br />	<br />   data _null</em>;<br />      set <em>cs;<br />      call symput('Status',Status);<br />   run;<br /><br />   * Get frequencies and percentages for class variables.  Do this even if Include = N so that we get the reference levels.;<br />   %if &amp;NClass &gt; 0 %then<br />      %do;<br />         proc datasets nolist; delete _allcounts; quit;<br />         %do i = 1 %to &NClass;<br />            %Let <a title="Create this topic" href="ThisVar.html" rel="nofollow" class="foswikiNewLink">ThisVar</a> = %scan(&amp;ClassVariables,&amp;i);<br />            proc freq data = _nomiss noprint; tables &amp;ThisVar * &amp;Outcome/out = _counts;<br />            proc sort data = _counts; by &amp;ThisVar &Outcome;<br />            data _null</em>;<br />               set <em>Counts (obs = 1);<br />               Call symput('AFormat',VFormat(&amp;ThisVar));<br />            run;<br />            data _counts2;       * reduce _counts to one obs per value of thisvar;<br />               set _counts (drop = percent); by &ThisVar;<br />               if first.&amp;ThisVar then Total = 0;<br />               retain Total;<br />               Total = Total + count;<br />               if last.&amp;ThisVar then<br />                  do;<br />                     Length Var $ 32 <a title="Create this topic" href="ClassVal0.html" rel="nofollow" class="foswikiNewLink">ClassVal0</a> $ 50 ;<br />                     Var = "&amp;ThisVar";<br />                     <a href="ClassVal0.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ClassVal0</a> = Trim(Left(Put(&amp;ThisVar,&amp;AFormat)));<br />                     Freq = count;<br />                     if &amp;Outcome = 0 then Freq = 0;                  * if last value of &amp;This var is 0 then no events;<br />                     if Total &gt; 0 then Percent = 100 * Freq / Total;<br />                     Keep Var <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ClassVal0.html">ClassVal0</a> Freq Percent Total;<br />                     output;<br />                  end;<br />            run;<br />            proc append base = _allcounts data = _counts2;<br />            run;<br />         %end;<br />         * Remember the order in _allcounts;<br />         data _allcounts;<br />            set _allcounts;<br />            Order = _n</em>;<br />         run;<br />         data <em>pe;               * remember original order of variables;<br />           set _pe;<br />           Length <a class="foswikiNewLink" href="PrevVar.html" rel="nofollow" title="Create this topic">PrevVar</a> $ 32;<br />           if _n</em> = 1 then <a rel="nofollow" href="OrderBetween.html" class="foswikiNewLink" title="Create this topic">OrderBetween</a> = 0;<br />           Retain <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderBetween.html">OrderBetween</a> <a class="foswikiNewLink" rel="nofollow" href="PrevVar.html" title="Create this topic">PrevVar</a>;<br />           if <em>n</em> = 1 or Variable ne <a class="foswikiNewLink" rel="nofollow" href="PrevVar.html" title="Create this topic">PrevVar</a> then <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderBetween.html">OrderBetween</a> = <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderBetween.html">OrderBetween</a> + 1;<br />           <a rel="nofollow" href="PrevVar.html" class="foswikiNewLink" title="Create this topic">PrevVar</a> = Variable;<br />           Length Var $ 32;<br />           Var = upcase(Variable);<br />         run;<br />         proc sort data = <em>pe; by var classval0;<br />         proc sort data = _allcounts; by var classval0;<br />         data _pe2 (drop = <a rel="nofollow" href="PrevVar.html" class="foswikiNewLink" title="Create this topic">PrevVar</a>);<br />            merge _pe _allcounts; by var classval0;<br />         run;<br />         proc sort data = _pe2; by Order;<br />         data _pe3 (drop = Order);<br />            set _pe2;<br />            Length <a rel="nofollow" href="FreqPct.html" class="foswikiNewLink" title="Create this topic">FreqPct</a> $ 40;<br />            if Freq ne . then<br />               do;<br />                  %if &amp;Include = F %then %do; <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> = trim(left(put(Freq,8.)))&#124;&#124;'/'&#124;&#124;trim(left(put(total,8.))); %end;<br />                  %if &amp;Include = P %then %do; <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> = Trim(left(put(percent,5.1)))&#124;&#124;'%'; %end;<br />                  %if &amp;Include = FP %then %do; <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> = trim(left(put(Freq,8.)))&#124;&#124;'/'&#124;&#124;trim(left(put(total,8.)))&#124;&#124;' ('&#124;&#124;trim(left(put(percent,5.1)))&#124;&#124;'%)'; %end;<br />						if index(Variable,'*') &gt; 0 then <a title="Create this topic" rel="nofollow" href="FreqPct.html" class="foswikiNewLink">FreqPct</a> = '';<br />               end;<br />         run;<br />			ods listing close;<br />         * If there are numeric predictors, then use <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> to hold the overall proportion (%) of events;<br />         %if &amp;NNumVars &gt; 0 %then<br />            %do;<br />               data _null</em>;<br />                  set <em>rp;<br />                  Length <a rel="nofollow" href="FreqPct.html" class="foswikiNewLink" title="Create this topic">FreqPct</a> $ 40;<br />                  if _n</em> = 1 then Freq = Count;<br />                  retain Freq;<br />                  if <em>n</em> = 2 then<br />                     do;<br />                        Percent = 100 * Freq / (Count + freq);<br />                        %if &amp;Include = F %then %do; <a title="Create this topic" class="foswikiNewLink" href="FreqPct.html" rel="nofollow">FreqPct</a> = trim(left(put(Freq,8.)))&#124;&#124;'/'&#124;&#124;(left(put(count+Freq,8.))); %end;<br />                        %if &amp;Include = P %then %do; <a title="Create this topic" rel="nofollow" href="FreqPct.html" class="foswikiNewLink">FreqPct</a> = trim(left(put(Percent,5.1)))&#124;&#124;'%'; %end;<br />                        %if &amp;Include = FP %then %do; <a class="foswikiNewLink" rel="nofollow" href="FreqPct.html" title="Create this topic">FreqPct</a> = trim(left(Put(Freq,8.)))&#124;&#124;'/'&#124;&#124;trim(left(put(count+freq,8.)))&#124;&#124;' ('&#124;&#124;trim(left(put(percent,5.1)))&#124;&#124;'%)'; %end;<br />                        call symput('Overall',FreqPct);<br />						   end;<br />               run;<br />					<br />               data <em>pe3;<br />                  set _pe3;<br />                  if <a rel="nofollow" href="FreqPct.html" class="foswikiNewLink" title="Create this topic">FreqPct</a> = '' and Var ne 'INTERCEPT' and index(var,'*') = 0 then <a title="Create this topic" href="FreqPct.html" rel="nofollow" class="foswikiNewLink">FreqPct</a> = "&amp;Overall";    * must be a numeric variable if freqpct is blank;<br />               run;<br /><br />            %end;<br />			<br />         * Create an order within each variable so the levels can later be sorted properly;<br />         proc sort data = _pe3; by Var;<br />         data _pe3;<br />            set _pe3; by Var;<br />            if first.Var then <a href="OrderWithin.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">OrderWithin</a> = 0;<br />            <a title="Create this topic" class="foswikiNewLink" href="OrderWithin.html" rel="nofollow">OrderWithin</a> = <a class="foswikiNewLink" href="OrderWithin.html" rel="nofollow" title="Create this topic">OrderWithin</a> + 1;<br />            Retain <a class="foswikiNewLink" href="OrderWithin.html" rel="nofollow" title="Create this topic">OrderWithin</a>;<br />         run;<br />         proc sort data = _pe3; by var descending <a href="OrderBetween.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">OrderBetween</a>;<br />         data _pe3 (drop = <a href="SaveOrderBetween.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">SaveOrderBetween</a> <a title="Create this topic" href="SaveVariable.html" rel="nofollow" class="foswikiNewLink">SaveVariable</a>);<br />            set _pe3; by var;<br />            Length <a title="Create this topic" class="foswikiNewLink" href="SaveVariable.html" rel="nofollow">SaveVariable</a> $ 32;<br />            if first.var then do; <a class="foswikiNewLink" href="SaveOrderBetween.html" rel="nofollow" title="Create this topic">SaveOrderBetween</a> = <a class="foswikiNewLink" rel="nofollow" href="OrderBetween.html" title="Create this topic">OrderBetween</a>; <a title="Create this topic" href="SaveVariable.html" rel="nofollow" class="foswikiNewLink">SaveVariable</a> = Variable; end;<br />            retain <a class="foswikiNewLink" rel="nofollow" href="SaveOrderBetween.html" title="Create this topic">SaveOrderBetween</a> <a title="Create this topic" rel="nofollow" href="SaveVariable.html" class="foswikiNewLink">SaveVariable</a>;<br />            if <a class="foswikiNewLink" href="OrderBetween.html" rel="nofollow" title="Create this topic">OrderBetween</a> = . then <a title="Create this topic" class="foswikiNewLink" href="OrderBetween.html" rel="nofollow">OrderBetween</a> = <a class="foswikiNewLink" rel="nofollow" href="SaveOrderBetween.html" title="Create this topic">SaveOrderBetween</a>;<br />            if Variable = '' then Variable = <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="SaveVariable.html">SaveVariable</a>;<br />            if df = . then df = 1;        * must be the reference category;<br />         run;<br />      %end;<br />   %else<br />      %do;<br />         data _pe3;<br />            set _pe;<br />            Length Var $ 32 <a rel="nofollow" href="FreqPct.html" class="foswikiNewLink" title="Create this topic">FreqPct</a> $ 40;<br />            <a rel="nofollow" href="FreqPct.html" class="foswikiNewLink" title="Create this topic">FreqPct</a> = '';<br />            Var = upcase(Variable);<br />            <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderBetween.html">OrderBetween</a> = _n</em>;<br />            <a title="Create this topic" href="OrderWithin.html" rel="nofollow" class="foswikiNewLink">OrderWithin</a> = 1;<br />         run;<br />      %end;<br />	<br />   * For numeric non-quartile variables, add quadratic term to model to get p-value for quadratic trend;<br />   %if &amp;NNumVars2 &gt; 0 %then<br />      %do;<br />         %if &amp;Quad = Y %then<br />            %do;<br />               proc datasets nolist; delete <em>allquad; quit;<br />               %do i = 1 %to &NNumVars2;<br />                  %Let <a title="Create this topic" rel="nofollow" href="ThisVar.html" class="foswikiNewLink">ThisVar</a> = %scan(&amp;NumVars2,&amp;i);<br />                  proc logistic data = _nomiss order = internal descending;<br />                     %if %length(&amp;ClassVar)&gt; 0 %then %do; class &amp;ClassVar/param=ref; %end;<br />                     model &amp;Outcome = &amp;Predictors _&amp;ThisVar.2;<br />                     ods output <a title="Create this topic" class="foswikiNewLink" href="ParameterEstimates.html" rel="nofollow">ParameterEstimates</a> = _pe</em>;<br />                  run;<br />                  data <em>oneline;<br />                     set _pe</em> (rename = (<a title="Create this topic" class="foswikiNewLink" href="ProbChisq.html" rel="nofollow">ProbChisq</a> = PQuad));<br />                     Length Var $ 32;<br />                     if Variable = "_&amp;ThisVar.2" then<br />                        do;<br />                           Var = "&amp;ThisVar";          * so we can merge back into <em>pe3;<br />                           Keep Var PQuad;<br />                           output;<br />                        end;<br />                  run;<br />                  proc append base = _allquad data = _oneline force;<br />                  run;<br />               %end;<br />               proc sort data = _allquad; by var;<br />               proc sort data = _pe3; by var;<br />            %end;<br />         %univariate(dsname=_nomiss,vars=&amp;NumVars2,Print=N,out=_irq)   * get q1 and q3 for possible rescalings;<br />         data _irq (Keep = Var IRQ);<br />            set _irq (keep = Variable q1 q3 rename = (Variable = Var));<br />            Var = upcase(var);<br />            IRQ = q3 - q1;<br />         run;<br />         proc sort data = _irq; by var;<br />			data _pe3;<br />			   merge _pe3 _irq; by var;<br />				if <a class="foswikiNewLink" href="OrderBetween.html" rel="nofollow" title="Create this topic">OrderBetween</a> &gt; 1 then <a title="Create this topic" href="IsDate.html" rel="nofollow" class="foswikiNewLink">IsDate</a> = input(Left(symget('_LogDV'&#124;&#124;left(trim(put(<a class="foswikiNewLink" href="OrderBetween.html" rel="nofollow" title="Create this topic">OrderBetween</a>-1,5.))))),1.);<br />			run;<br />         %if &amp;Quad = Y %then<br />            %do;<br />               data _pe3;<br />                  merge _pe3 _allquad; by var;<br />               run;<br />            %end;<br />         proc sort data = _pe3; by <a href="OrderBetween.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">OrderBetween</a> <a rel="nofollow" href="OrderWithin.html" class="foswikiNewLink" title="Create this topic">OrderWithin</a>;<br />         data _pe4;<br />            set _pe3 (rename = (Variable = <a title="Create this topic" href="OldVar.html" rel="nofollow" class="foswikiNewLink">OldVar</a>));<br />            Length Variable $ 50;<br />            Variable = <a title="Create this topic" rel="nofollow" href="OldVar.html" class="foswikiNewLink">OldVar</a>;<br />            Unit = 1;<br />            output;<br />            Count = 0;<br />            if IRQ ne . then<br />               do;<br />                  Length <a class="foswikiNewLink" rel="nofollow" href="BaseVar.html" title="Create this topic">BaseVar</a> $ 32;<br />                  <a class="foswikiNewLink" href="BaseVar.html" rel="nofollow" title="Create this topic">BaseVar</a> = Variable;<br />                  do while(Unit &lt; .1 * IRQ and Count &lt; 2);<br />                     Count = Count + 1;<br />							if <a title="Create this topic" rel="nofollow" href="IsDate.html" class="foswikiNewLink">IsDate</a> = 0 then<br />								do;<br />                     		Unit = 10 * Unit;<br />                     		Estimate = 10 * Estimate;<br />                     		<a href="StdErr.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">StdErr</a> = 10 * <a href="StdErr.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">StdErr</a>;<br />									Variable = trim(left(<a href="BaseVar.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">BaseVar</a>))&#124;&#124;' (per '&#124;&#124;trim(left(put(Unit,8.)))&#124;&#124;' units)';<br />								end;<br />							else<br />								do;<br />									if Unit = 1 then <a href="NewUnit.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">NewUnit</a> = 30;<br />									if Unit = 30 then <a class="foswikiNewLink" rel="nofollow" href="NewUnit.html" title="Create this topic">NewUnit</a> = 365;<br />									if Unit = 365 then <a class="foswikiNewLink" href="NewUnit.html" rel="nofollow" title="Create this topic">NewUnit</a> = 3650;<br />									Unit = <a class="foswikiNewLink" href="NewUnit.html" rel="nofollow" title="Create this topic">NewUnit</a>;<br />									Estimate = Unit * Estimate;<br />									<a href="StdErr.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">StdErr</a> = Unit * <a title="Create this topic" rel="nofollow" href="StdErr.html" class="foswikiNewLink">StdErr</a>;<br />									if Unit = 30 then Variable = trim(left(<a rel="nofollow" href="BaseVar.html" class="foswikiNewLink" title="Create this topic">BaseVar</a>))&#124;&#124;' (per month)';<br />									if Unit = 365 then Variable = trim(left(<a class="foswikiNewLink" rel="nofollow" href="BaseVar.html" title="Create this topic">BaseVar</a>))&#124;&#124;' (per year)';<br />									if Unit = 3650 then Variable = trim(left(<a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="BaseVar.html">BaseVar</a>))&#124;&#124;' (per decade)';<br />								end;<br />                     <a title="Create this topic" href="ProbChiSq.html" rel="nofollow" class="foswikiNewLink">ProbChiSq</a> = .;<br />                     %if &amp;Quad = Y %then %do; PQuad = .; %end;<br />                     <a class="foswikiNewLink" href="OrderWithin.html" rel="nofollow" title="Create this topic">OrderWithin</a> = <a title="Create this topic" rel="nofollow" href="OrderWithin.html" class="foswikiNewLink">OrderWithin</a> + 0.1;<br /><br />                     <a href="FreqPct.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">FreqPct</a> = '';<br />                     output;<br />                  end;<br /><br />                  Unit = 1;<br />                  do while (Unit &gt; 10 * IRQ and Count &lt; 2);<br />                     Count = Count + 1;<br />                     Unit = Unit / 10;<br />                     Estimate = Estimate / 10;<br />                     <a rel="nofollow" href="StdErr.html" class="foswikiNewLink" title="Create this topic">StdErr</a> = <a class="foswikiNewLink" href="StdErr.html" rel="nofollow" title="Create this topic">StdErr</a> / 10;<br />                     <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ProbChiSq.html">ProbChiSq</a> = .;<br />                     %if &amp;Quad = Y %then %do; PQuad = .; %end;<br />                     <a class="foswikiNewLink" rel="nofollow" href="OrderWithin.html" title="Create this topic">OrderWithin</a> = <a class="foswikiNewLink" href="OrderWithin.html" rel="nofollow" title="Create this topic">OrderWithin</a> + 0.1;<br />                     Variable = trim(Left(<a title="Create this topic" class="foswikiNewLink" href="BaseVar.html" rel="nofollow">BaseVar</a>))&#124;&#124;' (per '&#124;&#124;trim(left(put(Unit,10.2)))&#124;&#124;' units)';<br />                     <a title="Create this topic" class="foswikiNewLink" href="FreqPct.html" rel="nofollow">FreqPct</a> = '';<br />                     output;<br />                  end;<br /><br />               end;<br /><br />      %end;<br />   %else<br />      %do;<br />         data _pe4;<br />            set _pe3 (rename = (Variable = <a title="Create this topic" href="OldVar.html" rel="nofollow" class="foswikiNewLink">OldVar</a>));<br />            Length Variable $ 50;<br />            Variable = <a class="foswikiNewLink" rel="nofollow" href="OldVar.html" title="Create this topic">OldVar</a>;<br />            Unit = .;<br />         run;<br />      %end;<br />   * Merge in Type 3 p-values.  Convert Estimates to Odds Ratios;<br />   %if %length(&amp;ClassVar) &gt; 0 %then<br />      %do;<br />         data _t3;<br />            set _t3 (rename = (Effect = <a rel="nofollow" href="OldVar.html" class="foswikiNewLink" title="Create this topic">OldVar</a> <a title="Create this topic" href="ProbChisq.html" rel="nofollow" class="foswikiNewLink">ProbChisq</a> = PType3 DF = DF3));<br />         run;<br />         proc sort data = _t3; by <a title="Create this topic" rel="nofollow" href="OldVar.html" class="foswikiNewLink">OldVar</a>;<br />         proc sort data = _pe4; by <a class="foswikiNewLink" href="OldVar.html" rel="nofollow" title="Create this topic">OldVar</a>;<br />         data _pe4 (drop = DF3);<br />            merge _pe4 _t3; by <a class="foswikiNewLink" rel="nofollow" href="OldVar.html" title="Create this topic">OldVar</a>;<br />            if not(first.OldVar) or df3 = 1 then PType3 = .;<br />            <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = .;<br />            <a class="foswikiNewLink" rel="nofollow" href="LowerCL.html" title="Create this topic">LowerCL</a> = .;<br />            <a title="Create this topic" rel="nofollow" href="UpperCL.html" class="foswikiNewLink">UpperCL</a> = .;<br />            if Estimate = . then <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = 1; else<br />               do;<br />                  if Estimate <25 then <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = exp(Estimate);&lt;br />                  X1 = Estimate - 1.96 * <a title="Create this topic" rel="nofollow" href="StdErr.html" class="foswikiNewLink">StdErr</a>;<br />                  X2 = Estimate + 1.96 * <a title="Create this topic" rel="nofollow" href="StdErr.html" class="foswikiNewLink">StdErr</a>;<br />                  if <a rel="nofollow" href="StdErr.html" class="foswikiNewLink" title="Create this topic">StdErr</a> ne . then<br />                     do;<br />                        if X1 &lt; 25 then <a title="Create this topic" href="LowerCL.html" rel="nofollow" class="foswikiNewLink">LowerCL</a> = exp(X1);<br />                        if X2 &lt; 25 then <a title="Create this topic" href="UpperCL.html" rel="nofollow" class="foswikiNewLink">UpperCL</a> = exp(X2);<br />                     end;<br />               end;<br />            if Percent in(0,100) then <a href="ProbChiSq.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ProbChiSq</a> = .;<br />            ;<br />         run;<br />      %end;<br />   %else<br />      %do;<br />         data _pe4;<br />            set _pe4;<br />            <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = .;<br />            <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="LowerCL.html">LowerCL</a> = .;<br />            <a title="Create this topic" href="UpperCL.html" rel="nofollow" class="foswikiNewLink">UpperCL</a> = .;<br />            if Estimate = . then <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = 1; else<br />               do;<br />                  if Estimate &lt; 25 then <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = exp(Estimate);<br />                  X1 = Estimate - 1.96 * <a title="Create this topic" class="foswikiNewLink" href="StdErr.html" rel="nofollow">StdErr</a>;<br />                  X2 = Estimate + 1.96 * <a class="foswikiNewLink" rel="nofollow" href="StdErr.html" title="Create this topic">StdErr</a>;<br />                  if <a class="foswikiNewLink" href="StdErr.html" rel="nofollow" title="Create this topic">StdErr</a> ne . then<br />                     do;<br />                        if X1 &lt; 25 then <a class="foswikiNewLink" rel="nofollow" href="LowerCL.html" title="Create this topic">LowerCL</a> = exp(X1);<br />                        if X2 &lt; 25 then <a class="foswikiNewLink" rel="nofollow" href="UpperCL.html" title="Create this topic">UpperCL</a> = exp(X2);<br />                     end;<br />               end;<br />         run;<br />      %end;<br /><br />   * Add, # observations, -2log likelood and Hosmer-Lemeshow statistics;<br />   data _extra1;<br />      set _rp;<br />      Length Variable $ 32 Pre $ 3;<br />      Variable = "Outcome";<br />      if _n</em> = 1 then Pre = '(+)'; else Pre = '(-)';<br />      <a title="Create this topic" href="ClassVal0.html" rel="nofollow" class="foswikiNewLink">ClassVal0</a> =Pre&#124;&#124;"&amp;outcome "&#124;&#124;outcome&#124;&#124;'='&#124;&#124;left(trim(put(count,10.)));<br />      <a title="Create this topic" class="foswikiNewLink" href="OrderBetween.html" rel="nofollow">OrderBetween</a> = 1000;<br />      <a title="Create this topic" href="OrderWithin.html" rel="nofollow" class="foswikiNewLink">OrderWithin</a> = <em>n</em>;<br />      Keep Variable <a title="Create this topic" rel="nofollow" href="ClassVal0.html" class="foswikiNewLink">ClassVal0</a> <a href="OrderBetween.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">OrderBetween</a> <a title="Create this topic" rel="nofollow" href="OrderWithin.html" class="foswikiNewLink">OrderWithin</a>;<br />   run;<br /><br />   data <em>extra2;<br />      set _fs;<br />      Length Variable $ 32;<br />      if Criterion = '-2 Log L' then<br />         do;<br />            Variable = Criterion;<br />            <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ClassVal0.html">ClassVal0</a> = left(trim(Put(<a title="Create this topic" rel="nofollow" href="InterceptAndCovariates.html" class="foswikiNewLink">InterceptAndCovariates</a>,10.3)));<br />            <a title="Create this topic" class="foswikiNewLink" href="OrderBetween.html" rel="nofollow">OrderBetween</a> = 2000;<br />            <a title="Create this topic" class="foswikiNewLink" href="OrderWithin.html" rel="nofollow">OrderWithin</a> = 1;<br />            Keep Variable <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ClassVal0.html">ClassVal0</a> <a href="OrderBetween.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">OrderBetween</a> <a title="Create this topic" class="foswikiNewLink" href="OrderWithin.html" rel="nofollow">OrderWithin</a>;<br />            output;<br />         end;<br />   run;<br /><br />   data _extra3;<br />      set _hl;<br />      Length Variable $ 32;<br />      Variable = 'H-L Test';<br />      If df = 0 then <a title="Create this topic" class="foswikiNewLink" href="ClassVal0.html" rel="nofollow">ClassVal0</a> = '&lt; 3 groups'; else <a rel="nofollow" href="ClassVal0.html" class="foswikiNewLink" title="Create this topic">ClassVal0</a> = Trim(Left(Put(df+2,3.)))&#124;&#124;' groups';<br />      <a rel="nofollow" href="OrderBetween.html" class="foswikiNewLink" title="Create this topic">OrderBetween</a> = 3000;<br />      <a class="foswikiNewLink" rel="nofollow" href="OrderWithin.html" title="Create this topic">OrderWithin</a> = 1;<br />      Keep Variable <a rel="nofollow" href="ClassVal0.html" class="foswikiNewLink" title="Create this topic">ClassVal0</a> Probchisq <a title="Create this topic" href="OrderBetween.html" rel="nofollow" class="foswikiNewLink">OrderBetween</a> <a class="foswikiNewLink" href="OrderWithin.html" rel="nofollow" title="Create this topic">OrderWithin</a>;<br />   run;<br /><br />   %if &amp;Status ne 0 %then<br />      %do;<br />         data _extra4;<br />            Length Variable  $ 32;<br />            Variable = 'Convergence problems';<br />            <a title="Create this topic" class="foswikiNewLink" href="ClassVal0.html" rel="nofollow">ClassVal0</a> = "Status = %trim(&amp;Status)";<br />            <a title="Create this topic" rel="nofollow" href="OrderBetween.html" class="foswikiNewLink">OrderBetween</a> = 4000;<br />            <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderWithin.html">OrderWithin</a> = 1;<br />         run;<br />      %end;<br /><br />   data _pe4;<br />      set<br />      %if &amp;Obs = Y %then %do; _extra1 %end;<br />      %if &amp;LL = Y %then %do; _extra2 %end;<br />      %if &amp;HL = Y %then %do; _extra3 %end;<br />      %if &amp;Status ne 0 %then %do; _extra4 %end;<br />      _pe4 ;<br /><br />   run;<br /><br />   %if %symexist(_Model) = 1 %then<br />      %do;<br />         %Let _Model = %eval(&amp;_Model + 1);<br />      %end;<br />   %else<br />      %do;<br />         %Let _Model = 1;<br />      %end;<br />   proc sort data = _pe4; by <a href="OrderBetween.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">OrderBetween</a> <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderWithin.html">OrderWithin</a>;<br /><br />   proc format; value _pfmt . = ' ' low-.00995 = [pvalue6.4] .00995-.0995 = [6.3] .0995-1 = [6.2];<br />                value _orfmt . = ' ' low-2 = [6.2] 2-20 = [6.1] 20-high = [6.0];<br />                value _missint . = ' ' other = [3.];<br />   data _pe5 (drop = pre post);<br />      set _pe4 end = done; by <a title="Create this topic" rel="nofollow" href="OrderBetween.html" class="foswikiNewLink">OrderBetween</a>;<br />      if _n</em> = 1 then do; <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="MaxBefore.html">MaxBefore</a> = 0; <a title="Create this topic" rel="nofollow" href="MaxAfter.html" class="foswikiNewLink">MaxAfter</a> = 0; end;       * find max digits before, after slash so freq could be aligned;<br />      retain <a class="foswikiNewLink" href="MaxBefore.html" rel="nofollow" title="Create this topic">MaxBefore</a> <a title="Create this topic" rel="nofollow" href="MaxAfter.html" class="foswikiNewLink">MaxAfter</a>;<br />      Length <a title="Create this topic" rel="nofollow" href="ProbChiSqAlpha.html" class="foswikiNewLink">ProbChiSqAlpha</a> <a class="foswikiNewLink" rel="nofollow" href="P3Alpha.html" title="Create this topic">P3Alpha</a> <a title="Create this topic" rel="nofollow" href="PQuadAlpha.html" class="foswikiNewLink">PQuadAlpha</a> $ 6;<br />      <a class="foswikiNewLink" rel="nofollow" href="ProbChiSqAlpha.html" title="Create this topic">ProbChiSqAlpha</a> = left(put(<a rel="nofollow" href="ProbChiSq.html" class="foswikiNewLink" title="Create this topic">ProbChiSq</a>,_pfmt.));<br />      %if &amp;NClass = 0 %then %do; PType3 = .; *Length <a href="ClassVal0.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ClassVal0</a> $ 40; %end;<br />      <a title="Create this topic" rel="nofollow" href="P3Alpha.html" class="foswikiNewLink">P3Alpha</a> = left(Put(PType3,_pfmt.));<br />      %if &amp;NNumVars = 0 or &amp;Quad ne Y %then %do; PQuad = .; %end;<br />      <a title="Create this topic" rel="nofollow" href="PQuadALpha.html" class="foswikiNewLink">PQuadALpha</a> = left(put(PQuad,_pfmt.));<br />      if <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderBetween.html">OrderBetween</a> = 2 and <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OrderWithin.html">OrderWithin</a> = 1 then Model = &_Model;<br />      %if (&amp;Include = F or &amp;Include = FP) %then<br />         %do;<br />            K = index(<a href="FreqPct.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">FreqPct</a>,'/');<br />            if K &gt; 0 then<br />               do;<br />                  Pre = K-1;<br />                  L = index(Substr(<a title="Create this topic" href="FreqPct.html" rel="nofollow" class="foswikiNewLink">FreqPct</a>,K+1),' ');<br />                  If L &gt; 0 then Post = L - 1; else Post = 0;<br />                  If Pre &gt; <a rel="nofollow" href="MaxBefore.html" class="foswikiNewLink" title="Create this topic">MaxBefore</a> then <a title="Create this topic" class="foswikiNewLink" href="MaxBefore.html" rel="nofollow">MaxBefore</a> = Pre;<br />                  if Post &gt; <a title="Create this topic" rel="nofollow" href="MaxAfter.html" class="foswikiNewLink">MaxAfter</a> then <a class="foswikiNewLink" rel="nofollow" href="MaxAfter.html" title="Create this topic">MaxAfter</a> = Post;<br />               end;<br />            %end;<br />      label <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="ProbChiSqAlpha.html">ProbChiSqAlpha</a> = 'P-Value'<br />            <a rel="nofollow" href="ProbChiSq.html" class="foswikiNewLink" title="Create this topic">ProbChiSq</a> = 'P-Value'<br />            PType3 = 'Type 3 P-Value'<br />            <a title="Create this topic" rel="nofollow" href="P3Alpha.html" class="foswikiNewLink">P3Alpha</a> = 'Type 3 P-Value'<br />            PQuad = 'Quadratic P-Value'<br />            <a title="Create this topic" href="PQuadAlpha.html" rel="nofollow" class="foswikiNewLink">PQuadAlpha</a> = 'Quadratic P-Value'<br />            <a rel="nofollow" href="ClassVal0.html" class="foswikiNewLink" title="Create this topic">ClassVal0</a> = 'Value'<br />            <a title="Create this topic" href="LowerCL.html" rel="nofollow" class="foswikiNewLink">LowerCL</a> = 'Lower 95% CI'<br />            <a href="UpperCL.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">UpperCL</a> = 'Upper 95% CI'<br />            %if &amp;Include = FP %then %do;  <a rel="nofollow" href="FreqPct.html" class="foswikiNewLink" title="Create this topic">FreqPct</a> = "# &amp;outcome/# subgroup (% &amp;outcome)" %end;<br />            %if &amp;Include = F  %then %do;  <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="FreqPct.html">FreqPct</a> = "# &amp;outcome/# subgroup" %end;<br />            %if &amp;Include = P  %then %do;  <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> = "% &amp;outcome" %end;<br />            ;<br />      output;<br />      if last.OrderBetween then<br />         do;<br />            Variable = '';<br />            <a href="ProbChiSqAlpha.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">ProbChiSqAlpha</a> = '';<br />            <a class="foswikiNewLink" rel="nofollow" href="P3Alpha.html" title="Create this topic">P3Alpha</a> = '';<br />            <a title="Create this topic" href="PQuadAlpha.html" rel="nofollow" class="foswikiNewLink">PQuadAlpha</a> = '';<br />            <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> = '';<br />            <a href="OddsRatioMeasures.html">OddsRatioMeasures</a> = .;<br />            <a title="Create this topic" href="LowerCL.html" rel="nofollow" class="foswikiNewLink">LowerCL</a> = .;<br />            <a title="Create this topic" rel="nofollow" href="UpperCL.html" class="foswikiNewLink">UpperCL</a> = .;<br />            <a title="Create this topic" class="foswikiNewLink" href="ClassVal0.html" rel="nofollow">ClassVal0</a> = '';<br />            Model = .;<br />            output;<br />         end;<br />      if done then<br />         do;<br />            call Symput('MaxBefore',MaxBefore);<br />            call Symput('MaxAfter',MaxAfter);<br />         end;<br />   run;<br /><br />   %if (&amp;Include = F or &amp;Include = FP) %then<br />      %do;<br />         data <em>pe5 (drop = K L M <a rel="nofollow" href="MaxBefore.html" class="foswikiNewLink" title="Create this topic">MaxBefore</a> <a title="Create this topic" href="MaxAfter.html" rel="nofollow" class="foswikiNewLink">MaxAfter</a>);<br />            set _pe5;<br />            K = index(<a class="foswikiNewLink" rel="nofollow" href="FreqPct.html" title="Create this topic">FreqPct</a>,'/');<br />            if K &gt; 0 then<br />               do;<br />                  <a title="Create this topic" href="FreqPct.html" rel="nofollow" class="foswikiNewLink">FreqPct</a> = Repeat(' ',&amp;MaxBefore-K+1)&#124;&#124;FreqPct;<br />                  %if &amp;Include = FP %then<br />                     %do;<br />                        K = index(<a href="FreqPct.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">FreqPct</a>,'/');<br />                        L = index(Substr(<a title="Create this topic" rel="nofollow" href="FreqPct.html" class="foswikiNewLink">FreqPct</a>,K+1),' ');<br />                        M = index(Substr(<a title="Create this topic" href="FreqPct.html" rel="nofollow" class="foswikiNewLink">FreqPct</a>,K+1),'(');<br />                        if L &gt; 0 then <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="FreqPct.html">FreqPct</a> = Substr(<a class="foswikiNewLink" rel="nofollow" href="FreqPct.html" title="Create this topic">FreqPct</a>,1,K+L-1)&#124;&#124;Repeat(' ',&amp;MaxAfter-L+1)&#124;&#124;Substr(<a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="FreqPct.html">FreqPct</a>,M+K);<br />                     %end;<br />               end;<br />         run;<br />      %end;<br /><br />   data _pe5;<br />      set _pe5;<br />      <a class="foswikiNewLink" href="OddsRatioAlpha.html" rel="nofollow" title="Create this topic">OddsRatioAlpha</a> = left(put(<a href="OddsRatioMeasures.html">OddsRatioMeasures</a>,_orfmt.));<br />      <a class="foswikiNewLink" href="UpperCLAlpha.html" rel="nofollow" title="Create this topic">UpperCLAlpha</a> = left(put(<a class="foswikiNewLink" href="UpperCL.html" rel="nofollow" title="Create this topic">UpperCL</a>,_orfmt.));<br />      <a rel="nofollow" href="LowerCLAlpha.html" class="foswikiNewLink" title="Create this topic">LowerCLAlpha</a> = left(Put(<a rel="nofollow" href="LowerCL.html" class="foswikiNewLink" title="Create this topic">LowerCL</a>,_orfmt.));<br />      label <a rel="nofollow" href="OddsRatioAlpha.html" class="foswikiNewLink" title="Create this topic">OddsRatioAlpha</a> = 'Odds Ratio'<br />            <a href="UpperCLAlpha.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">UpperCLAlpha</a> = 'Upper 95% CI'<br />            <a class="foswikiNewLink" href="LowerCLAlpha.html" rel="nofollow" title="Create this topic">LowerCLAlpha</a> = 'Lower 95% CI';<br />      if Variable = 'Intercept' then delete;<br />   run;<br /><br />   %if &amp;Print = Y %then<br />      %do;<br />         ods listing;<br />         proc print data = _pe5 noobs label uniform; var<br />          <a class="foswikiNewLink" rel="nofollow" href="OddsRatioAlpha.html" title="Create this topic">OddsRatioAlpha</a> <a href="LowerCLAlpha.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">LowerCLAlpha</a> <a class="foswikiNewLink" href="UpperCLAlpha.html" rel="nofollow" title="Create this topic">UpperCLAlpha</a> <a class="foswikiNewLink" rel="nofollow" href="ProbChiSqAlpha.html" title="Create this topic">ProbChiSqAlpha</a><br />         %if &amp;NNumVars2 &gt; 0 and &amp;Quad = Y %then %do; <a href="PQuadAlpha.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">PQuadAlpha</a> %end;<br />         %if &amp;NClass &gt; 0 %then %do; <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="P3Alpha.html">P3Alpha</a> %end;<br />         ;<br />         id Model variable<br />         %if &amp;Obs = Y or &amp;HL = Y or &amp;LL = Y or %length(&amp;ClassVar) &gt; 0 %then %do; classval0 %end;<br />         %if (&amp;Include = F or &amp;Include = P or &amp;Include = FP) and %Length(&amp;ClassVar) &gt; 0 %then %do; <a href="FreqPct.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">FreqPct</a> %end;<br />         ;<br />         format Model _missint.;<br />         run;<br />      %end;<br /><br />   %if &amp;out ne %then<br />      %do;<br />         data &amp;out (Type = 'Logistic' drop = <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="OldVar.html">OldVar</a> <a href="BaseVar.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">BaseVar</a> Var IRQ Count X1 X2 <a class="foswikiNewLink" rel="nofollow" href="ClassVal0.html" title="Create this topic">ClassVal0</a>);<br />            set _pe5;<br />            Length Value $ 40;<br />            %if &amp;NClass &gt; 0 or &amp;Obs = Y or &amp;HL = Y or &amp;LL = Y %then %do; Value = <a rel="nofollow" href="ClassVal0.html" class="foswikiNewLink" title="Create this topic">ClassVal0</a>; %end;<br />            if Variable = '' then delete;<br />            %if &amp;NNumVars = 0 %then %do; PQuad = .; %end;<br />            %if &amp;NClass = 0 %then %do; <a class="foswikiNewLink" href="FreqPct.html" rel="nofollow" title="Create this topic">FreqPct</a> = ''; Total = .; Freq = .; Percent = .; PType3 = .; %end;<br />            Status = &Status;<br />            Model = &_Model;<br />            Length <a title="Create this topic" rel="nofollow" href="VarType.html" class="foswikiNewLink">VarType</a> $ 20 Dependent $ 32;<br />            Dependent = "&amp;Outcome";<br />            if Variable in('Outcome','-2 Log L','H-L GOF','Convergence problems') then <a title="Create this topic" class="foswikiNewLink" rel="nofollow" href="VarType.html">VarType</a> = Variable; else   <a href="VarType.html" rel="nofollow" class="foswikiNewLink" title="Create this topic">VarType</a> = 'Logistic Model';<br />         run;<br />      %end;<br /><br />   %ExitLogistic:<br />   proc datasets nolist; delete _allcounts _allquad  _counts _counts2 _cs  _extra1 _extra2 _extra3 _extra4<br />   _fs _hl _irq  _nomiss  _oneline _pe _pe</em> _pe2 _pe3 _pe4 _pe5 _pe5  _rp _test _t3; quit;  <br /><br />%mend logistic; </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> *Stata-Code - Attachment</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Stata-Code</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Other Code - Attachment</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Other Code</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Called Data Manipulation</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Called Tool/Utility</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Called Checking Macro</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Called Other</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Creation-Date</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Revision-Date</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Example Code</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Example Output</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>SAS Examples</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>SAS_Example_Code</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>SAS_Example_Output</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>R Examples</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>R_Example_Code</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>R_Example_Output</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Stats Examples</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Special Features</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Special Features Attached</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Special Features Text</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes1-Legend</strong> </td><td> <strong>Section with calls to needed macros</strong> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes1</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes2-Legend</strong> </td><td> <strong>Macro call with fully specified parameters</strong> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes2</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes3-Legend</strong> </td><td> <strong>Section with definitions of global macro parameters</strong> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes3</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes4-Legend</strong> </td><td> <strong>Section with definitions of local macro variables</strong> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Notes4</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>See Also</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Checklists</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Stat Tools Disclaimer</strong> </td><td>  </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Discliamer</strong> </td><td> The views expressed within CTSpedia are those of the author and must not be taken to represent policy or guidance on the behalf of any organization or institution with which the author is affiliated. </br> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Permission</strong> </td><td> Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: </br> <br>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</br> <br>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF ERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT  OLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </br> </td></tr><tr style='vertical-align:top'><td class='foswikiFormTableRow foswikiFirstCol' style='text-align:right'> <strong>Reference Image</strong> </td><td>  </td></tr></table></div>
This topic: CTSpedia<span class='foswikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="WebHome.html" class="foswikiCurrentWebHomeLink">WebHome</a> &gt; <a href="StatToolsHome.html">StatToolsHome</a><span class='foswikiSeparator'>&nbsp;&gt;&nbsp;</span>StatToolsTopic054 <br />
Topic revision:  <span class='patternRevInfo'>21 Jun 2012, MaryBanach</span>
<hr />
<span id="PageBottom"></span>
<div class="foswikiCopyright"><span class="foswikiRight"> <a href="https://foswiki.org/"><img alt="This site is powered by Foswiki" title="This site is powered by Foswiki" src="../System/ProjectLogos.attachments/foswiki-badge.png"></a></span>Copyright &copy; by the contributing authors. All material on this collaboration platform is the property of the contributing authors. <br /> Ideas, requests, problems regarding Foswiki? <a href="mailto:?subject=Foswiki%20Feedback%20on%20CTSpedia.StatToolsTopic054">Send feedback</a></div></div></div>

</body></html>